<html><head><meta http-equiv='content-type' content='text/html; charset=utf-8'>
	<script type='text/javascript' >
	window.onload=function(){
	    var num = document.getElementById(location.hash.replace(/^#/,''));
	    if (num) {
	        num.style.color = 'RGB(255,255,50)';
	        num.style.backgroundColor = 'RGB(255,140,0)';
	    }
	}
	</script>
	<style>
	body, pre {font-family: 'MS Gothic',monospace; font-size: 12px; color:RGB(48,48,48); line-height: 14px; margin: 0px;}
	.KEYW {color: RGB(0,160,255); font-weight:bold;}
	.COMM {color: RGB(120,192,0)}
	.NUMB {color: RGB(128,99,0)}
	.STRN {color: RGB(220,160,60)}
	.REGX {color: RGB(230,0,0)}
	.line {border-right: 1px dotted RGB(140,140,140); color: RGB(140,140,140); background-color: RGB(240,240,240); padding: 1px 1px 1px 3px;}
	.doccmt {color: RGB(150,150,255)}
	.doctag {color: RGB(90,90,255)}
	.spacer {height:6px;overflow:hidden;}
	</style></head>
	<body lang='ja'><div class='spacer'><span class='line'>&nbsp;&nbsp;&nbsp;&nbsp;</span></div><pre><span id='line1' class='line'>   1</span> <span class="COMM">/*
<span id='line2' class='line'>   2</span> floor 切り下げ
<span id='line3' class='line'>   3</span> ceil 切り上げ
<span id='line4' class='line'>   4</span> round 四捨五入
<span id='line5' class='line'>   5</span> */</span><span class="WHIT">
<span id='line6' class='line'>   6</span> 
<span id='line7' class='line'>   7</span> </span><span class="doccmt">/**
<span id='line8' class='line'>   8</span>  * document.getElementById のシンタックスシュガー
<span id='line9' class='line'>   9</span>  * <span class="doctag">@param</span> {String} aID
<span id='line10' class='line'>  10</span>  * <span class="doctag">@return</span> {Node}
<span id='line11' class='line'>  11</span>  */</span><span class="WHIT">
<span id='line12' class='line'>  12</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">aID</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line13' class='line'>  13</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">aID</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line14' class='line'>  14</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line15' class='line'>  15</span> 
<span id='line16' class='line'>  16</span> </span><span class="doccmt">/**
<span id='line17' class='line'>  17</span>  * document.getElementsByClassName のシンタックスシュガー
<span id='line18' class='line'>  18</span>  * 該当ノードが1つしかない場合はノードそのものを返す
<span id='line19' class='line'>  19</span>  *
<span id='line20' class='line'>  20</span>  * <span class="doctag">@param</span> {String} aClass クラス名
<span id='line21' class='line'>  21</span>  * <span class="doctag">@param</span> {Node} [aTarget=":root"] 捜索範囲
<span id='line22' class='line'>  22</span>  * <span class="doctag">@return</span> {Node|ElementArray}
<span id='line23' class='line'>  23</span>  */</span><span class="WHIT">
<span id='line24' class='line'>  24</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="NAME">aClass</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aTarget</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line25' class='line'>  25</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uuQuery.className</span><span class="PUNC">(</span><span class="NAME">aClass</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aTarget</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line26' class='line'>  26</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result.length</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span id='line27' class='line'>  27</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line28' class='line'>  28</span> 
<span id='line29' class='line'>  29</span> </span><span class="doccmt">/**
<span id='line30' class='line'>  30</span>  * XPathで要素を得る
<span id='line31' class='line'>  31</span>  *
<span id='line32' class='line'>  32</span>  * <span class="doctag">@param</span> {String} aExpression XPath式
<span id='line33' class='line'>  33</span>  * <span class="doctag">@param</span> {Node} [aParent=":root"] 捜索範囲
<span id='line34' class='line'>  34</span>  * <span class="doctag">@return</span> {ElementArray}
<span id='line35' class='line'>  35</span>  */</span><span class="WHIT">
<span id='line36' class='line'>  36</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">$X</span><span class="PUNC">(</span><span class="NAME">aExpression</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aParent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line37' class='line'>  37</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line38' class='line'>  38</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.evaluate</span><span class="PUNC">(</span><span class="NAME">aExpression</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aParent</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">document</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">XPathResult.ORDERED_NODE_SNAPSHOT_TYPE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line39' class='line'>  39</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">x.snapshotLength</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line40' class='line'>  40</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="NAME">x.snapshotItem</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line41' class='line'>  41</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line42' class='line'>  42</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">;</span><span class="WHIT">
<span id='line43' class='line'>  43</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line44' class='line'>  44</span> 
<span id='line45' class='line'>  45</span> </span><span class="doccmt">/**
<span id='line46' class='line'>  46</span>  * イベントを取り扱うクラス
<span id='line47' class='line'>  47</span>  * <span class="doctag">@class</span>
<span id='line48' class='line'>  48</span>  */</span><span class="WHIT">
<span id='line49' class='line'>  49</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">joEvent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line50' class='line'>  50</span> 
<span id='line51' class='line'>  51</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line52' class='line'>  52</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">window.addEventListener</span><span class="PUNC">(</span><span class="STRN">'mousemove'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line53' class='line'>  53</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">joEvent._moveTarget</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">joEvent._onDrag</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line54' class='line'>  54</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">joEvent._resizeTarget</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">joEvent._onResize</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line55' class='line'>  55</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line56' class='line'>  56</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line57' class='line'>  57</span> 
<span id='line58' class='line'>  58</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line59' class='line'>  59</span> &nbsp;&nbsp;&nbsp;&nbsp; * イベントを登録する
<span id='line60' class='line'>  60</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line61' class='line'>  61</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line62' class='line'>  62</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aType イベントのタイプ
<span id='line63' class='line'>  63</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Function} aCallback コールバック関数
<span id='line64' class='line'>  64</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Boolean} [isUseCapture="false"] キャプチャフェーズにするかどうか
<span id='line65' class='line'>  65</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} [aThisObj] コールバック関数内でthisが指すオブジェクト
<span id='line66' class='line'>  66</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line67' class='line'>  67</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">addEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aCallback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isUseCapture</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aThisObj</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line68' class='line'>  68</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aThisObj</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">self</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line69' class='line'>  69</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line70' class='line'>  70</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line71' class='line'>  71</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aCallback.call</span><span class="PUNC">(</span><span class="NAME">self</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line72' class='line'>  72</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line73' class='line'>  73</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">aThisObj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aCallBack</span><span class="PUNC">;</span><span class="WHIT">
<span id='line74' class='line'>  74</span> 
<span id='line75' class='line'>  75</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.addEventListener</span><span class="PUNC">(</span><span class="NAME">aType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isUseCapture</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line76' class='line'>  76</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line77' class='line'>  77</span> 
<span id='line78' class='line'>  78</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line79' class='line'>  79</span> &nbsp;&nbsp;&nbsp;&nbsp; * Mutation Event を発火させる
<span id='line80' class='line'>  80</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line81' class='line'>  81</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aName イベントの名前
<span id='line82' class='line'>  82</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aTarget イベントを発生させる要素
<span id='line83' class='line'>  83</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line84' class='line'>  84</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">fireEvent</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aTarget</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line85' class='line'>  85</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">evt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createEvent</span><span class="PUNC">(</span><span class="STRN">'MutationEvent'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line86' class='line'>  86</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">evt.initMutationEvent</span><span class="PUNC">(</span><span class="NAME">aName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line87' class='line'>  87</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aTarget.dispatchEvent</span><span class="PUNC">(</span><span class="NAME">evt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line88' class='line'>  88</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line89' class='line'>  89</span> 
<span id='line90' class='line'>  90</span> 
<span id='line91' class='line'>  91</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line92' class='line'>  92</span> &nbsp;&nbsp;&nbsp;&nbsp; * 要素をドラッグ可能にする
<span id='line93' class='line'>  93</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line94' class='line'>  94</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} eventTarget イベントを受け付けるノード
<span id='line95' class='line'>  95</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} [moveTarget] 実際に移動させるノード &lt;br>省略時は eventTarget と同じになる
<span id='line96' class='line'>  96</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aParentNode position: absolute の基準となるノード
<span id='line97' class='line'>  97</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line98' class='line'>  98</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">setDraggable</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">eventTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">moveTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aParentNode</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line99' class='line'>  99</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">eventTarget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">eventTarget</span><span class="PUNC">;</span><span class="WHIT">
<span id='line100' class='line'> 100</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">moveTarget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">moveTarget</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">eventTarget</span><span class="PUNC">;</span><span class="WHIT">
<span id='line101' class='line'> 101</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aParentNode</span><span class="PUNC">;</span><span class="WHIT">
<span id='line102' class='line'> 102</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">eventTarget.addEventListener</span><span class="PUNC">(</span><span class="STRN">'mousedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">joEvent._onDragStart</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">moveTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line103' class='line'> 103</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line104' class='line'> 104</span> 
<span id='line105' class='line'> 105</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_onDragStart</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">moveTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line106' class='line'> 106</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joEvent</span><span class="PUNC">;</span><span class="WHIT">
<span id='line107' class='line'> 107</span> 
<span id='line108' class='line'> 108</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self._moveTarget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">moveTarget</span><span class="PUNC">;</span><span class="WHIT">
<span id='line109' class='line'> 109</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self._eventTarget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">eventTarget</span><span class="PUNC">;</span><span class="WHIT">
<span id='line110' class='line'> 110</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line111' class='line'> 111</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line112' class='line'> 112</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line113' class='line'> 113</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line114' class='line'> 114</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">eventTarget.addEventListener</span><span class="PUNC">(</span><span class="STRN">'mousemove'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">self._onDrag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line115' class='line'> 115</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">eventTarget.addEventListener</span><span class="PUNC">(</span><span class="STRN">'mouseup'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">self._onDragEnd</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line116' class='line'> 116</span> 
<span id='line117' class='line'> 117</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">moveTargetRect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.getNodeRect</span><span class="PUNC">(</span><span class="NAME">moveTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line118' class='line'> 118</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self.offsetX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">moveTargetRect.left</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">event.clientX</span><span class="PUNC">;</span><span class="WHIT">
<span id='line119' class='line'> 119</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self.offsetY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">moveTargetRect.top</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">event.clientY</span><span class="PUNC">;</span><span class="WHIT">
<span id='line120' class='line'> 120</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line121' class='line'> 121</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self.fireEvent</span><span class="PUNC">(</span><span class="STRN">'joDragStart'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">moveTarget</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line122' class='line'> 122</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line123' class='line'> 123</span> 
<span id='line124' class='line'> 124</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_onDrag</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line125' class='line'> 125</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joEvent</span><span class="PUNC">;</span><span class="WHIT">
<span id='line126' class='line'> 126</span> 
<span id='line127' class='line'> 127</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line128' class='line'> 128</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line129' class='line'> 129</span> 
<span id='line130' class='line'> 130</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.addStyle</span><span class="PUNC">(</span><span class="NAME">self._moveTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line131' class='line'> 131</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'left'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">event.clientX</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">self.offsetX</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line132' class='line'> 132</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'top'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">event.clientY</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">self.offsetY</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="WHIT">
<span id='line133' class='line'> 133</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line134' class='line'> 134</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line135' class='line'> 135</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line136' class='line'> 136</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self._moveTarget.owner.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.clientX</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">self.offsetX</span><span class="PUNC">;</span><span class="WHIT">
<span id='line137' class='line'> 137</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self._moveTarget.owner.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.clientY</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">self.offsetY</span><span class="PUNC">;</span><span class="WHIT">
<span id='line138' class='line'> 138</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span id='line139' class='line'> 139</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line140' class='line'> 140</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.fireEvent</span><span class="PUNC">(</span><span class="STRN">'joDrag'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">joEvent._moveTarget</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line141' class='line'> 141</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line142' class='line'> 142</span> 
<span id='line143' class='line'> 143</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_onDragEnd</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line144' class='line'> 144</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joEvent._moveTarget</span><span class="PUNC">;</span><span class="WHIT">
<span id='line145' class='line'> 145</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent._moveTarget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span id='line146' class='line'> 146</span> 
<span id='line147' class='line'> 147</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line148' class='line'> 148</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line149' class='line'> 149</span> 
<span id='line150' class='line'> 150</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent._eventTarget.removeEventListener</span><span class="PUNC">(</span><span class="STRN">'mousemove'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">joEvent._onDrag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line151' class='line'> 151</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent._eventTarget.removeEventListener</span><span class="PUNC">(</span><span class="STRN">'mouseup'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">joEvent._onDragEnd</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line152' class='line'> 152</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line153' class='line'> 153</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.fireEvent</span><span class="PUNC">(</span><span class="STRN">'joDragEnd'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line154' class='line'> 154</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line155' class='line'> 155</span> 
<span id='line156' class='line'> 156</span> 
<span id='line157' class='line'> 157</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line158' class='line'> 158</span> &nbsp;&nbsp;&nbsp;&nbsp; * 要素をリサイズ可能にする
<span id='line159' class='line'> 159</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line160' class='line'> 160</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} eventTarget イベントを受け付けるノード
<span id='line161' class='line'> 161</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} [resizeTarget] 実際にリサイズさせるノード &lt;br>省略時は eventTarget と同じになる
<span id='line162' class='line'> 162</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line163' class='line'> 163</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">setResizable</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">eventTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">resizeTarget</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line164' class='line'> 164</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">eventTarget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">eventTarget</span><span class="PUNC">;</span><span class="WHIT">
<span id='line165' class='line'> 165</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">resizeTarget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">resizeTarget</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">eventTarget</span><span class="PUNC">;</span><span class="WHIT">
<span id='line166' class='line'> 166</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">eventTarget.addEventListener</span><span class="PUNC">(</span><span class="STRN">'mousedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">joEvent._onResizeStart</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">resizeTarget</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line167' class='line'> 167</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line168' class='line'> 168</span> 
<span id='line169' class='line'> 169</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_onResizeStart</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">eventTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">resizeTarget</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line170' class='line'> 170</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joEvent</span><span class="PUNC">;</span><span class="WHIT">
<span id='line171' class='line'> 171</span> 
<span id='line172' class='line'> 172</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self._resizeTarget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">resizeTarget</span><span class="PUNC">;</span><span class="WHIT">
<span id='line173' class='line'> 173</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self._eventTarget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">eventTarget</span><span class="PUNC">;</span><span class="WHIT">
<span id='line174' class='line'> 174</span> 
<span id='line175' class='line'> 175</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line176' class='line'> 176</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line177' class='line'> 177</span> 
<span id='line178' class='line'> 178</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">bounds</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">self._resizeTarget.getBoundingClientRect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line179' class='line'> 179</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self.left</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">bounds.left</span><span class="PUNC">;</span><span class="WHIT">
<span id='line180' class='line'> 180</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self.top</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">bounds.top</span><span class="PUNC">;</span><span class="WHIT">
<span id='line181' class='line'> 181</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self.offsetX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">bounds.right</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">event.clientX</span><span class="PUNC">;</span><span class="WHIT">
<span id='line182' class='line'> 182</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self.offsetY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">bounds.bottom</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">event.clientY</span><span class="PUNC">;</span><span class="WHIT">
<span id='line183' class='line'> 183</span> 
<span id='line184' class='line'> 184</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">eventTarget.addEventListener</span><span class="PUNC">(</span><span class="STRN">'mousemove'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">self._onResize</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line185' class='line'> 185</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">eventTarget.addEventListener</span><span class="PUNC">(</span><span class="STRN">'mouseup'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">self._onResizeEnd</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line186' class='line'> 186</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line187' class='line'> 187</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self.fireEvent</span><span class="PUNC">(</span><span class="STRN">'joResizeStart'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">resizeTarget</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line188' class='line'> 188</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line189' class='line'> 189</span> 
<span id='line190' class='line'> 190</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_onResize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line191' class='line'> 191</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joEvent</span><span class="PUNC">;</span><span class="WHIT">
<span id='line192' class='line'> 192</span> 
<span id='line193' class='line'> 193</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line194' class='line'> 194</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line195' class='line'> 195</span> 
<span id='line196' class='line'> 196</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.addStyle</span><span class="PUNC">(</span><span class="NAME">self._resizeTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line197' class='line'> 197</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event.clientX</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">self.offsetX</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">self.left</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line198' class='line'> 198</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event.clientY</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">self.offsetY</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">self.top</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="WHIT">
<span id='line199' class='line'> 199</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line200' class='line'> 200</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line201' class='line'> 201</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line202' class='line'> 202</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self._moveTarget.owner.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event.clientX</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">self.offsetX</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">self.left</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line203' class='line'> 203</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self._moveTarget.owner.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event.clientY</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">self.offsetY</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">self.top</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line204' class='line'> 204</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span id='line205' class='line'> 205</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line206' class='line'> 206</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.fireEvent</span><span class="PUNC">(</span><span class="STRN">'joResize'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">joEvent._resizeTarget</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line207' class='line'> 207</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line208' class='line'> 208</span> 
<span id='line209' class='line'> 209</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_onResizeEnd</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line210' class='line'> 210</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">target</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joEvent._resizeTarget</span><span class="PUNC">;</span><span class="WHIT">
<span id='line211' class='line'> 211</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent._resizeTarget</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span id='line212' class='line'> 212</span> 
<span id='line213' class='line'> 213</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line214' class='line'> 214</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">event.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line215' class='line'> 215</span> 
<span id='line216' class='line'> 216</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent._eventTarget.removeEventListener</span><span class="PUNC">(</span><span class="STRN">'mousemove'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">joEvent._onResize</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line217' class='line'> 217</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent._eventTarget.removeEventListener</span><span class="PUNC">(</span><span class="STRN">'mouseup'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">joEvent._onResizeEnd</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line218' class='line'> 218</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line219' class='line'> 219</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.fireEvent</span><span class="PUNC">(</span><span class="STRN">'joResizeEnd'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">target</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line220' class='line'> 220</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line221' class='line'> 221</span> 
<span id='line222' class='line'> 222</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line223' class='line'> 223</span> 
<span id='line224' class='line'> 224</span> 
<span id='line225' class='line'> 225</span> </span><span class="doccmt">/**
<span id='line226' class='line'> 226</span>  * Create a window
<span id='line227' class='line'> 227</span>  * <span class="doctag">@constructor</span>
<span id='line228' class='line'> 228</span>  * <span class="doctag">@param</span> {Object} param
<span id='line229' class='line'> 229</span>  * <span class="doctag">@param</span> {Number} param.width 横幅
<span id='line230' class='line'> 230</span>  * <span class="doctag">@param</span> {Number} param.height 縦幅
<span id='line231' class='line'> 231</span>  * <span class="doctag">@param</span> {Number} param.x x座標
<span id='line232' class='line'> 232</span>  * <span class="doctag">@param</span> {Number} param.y y座標
<span id='line233' class='line'> 233</span>  * <span class="doctag">@param</span> {String} param.application 作成元のアプリケーションid
<span id='line234' class='line'> 234</span>  * <span class="doctag">@param</span> {String} param.title タイトル
<span id='line235' class='line'> 235</span>  */</span><span class="WHIT">
<span id='line236' class='line'> 236</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">joWindow</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line237' class='line'> 237</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.param</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">param</span><span class="PUNC">;</span><span class="WHIT">
<span id='line238' class='line'> 238</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//各要素へのDOM Nodeの参照</span><span class="WHIT">
<span id='line239' class='line'> 239</span> 
<span id='line240' class='line'> 240</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line241' class='line'> 241</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line242' class='line'> 242</span> </span><span class="NAME">joWindow.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line243' class='line'> 243</span> 
<span id='line244' class='line'> 244</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line245' class='line'> 245</span> &nbsp;&nbsp;&nbsp;&nbsp; * ウィンドウの構造（XHTML）
<span id='line246' class='line'> 246</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> String
<span id='line247' class='line'> 247</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line248' class='line'> 248</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">constract</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT">
<span id='line249' class='line'> 249</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;div class="menubar">'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line250' class='line'> 250</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&nbsp;&nbsp;&nbsp;&nbsp;&lt;button class="button-close">x&lt;/button>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line251' class='line'> 251</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&nbsp;&nbsp;&nbsp;&nbsp;&lt;button class="button-minimize">-&lt;/button>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line252' class='line'> 252</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&nbsp;&nbsp;&nbsp;&nbsp;&lt;button class="button-maximize">+&lt;/button>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line253' class='line'> 253</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="title">Untitled&lt;/div>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line254' class='line'> 254</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;/div>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line255' class='line'> 255</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;div class="content">&lt;/div>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line256' class='line'> 256</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;div class="statusbar">'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line257' class='line'> 257</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="resizer">&lt;/div>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line258' class='line'> 258</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;/div>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line259' class='line'> 259</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;div class="dammy-wrapper">&lt;/div>'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">//non-activeなwindowにかぶせ、clickを効率よく処理するためのwrapper</span><span class="WHIT">
<span id='line260' class='line'> 260</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line261' class='line'> 261</span> 
<span id='line262' class='line'> 262</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line263' class='line'> 263</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.window</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.createNode</span><span class="PUNC">(</span><span class="STRN">'div'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'window '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.param.application</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'windows'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line264' class='line'> 264</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.window.owner</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span id='line265' class='line'> 265</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.window.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.constract</span><span class="PUNC">;</span><span class="WHIT">
<span id='line266' class='line'> 266</span> 
<span id='line267' class='line'> 267</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.title</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'title'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line268' class='line'> 268</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.content</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'content'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line269' class='line'> 269</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.statusbar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'statusbar'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line270' class='line'> 270</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.menubar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'menubar'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line271' class='line'> 271</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line272' class='line'> 272</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.addStyle</span><span class="PUNC">(</span><span class="NAME">this.display.window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line273' class='line'> 273</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.param.width</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line274' class='line'> 274</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.param.height</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line275' class='line'> 275</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'top'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.param.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line276' class='line'> 276</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'left'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.param.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="WHIT">
<span id='line277' class='line'> 277</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line278' class='line'> 278</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line279' class='line'> 279</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.param.width</span><span class="PUNC">;</span><span class="WHIT">
<span id='line280' class='line'> 280</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.param.height</span><span class="PUNC">;</span><span class="WHIT">
<span id='line281' class='line'> 281</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.param.x</span><span class="PUNC">;</span><span class="WHIT">
<span id='line282' class='line'> 282</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.param.y</span><span class="PUNC">;</span><span class="WHIT">
<span id='line283' class='line'> 283</span> 
<span id='line284' class='line'> 284</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.setTitle</span><span class="PUNC">(</span><span class="NAME">this.param.title</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">'Untitled'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line285' class='line'> 285</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.onFocus</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line286' class='line'> 286</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.onResize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line287' class='line'> 287</span> 
<span id='line288' class='line'> 288</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._setEvents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line289' class='line'> 289</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line290' class='line'> 290</span> 
<span id='line291' class='line'> 291</span> 
<span id='line292' class='line'> 292</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">/* Events */</span><span class="WHIT">
<span id='line293' class='line'> 293</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_setEvents</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line294' class='line'> 294</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'button-close'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.close</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line295' class='line'> 295</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'button-minimize'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.toggleMinimize</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line296' class='line'> 296</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'button-maximize'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.toggleMaximize</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line297' class='line'> 297</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'dammy-wrapper'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'mousedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.onFocus</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line298' class='line'> 298</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">this.display.window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'joResize'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.onResize</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line299' class='line'> 299</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">this.display.window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'joResizeEnd'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.onResize</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line300' class='line'> 300</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">this.display.window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'mousedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">event.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line301' class='line'> 301</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.setDraggable</span><span class="PUNC">(</span><span class="NAME">this.display.menubar</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'display'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line302' class='line'> 302</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.setResizable</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'resizer'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line303' class='line'> 303</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line304' class='line'> 304</span> 
<span id='line305' class='line'> 305</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line306' class='line'> 306</span> &nbsp;&nbsp;&nbsp;&nbsp; * ウィンドウがリサイズされたときに呼び出される
<span id='line307' class='line'> 307</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line308' class='line'> 308</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">onResize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line309' class='line'> 309</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.content.style.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.display.statusbar.getBoundingClientRect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">top</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="WHIT">
<span id='line310' class='line'> 310</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="NAME">this.display.menubar.getBoundingClientRect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bottom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line311' class='line'> 311</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line312' class='line'> 312</span> 
<span id='line313' class='line'> 313</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line314' class='line'> 314</span> &nbsp;&nbsp;&nbsp;&nbsp; * ウィンドウがフォーカスされたときに呼び出される
<span id='line315' class='line'> 315</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line316' class='line'> 316</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">onFocus</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line317' class='line'> 317</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.updateZIndex</span><span class="PUNC">(</span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line318' class='line'> 318</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joAppManager.changeActiveApp</span><span class="PUNC">(</span><span class="NAME">this.param.application</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">'System'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line319' class='line'> 319</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line320' class='line'> 320</span> 
<span id='line321' class='line'> 321</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line322' class='line'> 322</span> &nbsp;&nbsp;&nbsp;&nbsp; * ウィンドウを閉じる&lt;br>
<span id='line323' class='line'> 323</span> &nbsp;&nbsp;&nbsp;&nbsp; * 閉じたときに同じアプリケーションのウィンドウをアクティブにする
<span id='line324' class='line'> 324</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line325' class='line'> 325</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">close</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line326' class='line'> 326</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.window.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line327' class='line'> 327</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line328' class='line'> 328</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">shouldFront</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">self</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line329' class='line'> 329</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">self.param.application</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line330' class='line'> 330</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tmp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joAppManager.getFrontWindow</span><span class="PUNC">(</span><span class="NAME">self.param.application</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line331' class='line'> 331</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tmp</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">tmp</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">joAppManager.getFrontWindow</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line332' class='line'> 332</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line333' class='line'> 333</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joAppManager.getFrontWindow</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line334' class='line'> 334</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line335' class='line'> 335</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line336' class='line'> 336</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line337' class='line'> 337</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">shouldFront</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">shouldFront.owner.onFocus</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line338' class='line'> 338</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line339' class='line'> 339</span> 
<span id='line340' class='line'> 340</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line341' class='line'> 341</span> &nbsp;&nbsp;&nbsp;&nbsp; * 最小化/通常を切り替える
<span id='line342' class='line'> 342</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line343' class='line'> 343</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">toggleMinimize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line344' class='line'> 344</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.window.hasAttribute</span><span class="PUNC">(</span><span class="STRN">'minimized'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT">
<span id='line345' class='line'> 345</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.window.removeAttribute</span><span class="PUNC">(</span><span class="STRN">'minimized'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span id='line346' class='line'> 346</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.window.setAttribute</span><span class="PUNC">(</span><span class="STRN">'minimized'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line347' class='line'> 347</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line348' class='line'> 348</span> 
<span id='line349' class='line'> 349</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line350' class='line'> 350</span> &nbsp;&nbsp;&nbsp;&nbsp; * 最大化/通常を切り替える
<span id='line351' class='line'> 351</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line352' class='line'> 352</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">toggleMaximize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line353' class='line'> 353</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.window.hasAttribute</span><span class="PUNC">(</span><span class="STRN">'maximized'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT">
<span id='line354' class='line'> 354</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.window.removeAttribute</span><span class="PUNC">(</span><span class="STRN">'maximized'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span id='line355' class='line'> 355</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.window.setAttribute</span><span class="PUNC">(</span><span class="STRN">'maximized'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line356' class='line'> 356</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line357' class='line'> 357</span> 
<span id='line358' class='line'> 358</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line359' class='line'> 359</span> &nbsp;&nbsp;&nbsp;&nbsp; * ウィンドウをアクティブにする
<span id='line360' class='line'> 360</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aActiveWindow アクティブにするウィンドウ
<span id='line361' class='line'> 361</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line362' class='line'> 362</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">updateZIndex</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aActiveWindow</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line363' class='line'> 363</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">joCore.hasClass</span><span class="PUNC">(</span><span class="NAME">aActiveWindow</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'window'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span id='line364' class='line'> 364</span> 
<span id='line365' class='line'> 365</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">activeWindow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joAppManager.getFrontWindow</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">maxZ</span><span class="PUNC">;</span><span class="WHIT">
<span id='line366' class='line'> 366</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line367' class='line'> 367</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">activeWindow</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line368' class='line'> 368</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">activeWindow.removeAttribute</span><span class="PUNC">(</span><span class="STRN">'active'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line369' class='line'> 369</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">maxZ</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">activeWindow.style.zIndex</span><span class="PUNC">;</span><span class="WHIT">
<span id='line370' class='line'> 370</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line371' class='line'> 371</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">maxZ</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span id='line372' class='line'> 372</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line373' class='line'> 373</span> 
<span id='line374' class='line'> 374</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aActiveWindow.setAttribute</span><span class="PUNC">(</span><span class="STRN">'active'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line375' class='line'> 375</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aActiveWindow.style.zIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Number</span><span class="PUNC">(</span><span class="NAME">maxZ</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span id='line376' class='line'> 376</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line377' class='line'> 377</span> 
<span id='line378' class='line'> 378</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line379' class='line'> 379</span> &nbsp;&nbsp;&nbsp;&nbsp; * ウィンドウタイトルを設定する
<span id='line380' class='line'> 380</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aTitle タイトル
<span id='line381' class='line'> 381</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line382' class='line'> 382</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">setTitle</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aTitle</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line383' class='line'> 383</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display.title.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aTitle</span><span class="PUNC">;</span><span class="WHIT">
<span id='line384' class='line'> 384</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line385' class='line'> 385</span> 
<span id='line386' class='line'> 386</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line387' class='line'> 387</span> 
<span id='line388' class='line'> 388</span> </span><span class="doccmt">/**
<span id='line389' class='line'> 389</span>  * Create a dialog
<span id='line390' class='line'> 390</span>  * <span class="doctag">@constructor</span>
<span id='line391' class='line'> 391</span>  * <span class="doctag">@extends</span> joWindow
<span id='line392' class='line'> 392</span>  * <span class="doctag">@param</span> {String} param.message ダイアログに表示するメッセージ
<span id='line393' class='line'> 393</span>  */</span><span class="WHIT">
<span id='line394' class='line'> 394</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">joDialog</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line395' class='line'> 395</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.param</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">param</span><span class="PUNC">;</span><span class="WHIT">
<span id='line396' class='line'> 396</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.display</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line397' class='line'> 397</span> 
<span id='line398' class='line'> 398</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//指定がない場合は自動的に画面の中央に表示する</span><span class="WHIT">
<span id='line399' class='line'> 399</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.param.x</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.param.y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line400' class='line'> 400</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.param.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joDisplay.displayWidth</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.param.width</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span id='line401' class='line'> 401</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.param.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joDisplay.displayHeight</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.param.height</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span id='line402' class='line'> 402</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line403' class='line'> 403</span> 
<span id='line404' class='line'> 404</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line405' class='line'> 405</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.init_self</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line406' class='line'> 406</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line407' class='line'> 407</span> </span><span class="NAME">joDialog.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line408' class='line'> 408</span> 
<span id='line409' class='line'> 409</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">constract</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT">
<span id='line410' class='line'> 410</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;div class="menubar">'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line411' class='line'> 411</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&nbsp;&nbsp;&nbsp;&nbsp;&lt;button class="button-close">x&lt;/button>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line412' class='line'> 412</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&nbsp;&nbsp;&nbsp;&nbsp;&lt;div class="title">&lt;/div>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line413' class='line'> 413</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;/div>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line414' class='line'> 414</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;div class="content">&lt;/div>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line415' class='line'> 415</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;div class="statusbar">&lt;/div>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line416' class='line'> 416</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;div class="dammy-wrapper">&lt;/div>'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="COMM">//non-activeなwindowにかぶせ、clickを効率よく処理するためのwrapper</span><span class="WHIT">
<span id='line417' class='line'> 417</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line418' class='line'> 418</span> 
<span id='line419' class='line'> 419</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init_self</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line420' class='line'> 420</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.addClass</span><span class="PUNC">(</span><span class="NAME">this.display.window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'dialog'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line421' class='line'> 421</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">(</span><span class="NAME">joCore.createNode</span><span class="PUNC">(</span><span class="STRN">'div'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'message'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.content</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.param.message</span><span class="PUNC">;</span><span class="WHIT">
<span id='line422' class='line'> 422</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">(</span><span class="NAME">joCore.createNode</span><span class="PUNC">(</span><span class="STRN">'button'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'button-ok'</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.content</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'OK'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line423' class='line'> 423</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line424' class='line'> 424</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'button-ok'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.close</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line425' class='line'> 425</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.param.callback</span><span class="PUNC">)</span><span class="WHIT">
<span id='line426' class='line'> 426</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'button-ok'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'mousedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.param.callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line427' class='line'> 427</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line428' class='line'> 428</span> 
<span id='line429' class='line'> 429</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_setEvents</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line430' class='line'> 430</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'button-close'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.close</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line431' class='line'> 431</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'dammy-wrapper'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'mousedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.onFocus</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line432' class='line'> 432</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">this.display.window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'mousedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">event.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line433' class='line'> 433</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.setDraggable</span><span class="PUNC">(</span><span class="NAME">this.display.menubar</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'display'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line434' class='line'> 434</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line435' class='line'> 435</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line436' class='line'> 436</span> </span><span class="NAME">joDialog.prototype.__proto__</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joWindow.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span id='line437' class='line'> 437</span> 
<span id='line438' class='line'> 438</span> 
<span id='line439' class='line'> 439</span> </span><span class="doccmt">/**
<span id='line440' class='line'> 440</span>  * 基本的な機能を提供する
<span id='line441' class='line'> 441</span>  * <span class="doctag">@class</span>
<span id='line442' class='line'> 442</span>  */</span><span class="WHIT">
<span id='line443' class='line'> 443</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">joCore</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line444' class='line'> 444</span> 
<span id='line445' class='line'> 445</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line446' class='line'> 446</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">Deferred.next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line447' class='line'> 447</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joFileManager.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line448' class='line'> 448</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line449' class='line'> 449</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line450' class='line'> 450</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joEvent.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line451' class='line'> 451</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line452' class='line'> 452</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line453' class='line'> 453</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joAppManager.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line454' class='line'> 454</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line455' class='line'> 455</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line456' class='line'> 456</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.aboutOS</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line457' class='line'> 457</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line458' class='line'> 458</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">error</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line459' class='line'> 459</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.log</span><span class="PUNC">(</span><span class="STRN">'Booting Error!'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line460' class='line'> 460</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.error</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line461' class='line'> 461</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line462' class='line'> 462</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line463' class='line'> 463</span> 
<span id='line464' class='line'> 464</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">uninit</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line465' class='line'> 465</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joAppManager.uninit</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line466' class='line'> 466</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line467' class='line'> 467</span> 
<span id='line468' class='line'> 468</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line469' class='line'> 469</span> &nbsp;&nbsp;&nbsp;&nbsp; * 要素を作成する
<span id='line470' class='line'> 470</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line471' class='line'> 471</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aTagName 作成する要素の名前
<span id='line472' class='line'> 472</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} [attributes] 要素に追加する属性 &lt;br>{ attributeName: attributeValue, ... }
<span id='line473' class='line'> 473</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} [aOwner] 要素の親
<span id='line474' class='line'> 474</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} [aNameSpace] 要素の名前空間 &lt;br>省略時は document.craeteElement と等価
<span id='line475' class='line'> 475</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line476' class='line'> 476</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">createNode</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aTagName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aOwner</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aNameSpace</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line477' class='line'> 477</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">aNameSpace</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="NAME">aTagName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span id='line478' class='line'> 478</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                       </span><span class="NAME">document.createElementNS</span><span class="PUNC">(</span><span class="NAME">aNameSpace</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aTagName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line479' class='line'> 479</span> 
<span id='line480' class='line'> 480</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">attributes</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.setAttributes</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line481' class='line'> 481</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">aOwner</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">aOwner.appendChild</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line482' class='line'> 482</span> 
<span id='line483' class='line'> 483</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">;</span><span class="WHIT">
<span id='line484' class='line'> 484</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line485' class='line'> 485</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line486' class='line'> 486</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line487' class='line'> 487</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定した座標にあるノードをすべて取得する
<span id='line488' class='line'> 488</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line489' class='line'> 489</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Number} x x座標
<span id='line490' class='line'> 490</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Number} y y座標
<span id='line491' class='line'> 491</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Function} [range]
<span id='line492' class='line'> 492</span> &nbsp;&nbsp;&nbsp;&nbsp; *                         走査する対象のノードを返す関数&lt;br>
<span id='line493' class='line'> 493</span> &nbsp;&nbsp;&nbsp;&nbsp; *                         ElementArray を返す必要がある&lt;br>
<span id='line494' class='line'> 494</span> &nbsp;&nbsp;&nbsp;&nbsp; *                         省略した場合はbody以下の全ノードが走査対象となる
<span id='line495' class='line'> 495</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {ElementArray}
<span id='line496' class='line'> 496</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line497' class='line'> 497</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getNodesByPosition</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">range</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line498' class='line'> 498</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">targetNodes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">range</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">range.call</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">uuQuery.tag</span><span class="PUNC">(</span><span class="STRN">'*'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line499' class='line'> 499</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line500' class='line'> 500</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line501' class='line'> 501</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">start</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line502' class='line'> 502</span> 
<span id='line503' class='line'> 503</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">targetNodes.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line504' class='line'> 504</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aElement.getBoundingClientRect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line505' class='line'> 505</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line506' class='line'> 506</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">rect.left</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT">
<span id='line507' class='line'> 507</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    </span><span class="NAME">rect.right</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT">
<span id='line508' class='line'> 508</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">rect.top</span><span class="WHIT"> </span><span class="PUNC">&lt;=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT">
<span id='line509' class='line'> 509</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">rect.bottom</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line510' class='line'> 510</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">result.push</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line511' class='line'> 511</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line512' class='line'> 512</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line513' class='line'> 513</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line514' class='line'> 514</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.log</span><span class="PUNC">(</span><span class="STRN">'getNodesByPosition Time : '</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">start</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'ms'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line515' class='line'> 515</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line516' class='line'> 516</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span id='line517' class='line'> 517</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line518' class='line'> 518</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line519' class='line'> 519</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line520' class='line'> 520</span> &nbsp;&nbsp;&nbsp;&nbsp; * 要素を移動する
<span id='line521' class='line'> 521</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line522' class='line'> 522</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line523' class='line'> 523</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} moveTo 移動先の親要素
<span id='line524' class='line'> 524</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line525' class='line'> 525</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">moveNode</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">moveTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line526' class='line'> 526</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line527' class='line'> 527</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">moveTo.appendChild</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line528' class='line'> 528</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line529' class='line'> 529</span> 
<span id='line530' class='line'> 530</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line531' class='line'> 531</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定したCSS Selectorに合致する要素を削除する
<span id='line532' class='line'> 532</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line533' class='line'> 533</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aSelector CSS Selector
<span id='line534' class='line'> 534</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line535' class='line'> 535</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deleteNodes</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aSelector</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line536' class='line'> 536</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">elements</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uuQuery</span><span class="PUNC">(</span><span class="NAME">aSelector</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line537' class='line'> 537</span> 
<span id='line538' class='line'> 538</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">elements.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line539' class='line'> 539</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">elements</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">elements</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line540' class='line'> 540</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line541' class='line'> 541</span> 
<span id='line542' class='line'> 542</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">elements</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span id='line543' class='line'> 543</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line544' class='line'> 544</span> 
<span id='line545' class='line'> 545</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line546' class='line'> 546</span> &nbsp;&nbsp;&nbsp;&nbsp; * 要素に属性を追加する
<span id='line547' class='line'> 547</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line548' class='line'> 548</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line549' class='line'> 549</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} attributes 追加する属性 &lt;br>{ attributeName: attributeValue, ... }
<span id='line550' class='line'> 550</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line551' class='line'> 551</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">setAttributes</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line552' class='line'> 552</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line553' class='line'> 553</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.setAttribute</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line554' class='line'> 554</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line555' class='line'> 555</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line556' class='line'> 556</span> 
<span id='line557' class='line'> 557</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line558' class='line'> 558</span> &nbsp;&nbsp;&nbsp;&nbsp; * 要素にスタイルを追加する&lt;br>
<span id='line559' class='line'> 559</span> &nbsp;&nbsp;&nbsp;&nbsp; * style属性に追加されるので優先順位に注意すること
<span id='line560' class='line'> 560</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line561' class='line'> 561</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line562' class='line'> 562</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} aSelectors 追加するスタイル &lt;br>{ Property: Value, ... }
<span id='line563' class='line'> 563</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line564' class='line'> 564</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">addStyle</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aSelectors</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line565' class='line'> 565</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">selectorStr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span id='line566' class='line'> 566</span> 
<span id='line567' class='line'> 567</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">aSelectors</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line568' class='line'> 568</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">selectorStr</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">':'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">aSelectors</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">';'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line569' class='line'> 569</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line570' class='line'> 570</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line571' class='line'> 571</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aElement.getAttribute</span><span class="PUNC">(</span><span class="STRN">'style'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line572' class='line'> 572</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">style.indexOf</span><span class="PUNC">(</span><span class="STRN">';'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">style.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">';'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line573' class='line'> 573</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">selectorStr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">selectorStr</span><span class="PUNC">;</span><span class="WHIT">
<span id='line574' class='line'> 574</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.setAttribute</span><span class="PUNC">(</span><span class="STRN">'style'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">selectorStr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line575' class='line'> 575</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line576' class='line'> 576</span> 
<span id='line577' class='line'> 577</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line578' class='line'> 578</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定したクラス名を追加する
<span id='line579' class='line'> 579</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line580' class='line'> 580</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line581' class='line'> 581</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String|Array} aClassNames 追加するクラス名&lt;br>
<span id='line582' class='line'> 582</span> &nbsp;&nbsp;&nbsp;&nbsp; *                                   複数一括追加をする場合は配列か半角スペース区切りの文字列を渡す&lt;br>
<span id='line583' class='line'> 583</span> &nbsp;&nbsp;&nbsp;&nbsp; *                                   すでにクラス名が存在していた場合は何も行わない
<span id='line584' class='line'> 584</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line585' class='line'> 585</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">addClass</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aClassNames</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line586' class='line'> 586</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">classes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">aClassNames</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">aClassNames</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aClassNames.split</span><span class="PUNC">(</span><span class="STRN">' '</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line587' class='line'> 587</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line588' class='line'> 588</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">classes.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line589' class='line'> 589</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.hasClass</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">classes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span id='line590' class='line'> 590</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line591' class='line'> 591</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.className</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">' '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">classes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line592' class='line'> 592</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line593' class='line'> 593</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line594' class='line'> 594</span> 
<span id='line595' class='line'> 595</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line596' class='line'> 596</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定したクラス名を削除する
<span id='line597' class='line'> 597</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line598' class='line'> 598</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line599' class='line'> 599</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String|Array} aClassNames 削除するクラス名&lt;br>
<span id='line600' class='line'> 600</span> &nbsp;&nbsp;&nbsp;&nbsp; *                                   複数一括削除をする場合は配列か半角スペース区切りの文字列を渡す
<span id='line601' class='line'> 601</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line602' class='line'> 602</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">removeClass</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aClassNames</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line603' class='line'> 603</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">classes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">aClassNames</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">aClassNames</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aClassNames.split</span><span class="PUNC">(</span><span class="STRN">' '</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line604' class='line'> 604</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line605' class='line'> 605</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">classes.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line606' class='line'> 606</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.hasClass</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">classes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span id='line607' class='line'> 607</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line608' class='line'> 608</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aElement.className.replace</span><span class="PUNC">(</span><span class="NAME">classes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line609' class='line'> 609</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line610' class='line'> 610</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line611' class='line'> 611</span> 
<span id='line612' class='line'> 612</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line613' class='line'> 613</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定したクラス名を持っているかどうか調べる
<span id='line614' class='line'> 614</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line615' class='line'> 615</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line616' class='line'> 616</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aClassName クラス名
<span id='line617' class='line'> 617</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Boolean}
<span id='line618' class='line'> 618</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line619' class='line'> 619</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">hasClass</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aClassName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line620' class='line'> 620</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">aElement.getAttribute</span><span class="PUNC">(</span><span class="STRN">'class'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">indexOf</span><span class="PUNC">(</span><span class="NAME">aClassName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span id='line621' class='line'> 621</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line622' class='line'> 622</span> 
<span id='line623' class='line'> 623</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line624' class='line'> 624</span> &nbsp;&nbsp;&nbsp;&nbsp; * String -> DOM
<span id='line625' class='line'> 625</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line626' class='line'> 626</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aString DOMへ変換する文字列
<span id='line627' class='line'> 627</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} [aMimeType="text/xml"] MimeType
<span id='line628' class='line'> 628</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Node}
<span id='line629' class='line'> 629</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line630' class='line'> 630</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">textToDOM</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aMimeType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line631' class='line'> 631</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line632' class='line'> 632</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parser</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">DOMParser</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line633' class='line'> 633</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parser.parseFromString</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aMimeType</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">'text/xml'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line634' class='line'> 634</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line635' class='line'> 635</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line636' class='line'> 636</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">range</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createRange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line637' class='line'> 637</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">range.selectNodeContents</span><span class="PUNC">(</span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//Hack for Safari, Opera</span><span class="WHIT">
<span id='line638' class='line'> 638</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">range.createContextualFragment</span><span class="PUNC">(</span><span class="NAME">aText</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line639' class='line'> 639</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span id='line640' class='line'> 640</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line641' class='line'> 641</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line642' class='line'> 642</span> 
<span id='line643' class='line'> 643</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line644' class='line'> 644</span> &nbsp;&nbsp;&nbsp;&nbsp; * DOM -> String
<span id='line645' class='line'> 645</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line646' class='line'> 646</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aDOM
<span id='line647' class='line'> 647</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {String}
<span id='line648' class='line'> 648</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line649' class='line'> 649</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">DOMToText</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aDOM</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line650' class='line'> 650</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">serializer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLSerializer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line651' class='line'> 651</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">serializer.serializeToString</span><span class="PUNC">(</span><span class="NAME">aDOM</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line652' class='line'> 652</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line653' class='line'> 653</span> 
<span id='line654' class='line'> 654</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line655' class='line'> 655</span> &nbsp;&nbsp;&nbsp;&nbsp; * ノードの位置情報を得る
<span id='line656' class='line'> 656</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line657' class='line'> 657</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 情報を取得する要素
<span id='line658' class='line'> 658</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} [aParent] 位置の基準となる要素&lt;br>
<span id='line659' class='line'> 659</span>      *                         省略時は Element.getBoundingClientRect() と同義になる
<span id='line660' class='line'> 660</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Object} ノードの位置情報を持つオブジェクト
<span id='line661' class='line'> 661</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} .left 左端からの距離 [px]
<span id='line662' class='line'> 662</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} .right 右端からの距離 [px]
<span id='line663' class='line'> 663</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} .top 上端からの距離 [px]
<span id='line664' class='line'> 664</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} .bottom 下端からの距離 [px]
<span id='line665' class='line'> 665</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} .width 横幅 [px]
<span id='line666' class='line'> 666</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} .height 高さ [px]
<span id='line667' class='line'> 667</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line668' class='line'> 668</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getNodeRect</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aParent</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line669' class='line'> 669</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">elementRect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aElement.getBoundingClientRect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line670' class='line'> 670</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line671' class='line'> 671</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">aParent</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line672' class='line'> 672</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentRect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aParent.getBoundingClientRect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line673' class='line'> 673</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line674' class='line'> 674</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line675' class='line'> 675</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">left</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.left</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">parentRect.left</span><span class="PUNC">,</span><span class="WHIT">
<span id='line676' class='line'> 676</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">right</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.right</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">parentRect.right</span><span class="PUNC">,</span><span class="WHIT">
<span id='line677' class='line'> 677</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">top</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.top</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">parentRect.top</span><span class="PUNC">,</span><span class="WHIT">
<span id='line678' class='line'> 678</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">bottom</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.bottom</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">parentRect.bottom</span><span class="PUNC">,</span><span class="WHIT">
<span id='line679' class='line'> 679</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.right</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">elementRect.left</span><span class="PUNC">,</span><span class="WHIT">
<span id='line680' class='line'> 680</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.bottom</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">elementRect.top</span><span class="WHIT">
<span id='line681' class='line'> 681</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line682' class='line'> 682</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line683' class='line'> 683</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line684' class='line'> 684</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">left</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.left</span><span class="PUNC">,</span><span class="WHIT">
<span id='line685' class='line'> 685</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">right</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.right</span><span class="PUNC">,</span><span class="WHIT">
<span id='line686' class='line'> 686</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">top</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.top</span><span class="PUNC">,</span><span class="WHIT">
<span id='line687' class='line'> 687</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">bottom</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.bottom</span><span class="PUNC">,</span><span class="WHIT">
<span id='line688' class='line'> 688</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.right</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">elementRect.left</span><span class="PUNC">,</span><span class="WHIT">
<span id='line689' class='line'> 689</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.bottom</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">elementRect.top</span><span class="WHIT">
<span id='line690' class='line'> 690</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line691' class='line'> 691</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line692' class='line'> 692</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line693' class='line'> 693</span> 
<span id='line694' class='line'> 694</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aboutOS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line695' class='line'> 695</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">message</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT">
<span id='line696' class='line'> 696</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'Dinos ver 0.0.1'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line697' class='line'> 697</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'Created by nodaguti'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line698' class='line'> 698</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span id='line699' class='line'> 699</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'Dinos stands for "Dinos Is Not OS."'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line700' class='line'> 700</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'This is JavaScript-based OS.'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line701' class='line'> 701</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span id='line702' class='line'> 702</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;a href="javascript:joCore.showChangeLog();">Change Log&lt;/a>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line703' class='line'> 703</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;a href="javascript:joCore.showThanks();">Thanks&lt;/a>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line704' class='line'> 704</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">'&lt;br />'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line705' class='line'> 705</span> 
<span id='line706' class='line'> 706</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joDialog</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line707' class='line'> 707</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">,</span><span class="WHIT">
<span id='line708' class='line'> 708</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">,</span><span class="WHIT">
<span id='line709' class='line'> 709</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">500</span><span class="PUNC">,</span><span class="WHIT">
<span id='line710' class='line'> 710</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">300</span><span class="PUNC">,</span><span class="WHIT">
<span id='line711' class='line'> 711</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">message</span><span class="PUNC">,</span><span class="WHIT">
<span id='line712' class='line'> 712</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">application</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'System'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line713' class='line'> 713</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'About This OS'</span><span class="WHIT">
<span id='line714' class='line'> 714</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line715' class='line'> 715</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line716' class='line'> 716</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line717' class='line'> 717</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">showChangeLog</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line718' class='line'> 718</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.IO.read</span><span class="PUNC">(</span><span class="STRN">'ChangeLog.txt'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'text/plain'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">log</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line719' class='line'> 719</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joDialog</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line720' class='line'> 720</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">110</span><span class="PUNC">,</span><span class="WHIT">
<span id='line721' class='line'> 721</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">110</span><span class="PUNC">,</span><span class="WHIT">
<span id='line722' class='line'> 722</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">500</span><span class="PUNC">,</span><span class="WHIT">
<span id='line723' class='line'> 723</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">300</span><span class="PUNC">,</span><span class="WHIT">
<span id='line724' class='line'> 724</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">log.responseText.replace</span><span class="PUNC">(</span><span class="REGX">/\n/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'&lt;br />'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line725' class='line'> 725</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">application</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'System'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line726' class='line'> 726</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Change Log'</span><span class="WHIT">
<span id='line727' class='line'> 727</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line728' class='line'> 728</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line729' class='line'> 729</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line730' class='line'> 730</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line731' class='line'> 731</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">showThanks</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line732' class='line'> 732</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.IO.read</span><span class="PUNC">(</span><span class="STRN">'Thanks.txt'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'text/plain'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">log</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line733' class='line'> 733</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joDialog</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line734' class='line'> 734</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">x</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">110</span><span class="PUNC">,</span><span class="WHIT">
<span id='line735' class='line'> 735</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">y</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">110</span><span class="PUNC">,</span><span class="WHIT">
<span id='line736' class='line'> 736</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">500</span><span class="PUNC">,</span><span class="WHIT">
<span id='line737' class='line'> 737</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">300</span><span class="PUNC">,</span><span class="WHIT">
<span id='line738' class='line'> 738</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">log.responseText.replace</span><span class="PUNC">(</span><span class="REGX">/\n/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'&lt;br />'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line739' class='line'> 739</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">application</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'System'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line740' class='line'> 740</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Change Log'</span><span class="WHIT">
<span id='line741' class='line'> 741</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line742' class='line'> 742</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line743' class='line'> 743</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line744' class='line'> 744</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line745' class='line'> 745</span> 
<span id='line746' class='line'> 746</span> </span><span class="doccmt">/**
<span id='line747' class='line'> 747</span>  * IO
<span id='line748' class='line'> 748</span>  * <span class="doctag">@class</span>
<span id='line749' class='line'> 749</span>  */</span><span class="WHIT">
<span id='line750' class='line'> 750</span> </span><span class="NAME">joCore.IO</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line751' class='line'> 751</span> 
<span id='line752' class='line'> 752</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line753' class='line'> 753</span> &nbsp;&nbsp;&nbsp;&nbsp; * ファイルを読み込む（DOM0）
<span id='line754' class='line'> 754</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line755' class='line'> 755</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> aFileType {String} js,css,無指定 のどれか
<span id='line756' class='line'> 756</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> aFilePath {String} main.js からみた相対パス
<span id='line757' class='line'> 757</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Deferred} js: script要素&lt;br>
<span id='line758' class='line'> 758</span> &nbsp;&nbsp;&nbsp;&nbsp; *                    css: link要素&lt;br>
<span id='line759' class='line'> 759</span> &nbsp;&nbsp;&nbsp;&nbsp; *                    その他: iframe要素が返る
<span id='line760' class='line'> 760</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line761' class='line'> 761</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">load</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aFileType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line762' class='line'> 762</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Deferred</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line763' class='line'> 763</span> 
<span id='line764' class='line'> 764</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aFileType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'js'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">joCore.createNode</span><span class="PUNC">(</span><span class="STRN">'script'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line765' class='line'> 765</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'text/javascript'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line766' class='line'> 766</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">src</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="WHIT">
<span id='line767' class='line'> 767</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span id='line768' class='line'> 768</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span><span class="NAME">aFileType</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'css'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">joCore.createNode</span><span class="PUNC">(</span><span class="STRN">'link'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line769' class='line'> 769</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">type</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'text/css'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line770' class='line'> 770</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">href</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">,</span><span class="WHIT">
<span id='line771' class='line'> 771</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">rel</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'stylesheet'</span><span class="WHIT">
<span id='line772' class='line'> 772</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span id='line773' class='line'> 773</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span><span class="NAME">joCore.createNode</span><span class="PUNC">(</span><span class="STRN">'iframe'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line774' class='line'> 774</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">href</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">,</span><span class="WHIT">
<span id='line775' class='line'> 775</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">style</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'width:0;height:0;visibility:hidden'</span><span class="WHIT">
<span id='line776' class='line'> 776</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line777' class='line'> 777</span> 
<span id='line778' class='line'> 778</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">tag.addEventListener</span><span class="PUNC">(</span><span class="STRN">'load'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">deferred.call</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line779' class='line'> 779</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">;</span><span class="WHIT">
<span id='line780' class='line'> 780</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line781' class='line'> 781</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line782' class='line'> 782</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line783' class='line'> 783</span> &nbsp;&nbsp;&nbsp;&nbsp; * ファイルを読み込む（Ajax）
<span id='line784' class='line'> 784</span> &nbsp;&nbsp;&nbsp;&nbsp; * 
<span id='line785' class='line'> 785</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aFilePath 読み込むファイル
<span id='line786' class='line'> 786</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} [aMimeType="text/xml"] ファイルのMimeType
<span id='line787' class='line'> 787</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Deferred} XMLHttpRequestオブジェクトが返る
<span id='line788' class='line'> 788</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line789' class='line'> 789</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">read</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aFilePath</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aMimeType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line790' class='line'> 790</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Deferred</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line791' class='line'> 791</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">req</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line792' class='line'> 792</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">req.onreadystatechange</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line793' class='line'> 793</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">req.readyState</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line794' class='line'> 794</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">req.status</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">req.status</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">200</span><span class="PUNC">)</span><span class="WHIT">
<span id='line795' class='line'> 795</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deferred.call</span><span class="PUNC">(</span><span class="NAME">req</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line796' class='line'> 796</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">else</span><span class="WHIT">
<span id='line797' class='line'> 797</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deferred.fail</span><span class="PUNC">(</span><span class="NAME">req</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line798' class='line'> 798</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line799' class='line'> 799</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line800' class='line'> 800</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">req.open</span><span class="PUNC">(</span><span class="STRN">'GET'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line801' class='line'> 801</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">req.overrideMimeType</span><span class="PUNC">(</span><span class="NAME">aMimeType</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">'text/xml'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line802' class='line'> 802</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">req.send</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line803' class='line'> 803</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line804' class='line'> 804</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">;</span><span class="WHIT">
<span id='line805' class='line'> 805</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line806' class='line'> 806</span> 
<span id='line807' class='line'> 807</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line808' class='line'> 808</span> &nbsp;&nbsp;&nbsp;&nbsp; * ファイルに書き込む
<span id='line809' class='line'> 809</span> &nbsp;&nbsp;&nbsp;&nbsp; * もし当該ファイルが存在していなかった場合には自動で作成する
<span id='line810' class='line'> 810</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line811' class='line'> 811</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aString 書き込むデータ
<span id='line812' class='line'> 812</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aFilePath 書き込み先のファイル
<span id='line813' class='line'> 813</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Node} 書き込み先のファイルのノード
<span id='line814' class='line'> 814</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line815' class='line'> 815</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">write</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line816' class='line'> 816</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fileName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joFileManager.getFileNameFromPath</span><span class="PUNC">(</span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line817' class='line'> 817</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">folderPath</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joFileManager.getParentFolderFromPath</span><span class="PUNC">(</span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line818' class='line'> 818</span> 
<span id='line819' class='line'> 819</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.log</span><span class="PUNC">(</span><span class="STRN">'write a file:'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">file</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">fileName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">folder</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">folderPath</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line820' class='line'> 820</span> 
<span id='line821' class='line'> 821</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">joFileManager.exist</span><span class="PUNC">(</span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line822' class='line'> 822</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joFileManager.write</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line823' class='line'> 823</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line824' class='line'> 824</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joFileManager.createFile</span><span class="PUNC">(</span><span class="NAME">fileName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">folderPath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line825' class='line'> 825</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joFileManager.write</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line826' class='line'> 826</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line827' class='line'> 827</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line828' class='line'> 828</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line829' class='line'> 829</span> 
<span id='line830' class='line'> 830</span> </span><span class="doccmt">/**
<span id='line831' class='line'> 831</span>  * Logger
<span id='line832' class='line'> 832</span>  * <span class="doctag">@class</span>
<span id='line833' class='line'> 833</span>  */</span><span class="WHIT">
<span id='line834' class='line'> 834</span> </span><span class="NAME">joCore.logger</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line835' class='line'> 835</span> 
<span id='line836' class='line'> 836</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line837' class='line'> 837</span> &nbsp;&nbsp;&nbsp;&nbsp; * ログを取る&lt;br>
<span id='line838' class='line'> 838</span> &nbsp;&nbsp;&nbsp;&nbsp; * console.log, window.dump, alertの順に試行する
<span id='line839' class='line'> 839</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line840' class='line'> 840</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {All} mes 複数の引数を指定した場合は半角スペースで区切って出力する
<span id='line841' class='line'> 841</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line842' class='line'> 842</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">log</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">mes</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line843' class='line'> 843</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">window.console</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.dump</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line844' class='line'> 844</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">window.console</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">window.console.log</span><span class="PUNC">(</span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line845' class='line'> 845</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">window.dump</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">window.dump</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">' '</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\n'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line846' class='line'> 846</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line847' class='line'> 847</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">alert</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">'\n'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line848' class='line'> 848</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line849' class='line'> 849</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line850' class='line'> 850</span> 
<span id='line851' class='line'> 851</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line852' class='line'> 852</span> &nbsp;&nbsp;&nbsp;&nbsp; * エラーを出力する&lt;br>
<span id='line853' class='line'> 853</span> &nbsp;&nbsp;&nbsp;&nbsp; * できるかぎりスタックトレースの出力を試みる
<span id='line854' class='line'> 854</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line855' class='line'> 855</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Error} mes エラーオブジェクト&lt;br>
<span id='line856' class='line'> 856</span> &nbsp;&nbsp;&nbsp;&nbsp; *                    Firefoxの場合はエラーオブジェクトを渡さなくてもスタックトレースがとれる
<span id='line857' class='line'> 857</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line858' class='line'> 858</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">error</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">mes</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line859' class='line'> 859</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.log</span><span class="PUNC">(</span><span class="NAME">mes</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line860' class='line'> 860</span> 
<span id='line861' class='line'> 861</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">console.trace</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line862' class='line'> 862</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.log</span><span class="PUNC">(</span><span class="NAME">console.trace</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//Fire bug</span><span class="WHIT">
<span id='line863' class='line'> 863</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">mes.stacktrace</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line864' class='line'> 864</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.log</span><span class="PUNC">(</span><span class="NAME">mes.stacktrace</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//Opera</span><span class="WHIT">
<span id='line865' class='line'> 865</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">mes.stack</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line866' class='line'> 866</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.log</span><span class="PUNC">(</span><span class="NAME">mes.stack</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//Other</span><span class="WHIT">
<span id='line867' class='line'> 867</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line868' class='line'> 868</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line869' class='line'> 869</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.log</span><span class="PUNC">(</span><span class="NAME">Error</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">stack</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//Firefox</span><span class="WHIT">
<span id='line870' class='line'> 870</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span id='line871' class='line'> 871</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line872' class='line'> 872</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line873' class='line'> 873</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line874' class='line'> 874</span> 
<span id='line875' class='line'> 875</span> </span><span class="doccmt">/**
<span id='line876' class='line'> 876</span>  * ファイルシステム
<span id='line877' class='line'> 877</span>  * <span class="doctag">@class</span>
<span id='line878' class='line'> 878</span>  */</span><span class="WHIT">
<span id='line879' class='line'> 879</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">joFileManager</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line880' class='line'> 880</span> 
<span id='line881' class='line'> 881</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line882' class='line'> 882</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Deferred</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line883' class='line'> 883</span> 
<span id='line884' class='line'> 884</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.storage = uu('Storage');</span><span class="WHIT">
<span id='line885' class='line'> 885</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(this.storage.toString() === 'MemStorage') this.storage = null;</span><span class="WHIT">
<span id='line886' class='line'> 886</span> 
<span id='line887' class='line'> 887</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.storage</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line888' class='line'> 888</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.fileTree</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.textToDOM</span><span class="PUNC">(</span><span class="NAME">this.storage.get</span><span class="PUNC">(</span><span class="STRN">'fileTree'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line889' class='line'> 889</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line890' class='line'> 890</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joCore.IO.read</span><span class="PUNC">(</span><span class="STRN">'disk.xml'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line891' class='line'> 891</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">req</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line892' class='line'> 892</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joFileManager.fileTree</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">req.responseXML</span><span class="PUNC">;</span><span class="WHIT">
<span id='line893' class='line'> 893</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line894' class='line'> 894</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line895' class='line'> 895</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line896' class='line'> 896</span> 
<span id='line897' class='line'> 897</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line898' class='line'> 898</span> &nbsp;&nbsp;&nbsp;&nbsp; * ファイルツリーを保存する
<span id='line899' class='line'> 899</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line900' class='line'> 900</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_saveFileTree</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line901' class='line'> 901</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var treeText = joCore.DOMToText(this.fileTree);</span><span class="WHIT">
<span id='line902' class='line'> 902</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;location.href = 'data:application/octet-stream,' + encodeURIComponent(treeText);</span><span class="WHIT">
<span id='line903' class='line'> 903</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line904' class='line'> 904</span> 
<span id='line905' class='line'> 905</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line906' class='line'> 906</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line907' class='line'> 907</span> &nbsp;&nbsp;&nbsp;&nbsp; * パスをCSSに変換する
<span id='line908' class='line'> 908</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line909' class='line'> 909</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath パス
<span id='line910' class='line'> 910</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {String} そのパスが指すフォルダを示すCSS&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line911' class='line'> 911</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line912' class='line'> 912</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_pathToCSS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line913' class='line'> 913</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">aPath.replace</span><span class="PUNC">(</span><span class="STRN">'dinos:/'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'root'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line914' class='line'> 914</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\//g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'>'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line915' class='line'> 915</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/>([^>]+)$/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'>file[name="$1"]'</span><span class="PUNC">)</span><span class="WHIT">    </span><span class="COMM">//file name</span><span class="WHIT">
<span id='line916' class='line'> 916</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/(.[^>]*)>/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'folder[name="$1"]>'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line917' class='line'> 917</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/>$/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line918' class='line'> 918</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line919' class='line'> 919</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line920' class='line'> 920</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line921' class='line'> 921</span> &nbsp;&nbsp;&nbsp;&nbsp; * ファイルの名前を返す&lt;br>
<span id='line922' class='line'> 922</span> &nbsp;&nbsp;&nbsp;&nbsp; *   ファイルのパスを指定した場合： そのファイルの名前を返す&lt;br>
<span id='line923' class='line'> 923</span> &nbsp;&nbsp;&nbsp;&nbsp; *   フォルダのパスを指定した場合： 空文字を返す
<span id='line924' class='line'> 924</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line925' class='line'> 925</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath パス
<span id='line926' class='line'> 926</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {String} ファイルの名前
<span id='line927' class='line'> 927</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line928' class='line'> 928</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getFileNameFromPath</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line929' class='line'> 929</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">aPath.match</span><span class="PUNC">(</span><span class="REGX">/([^\/]*)$/</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line930' class='line'> 930</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line931' class='line'> 931</span> 
<span id='line932' class='line'> 932</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line933' class='line'> 933</span> &nbsp;&nbsp;&nbsp;&nbsp; * フォルダの名前を返す&lt;br>
<span id='line934' class='line'> 934</span> &nbsp;&nbsp;&nbsp;&nbsp; *   ファイルのパスを指定した場合： ファイルが入っているフォルダの名前を返す&lt;br>
<span id='line935' class='line'> 935</span> &nbsp;&nbsp;&nbsp;&nbsp; *   フォルダのパスを指定した場合： そのフォルダの名前を返す
<span id='line936' class='line'> 936</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line937' class='line'> 937</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath パス
<span id='line938' class='line'> 938</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {String} フォルダの名前
<span id='line939' class='line'> 939</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line940' class='line'> 940</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getFolderNameFromPath</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line941' class='line'> 941</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">aPath.match</span><span class="PUNC">(</span><span class="REGX">/([^\/]*)\/[^\/]*$/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">'Dinos'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line942' class='line'> 942</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line943' class='line'> 943</span> 
<span id='line944' class='line'> 944</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line945' class='line'> 945</span> &nbsp;&nbsp;&nbsp;&nbsp; * 親フォルダのパスを返す
<span id='line946' class='line'> 946</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line947' class='line'> 947</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath パス
<span id='line948' class='line'> 948</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {String/DinosPath} フォルダのパス
<span id='line949' class='line'> 949</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line950' class='line'> 950</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getParentFolderFromPath</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line951' class='line'> 951</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="REGX">/\/$/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line952' class='line'> 952</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//フォルダのとき</span><span class="WHIT">
<span id='line953' class='line'> 953</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">aPath.replace</span><span class="PUNC">(</span><span class="REGX">/[^\/]*\/?$/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line954' class='line'> 954</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line955' class='line'> 955</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//ファイルのとき</span><span class="WHIT">
<span id='line956' class='line'> 956</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getParentFolderFromPath</span><span class="PUNC">(</span><span class="NAME">aPath.replace</span><span class="PUNC">(</span><span class="REGX">/[^\/]+$/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'dammy/'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line957' class='line'> 957</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line958' class='line'> 958</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line959' class='line'> 959</span> 
<span id='line960' class='line'> 960</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line961' class='line'> 961</span> &nbsp;&nbsp;&nbsp;&nbsp; * 親フォルダのパスツリーを返す
<span id='line962' class='line'> 962</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line963' class='line'> 963</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath パス
<span id='line964' class='line'> 964</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Array} 親フォルダのパス群が入った配列
<span id='line965' class='line'> 965</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line966' class='line'> 966</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getFolderTreeFromPath</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line967' class='line'> 967</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">returnArray</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aPath</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aPath.replace</span><span class="PUNC">(</span><span class="REGX">/[^\/]+$/</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line968' class='line'> 968</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line969' class='line'> 969</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">getTree</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line970' class='line'> 970</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">returnArray.push</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line971' class='line'> 971</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joFileManager.getParentFolderFromPath</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line972' class='line'> 972</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">parent.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">8</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">getTree</span><span class="PUNC">(</span><span class="NAME">parent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// dinos:// になったらやめる</span><span class="WHIT">
<span id='line973' class='line'> 973</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line974' class='line'> 974</span> 
<span id='line975' class='line'> 975</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getTree</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line976' class='line'> 976</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line977' class='line'> 977</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">returnArray</span><span class="PUNC">;</span><span class="WHIT">
<span id='line978' class='line'> 978</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line979' class='line'> 979</span> 
<span id='line980' class='line'> 980</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line981' class='line'> 981</span> &nbsp;&nbsp;&nbsp;&nbsp; * ファイルを取得する
<span id='line982' class='line'> 982</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line983' class='line'> 983</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath パス
<span id='line984' class='line'> 984</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Node} ファイルのノード
<span id='line985' class='line'> 985</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line986' class='line'> 986</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getFile</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line987' class='line'> 987</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">path</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._pathToCSS</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line988' class='line'> 988</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.log</span><span class="PUNC">(</span><span class="STRN">'Get file:'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line989' class='line'> 989</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uuQuery</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.fileTree</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line990' class='line'> 990</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result.length</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span id='line991' class='line'> 991</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line992' class='line'> 992</span> 
<span id='line993' class='line'> 993</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line994' class='line'> 994</span> &nbsp;&nbsp;&nbsp;&nbsp; * ファイルを作成する&lt;br>
<span id='line995' class='line'> 995</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定した親フォルダがない場合は自動で作成する
<span id='line996' class='line'> 996</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line997' class='line'> 997</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aName 作成するファイルの名前
<span id='line998' class='line'> 998</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath 親フォルダのパス
<span id='line999' class='line'> 999</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} [aAttrs] ファイルに付加する属性
<span id='line1000' class='line'>1000</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Node} 作成されたファイルのノード
<span id='line1001' class='line'>1001</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1002' class='line'>1002</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">createFile</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aPath</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aAttrs</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1003' class='line'>1003</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFile</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1004' class='line'>1004</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">parent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.createFolder</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1005' class='line'>1005</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1006' class='line'>1006</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">aAttrs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">aAttrs.name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aName</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1007' class='line'>1007</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1008' class='line'>1008</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">file</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.createNode</span><span class="PUNC">(</span><span class="STRN">'file'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aAttrs</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aName</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1009' class='line'>1009</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">parent.appendChild</span><span class="PUNC">(</span><span class="NAME">file</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1010' class='line'>1010</span> 
<span id='line1011' class='line'>1011</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._saveFileTree</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1012' class='line'>1012</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1013' class='line'>1013</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">file</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1014' class='line'>1014</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1015' class='line'>1015</span> 
<span id='line1016' class='line'>1016</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1017' class='line'>1017</span> &nbsp;&nbsp;&nbsp;&nbsp; * フォルダを作成する&lt;br>
<span id='line1018' class='line'>1018</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定したフォルダが存在しない場合は自動で作成する
<span id='line1019' class='line'>1019</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line1020' class='line'>1020</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath 作成するフォルダのパス
<span id='line1021' class='line'>1021</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Node} 作成したフォルダのノード
<span id='line1022' class='line'>1022</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1023' class='line'>1023</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">createFolder</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1024' class='line'>1024</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">folderTree</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFolderTreeFromPath</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1025' class='line'>1025</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1026' class='line'>1026</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//存在する最も深いフォルダを調べる</span><span class="WHIT">
<span id='line1027' class='line'>1027</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deepestIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1028' class='line'>1028</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">folderTree.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aFolder</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aIndex</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aArray</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1029' class='line'>1029</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">joFileManager.exist</span><span class="PUNC">(</span><span class="NAME">aFolder</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">deepestIndex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aIndex</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1030' class='line'>1030</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1031' class='line'>1031</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deepestIndex</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1032' class='line'>1032</span> 
<span id='line1033' class='line'>1033</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFile</span><span class="PUNC">(</span><span class="NAME">folderTree</span><span class="PUNC">[</span><span class="NAME">deepestIndex</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1034' class='line'>1034</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">folderName</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1035' class='line'>1035</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">deepestIndex</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1036' class='line'>1036</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">folderName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFolderNameFromPath</span><span class="PUNC">(</span><span class="NAME">folderTree</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1037' class='line'>1037</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.log</span><span class="PUNC">(</span><span class="STRN">'Create Folder:'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">folderName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1038' class='line'>1038</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">node</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.createNode</span><span class="PUNC">(</span><span class="STRN">'folder'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">folderName</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1039' class='line'>1039</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">parent.appendChild</span><span class="PUNC">(</span><span class="NAME">node</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1040' class='line'>1040</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">node</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1041' class='line'>1041</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1042' class='line'>1042</span> 
<span id='line1043' class='line'>1043</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._saveFileTree</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1044' class='line'>1044</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1045' class='line'>1045</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1046' class='line'>1046</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1047' class='line'>1047</span> 
<span id='line1048' class='line'>1048</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1049' class='line'>1049</span> &nbsp;&nbsp;&nbsp;&nbsp; * フォルダ/ファイルが存在するかどうか調べる
<span id='line1050' class='line'>1050</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line1051' class='line'>1051</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath パス
<span id='line1052' class='line'>1052</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Boolean}
<span id='line1053' class='line'>1053</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1054' class='line'>1054</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">exist</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1055' class='line'>1055</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getFile</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1056' class='line'>1056</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1057' class='line'>1057</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1058' class='line'>1058</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1059' class='line'>1059</span> &nbsp;&nbsp;&nbsp;&nbsp; * あるフォルダが指定したファイルを含んでいるかどうか調べる
<span id='line1060' class='line'>1060</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line1061' class='line'>1061</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aContainer 調べるフォルダ
<span id='line1062' class='line'>1062</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath 調べるファイル
<span id='line1063' class='line'>1063</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Boolean} isRecursive 子フォルダも対象にするかどうか
<span id='line1064' class='line'>1064</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Boolean}
<span id='line1065' class='line'>1065</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1066' class='line'>1066</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">isContain</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aContainer</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aPath</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">isRecursive</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1067' class='line'>1067</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">isRecursive</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1068' class='line'>1068</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">aPath.indexOf</span><span class="PUNC">(</span><span class="NAME">aContainer</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1069' class='line'>1069</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1070' class='line'>1070</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getParentFolderFromPath</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">aContainer</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1071' class='line'>1071</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1072' class='line'>1072</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1073' class='line'>1073</span> 
<span id='line1074' class='line'>1074</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1075' class='line'>1075</span> &nbsp;&nbsp;&nbsp;&nbsp; * ファイルに書き込む
<span id='line1076' class='line'>1076</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line1077' class='line'>1077</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aData 書き込むデータ
<span id='line1078' class='line'>1078</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath 書き込み先のファイルのパス
<span id='line1079' class='line'>1079</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Node} 書き込んだファイルのノード
<span id='line1080' class='line'>1080</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1081' class='line'>1081</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">write</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aData</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1082' class='line'>1082</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">file</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFile</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1083' class='line'>1083</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">file.setAttribute</span><span class="PUNC">(</span><span class="STRN">'data'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aData</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1084' class='line'>1084</span> 
<span id='line1085' class='line'>1085</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._saveFileTree</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1086' class='line'>1086</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1087' class='line'>1087</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">file</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1088' class='line'>1088</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1089' class='line'>1089</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1090' class='line'>1090</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1091' class='line'>1091</span> &nbsp;&nbsp;&nbsp;&nbsp; * ファイルを移動する
<span id='line1092' class='line'>1092</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line1093' class='line'>1093</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath 移動するファイルのパス
<span id='line1094' class='line'>1094</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} moveTo 移動先のフォルダのパス
<span id='line1095' class='line'>1095</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1096' class='line'>1096</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">move</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">moveTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1097' class='line'>1097</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">file</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFile</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1098' class='line'>1098</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">moveToFolder</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFile</span><span class="PUNC">(</span><span class="NAME">moveTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1099' class='line'>1099</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1100' class='line'>1100</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.moveNode</span><span class="PUNC">(</span><span class="NAME">file</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">moveToFolder</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1101' class='line'>1101</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1102' class='line'>1102</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1103' class='line'>1103</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1104' class='line'>1104</span> &nbsp;&nbsp;&nbsp;&nbsp; * ファイルをリネームする
<span id='line1105' class='line'>1105</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line1106' class='line'>1106</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath リネームするファイル
<span id='line1107' class='line'>1107</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} newName リネーム後の名前
<span id='line1108' class='line'>1108</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1109' class='line'>1109</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">rename</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">newName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1110' class='line'>1110</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">file</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFile</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1111' class='line'>1111</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">file.setAttribute</span><span class="PUNC">(</span><span class="STRN">'name'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">newName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1112' class='line'>1112</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1113' class='line'>1113</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1114' class='line'>1114</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1115' class='line'>1115</span> &nbsp;&nbsp;&nbsp;&nbsp; * ファイルを削除する
<span id='line1116' class='line'>1116</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line1117' class='line'>1117</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aPath 削除するファイル
<span id='line1118' class='line'>1118</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Boolean} 削除に成功したかどうか
<span id='line1119' class='line'>1119</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1120' class='line'>1120</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deleteFile</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1121' class='line'>1121</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">file</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getFile</span><span class="PUNC">(</span><span class="NAME">aPath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1122' class='line'>1122</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1123' class='line'>1123</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">file</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1124' class='line'>1124</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1125' class='line'>1125</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1126' class='line'>1126</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">file.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">file</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1127' class='line'>1127</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1128' class='line'>1128</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1129' class='line'>1129</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1130' class='line'>1130</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1131' class='line'>1131</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1132' class='line'>1132</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1133' class='line'>1133</span> 
<span id='line1134' class='line'>1134</span> 
<span id='line1135' class='line'>1135</span> </span><span class="doccmt">/**
<span id='line1136' class='line'>1136</span>  * joDisplay
<span id='line1137' class='line'>1137</span>  * <span class="doctag">@class</span>
<span id='line1138' class='line'>1138</span>  */</span><span class="WHIT">
<span id='line1139' class='line'>1139</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">joDisplay</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line1140' class='line'>1140</span> 
<span id='line1141' class='line'>1141</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1142' class='line'>1142</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.setOffset</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">joCore.getNodeRect</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'menubar'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1143' class='line'>1143</span> 
<span id='line1144' class='line'>1144</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'resize'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.onResize</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1145' class='line'>1145</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.onResize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1146' class='line'>1146</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1147' class='line'>1147</span> 
<span id='line1148' class='line'>1148</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">displayWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1149' class='line'>1149</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.documentElement.clientWidth</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this._offsetX</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1150' class='line'>1150</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1151' class='line'>1151</span> 
<span id='line1152' class='line'>1152</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">displayHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1153' class='line'>1153</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.documentElement.clientHeight</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this._offsetY</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1154' class='line'>1154</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1155' class='line'>1155</span> 
<span id='line1156' class='line'>1156</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">setOffset</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1157' class='line'>1157</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._offsetX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1158' class='line'>1158</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._offsetY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1159' class='line'>1159</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1160' class='line'>1160</span> 
<span id='line1161' class='line'>1161</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">onResize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1162' class='line'>1162</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.addStyle</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'windows'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line1163' class='line'>1163</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'top'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this._offsetY</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1164' class='line'>1164</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">left</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this._offsetX</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1165' class='line'>1165</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.displayWidth</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1166' class='line'>1166</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.displayHeight</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="WHIT">
<span id='line1167' class='line'>1167</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1168' class='line'>1168</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1169' class='line'>1169</span> 
<span id='line1170' class='line'>1170</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1171' class='line'>1171</span> 
<span id='line1172' class='line'>1172</span> 
<span id='line1173' class='line'>1173</span> </span><span class="doccmt">/**
<span id='line1174' class='line'>1174</span>  * Application's Objects
<span id='line1175' class='line'>1175</span>  * <span class="doctag">@type</span> Object
<span id='line1176' class='line'>1176</span>  */</span><span class="WHIT">
<span id='line1177' class='line'>1177</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">joApps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1178' class='line'>1178</span> 
<span id='line1179' class='line'>1179</span> </span><span class="doccmt">/**
<span id='line1180' class='line'>1180</span>  * アプリケーションを管理する
<span id='line1181' class='line'>1181</span>  * <span class="doctag">@class</span>
<span id='line1182' class='line'>1182</span>  */</span><span class="WHIT">
<span id='line1183' class='line'>1183</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">joAppManager</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line1184' class='line'>1184</span> 
<span id='line1185' class='line'>1185</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1186' class='line'>1186</span> &nbsp;&nbsp;&nbsp;&nbsp; * Installed Applications
<span id='line1187' class='line'>1187</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> Array
<span id='line1188' class='line'>1188</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1189' class='line'>1189</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">apps</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT">
<span id='line1190' class='line'>1190</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'Menubar'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1191' class='line'>1191</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'Finder'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1192' class='line'>1192</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'TextEditor'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1193' class='line'>1193</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'Console'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1194' class='line'>1194</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1195' class='line'>1195</span> 
<span id='line1196' class='line'>1196</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1197' class='line'>1197</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joAppManager</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1198' class='line'>1198</span> 
<span id='line1199' class='line'>1199</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Deferred.loop</span><span class="PUNC">(</span><span class="NAME">self.apps.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1200' class='line'>1200</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joCore.IO.read</span><span class="PUNC">(</span><span class="STRN">'apps/'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">self.apps</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'/'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">self.apps</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'.app.js'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'text/plain'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line1201' class='line'>1201</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1202' class='line'>1202</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//無名関数で包んで実行する</span><span class="WHIT">
<span id='line1203' class='line'>1203</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">eval</span><span class="PUNC">(</span><span class="STRN">'(function(){'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">data.responseText</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'})();'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1204' class='line'>1204</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1205' class='line'>1205</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//joApps以下に正しくインストールされなかったものは無効化する</span><span class="WHIT">
<span id='line1206' class='line'>1206</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//きちんとインストールされたものはstartを実行</span><span class="WHIT">
<span id='line1207' class='line'>1207</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">joApps</span><span class="PUNC">[</span><span class="NAME">self.apps</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1208' class='line'>1208</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1209' class='line'>1209</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">joApps</span><span class="PUNC">[</span><span class="NAME">self.apps</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">start</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1210' class='line'>1210</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joApps</span><span class="PUNC">[</span><span class="NAME">self.apps</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">start</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1211' class='line'>1211</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1212' class='line'>1212</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1213' class='line'>1213</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joFileManager.createFile</span><span class="PUNC">(</span><span class="NAME">self.apps</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'.app'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'dinos://Applications/'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1214' class='line'>1214</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1215' class='line'>1215</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1216' class='line'>1216</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1217' class='line'>1217</span> 
<span id='line1218' class='line'>1218</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">uninit</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1219' class='line'>1219</span> 
<span id='line1220' class='line'>1220</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1221' class='line'>1221</span> 
<span id='line1222' class='line'>1222</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1223' class='line'>1223</span> &nbsp;&nbsp;&nbsp;&nbsp; * アプリケーション切り替え時に呼び出される
<span id='line1224' class='line'>1224</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line1225' class='line'>1225</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aAppName 切り替え後のアプリケーション名
<span id='line1226' class='line'>1226</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1227' class='line'>1227</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">changeActiveApp</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aAppName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1228' class='line'>1228</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.activeName</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">aAppName</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">aAppName</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'System'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1229' class='line'>1229</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joApps.Menubar.update</span><span class="PUNC">(</span><span class="NAME">joApps</span><span class="PUNC">[</span><span class="NAME">aAppName</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">menubar</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1230' class='line'>1230</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.activeName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aAppName</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1231' class='line'>1231</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1232' class='line'>1232</span> 
<span id='line1233' class='line'>1233</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1234' class='line'>1234</span> &nbsp;&nbsp;&nbsp;&nbsp; * 最も前面にあるウィンドウを得る
<span id='line1235' class='line'>1235</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line1236' class='line'>1236</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} [aAppName] 指定したアプリケーションのウィンドウに限定する
<span id='line1237' class='line'>1237</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Node} 見つからないときは null を返す
<span id='line1238' class='line'>1238</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1239' class='line'>1239</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getFrontWindow</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aAppName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1240' class='line'>1240</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">aAppName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">aAppName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1241' class='line'>1241</span> 
<span id='line1242' class='line'>1242</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_active</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uuQuery</span><span class="PUNC">(</span><span class="STRN">'[active="true"]'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1243' class='line'>1243</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line1244' class='line'>1244</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">_active.length</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">joCore.hasClass</span><span class="PUNC">(</span><span class="NAME">_active</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aAppName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_active</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1245' class='line'>1245</span> 
<span id='line1246' class='line'>1246</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1247' class='line'>1247</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//active=trueなwindowがない時はより厳密に判定してみる</span><span class="WHIT">
<span id='line1248' class='line'>1248</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">windows</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aAppName</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="NAME">aAppName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'windows'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'window'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'windows'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1249' class='line'>1249</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">max</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">frontWindow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1250' class='line'>1250</span> 
<span id='line1251' class='line'>1251</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">windows</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1252' class='line'>1252</span> 
<span id='line1253' class='line'>1253</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">windows.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1254' class='line'>1254</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">max</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">windows</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">style.zIndex</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1255' class='line'>1255</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">max</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">windows</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">style.zIndex</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1256' class='line'>1256</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">frontWindow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">windows</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1257' class='line'>1257</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1258' class='line'>1258</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1259' class='line'>1259</span> 
<span id='line1260' class='line'>1260</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">frontWindow</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1261' class='line'>1261</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1262' class='line'>1262</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1263' class='line'>1263</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1264' class='line'>1264</span> 
<span id='line1265' class='line'>1265</span> 
<span id='line1266' class='line'>1266</span> </span><span class="doccmt">/** <span class="doctag">@ignore</span> */</span><span class="WHIT">
<span id='line1267' class='line'>1267</span> </span><span class="NAME">window.xconfig</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">storage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">1000</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">1000</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// 1MB</span><span class="WHIT">
<span id='line1268' class='line'>1268</span> 
<span id='line1269' class='line'>1269</span> </span><span class="doccmt">/** <span class="doctag">@ignore</span> */</span><span class="WHIT">
<span id='line1270' class='line'>1270</span> </span><span class="NAME">window.xstorage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">uu</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">storage</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1271' class='line'>1271</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1272' class='line'>1272</span> </span><span class="PUNC">}</span></pre><div class='spacer'><span class='line'>&nbsp;&nbsp;&nbsp;&nbsp;</span></div></body></html>