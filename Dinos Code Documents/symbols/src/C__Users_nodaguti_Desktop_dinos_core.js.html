<html><head><meta http-equiv='content-type' content='text/html; charset=utf-8'>
	<script type='text/javascript' >
	window.onload=function(){
	    var num = document.getElementById(location.hash.replace(/^#/,''));
	    if (num) {
	        num.style.color = 'RGB(255,255,50)';
	        num.style.backgroundColor = 'RGB(255,140,0)';
	    }
	}
	</script>
	<style>
	body, pre {font-family: 'MS Gothic',monospace; font-size: 12px; color:RGB(48,48,48); line-height: 14px; margin: 0px;}
	.KEYW {color: RGB(0,160,255); font-weight:bold;}
	.COMM {color: RGB(120,192,0)}
	.NUMB {color: RGB(128,99,0)}
	.STRN {color: RGB(220,160,60)}
	.REGX {color: RGB(230,0,0)}
	.line {border-right: 1px dotted RGB(140,140,140); color: RGB(140,140,140); background-color: RGB(240,240,240); padding: 1px 1px 1px 3px;}
	.doccmt {color: RGB(150,150,255)}
	.doctag {color: RGB(90,90,255)}
	.spacer {height:6px;overflow:hidden;}
	</style></head>
	<body lang='ja'><div class='spacer'><span class='line'>&nbsp;&nbsp;&nbsp;&nbsp;</span></div><pre><span id='line1' class='line'>   1</span> <span class="doccmt">/**
<span id='line2' class='line'>   2</span>  * document.getElementById のシンタックスシュガー
<span id='line3' class='line'>   3</span>  * <span class="doctag">@param</span> {String} aID
<span id='line4' class='line'>   4</span>  * <span class="doctag">@return</span> {Node}
<span id='line5' class='line'>   5</span>  */</span><span class="WHIT">
<span id='line6' class='line'>   6</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="NAME">aID</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line7' class='line'>   7</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">aID</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line8' class='line'>   8</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line9' class='line'>   9</span> 
<span id='line10' class='line'>  10</span> </span><span class="doccmt">/**
<span id='line11' class='line'>  11</span>  * uidからノードを取得する
<span id='line12' class='line'>  12</span>  * <span class="doctag">@param</span> {String} uid
<span id='line13' class='line'>  13</span>  */</span><span class="WHIT">
<span id='line14' class='line'>  14</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">$U</span><span class="PUNC">(</span><span class="NAME">uid</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line15' class='line'>  15</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">uuQuery</span><span class="PUNC">(</span><span class="STRN">'[uid="'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">uid</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"]'</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line16' class='line'>  16</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line17' class='line'>  17</span> 
<span id='line18' class='line'>  18</span> </span><span class="doccmt">/**
<span id='line19' class='line'>  19</span>  * document.getElementsByClassName のシンタックスシュガー&lt;br>
<span id='line20' class='line'>  20</span>  * 該当ノードが1つしかない場合はノードそのものを返す
<span id='line21' class='line'>  21</span>  *
<span id='line22' class='line'>  22</span>  * <span class="doctag">@param</span> {String} aClass クラス名
<span id='line23' class='line'>  23</span>  * <span class="doctag">@param</span> {Node} [aTarget=":root"] 捜索範囲
<span id='line24' class='line'>  24</span>  * <span class="doctag">@param</span> {Boolean} [notRevealArray=false] falseを指定すると結果が１つの時も配列を返す
<span id='line25' class='line'>  25</span>  * <span class="doctag">@return</span> {Node|ElementArray}
<span id='line26' class='line'>  26</span>  */</span><span class="WHIT">
<span id='line27' class='line'>  27</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="NAME">aClass</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aTarget</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">notRevealArray</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line28' class='line'>  28</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uuQuery.className</span><span class="PUNC">(</span><span class="NAME">aClass</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aTarget</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line29' class='line'>  29</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">notRevealArray</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">result.length</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span id='line30' class='line'>  30</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line31' class='line'>  31</span> 
<span id='line32' class='line'>  32</span> </span><span class="doccmt">/**
<span id='line33' class='line'>  33</span>  * XPathで要素を得る
<span id='line34' class='line'>  34</span>  *
<span id='line35' class='line'>  35</span>  * <span class="doctag">@param</span> {String} aExpression XPath式
<span id='line36' class='line'>  36</span>  * <span class="doctag">@param</span> {Node} [aParent=":root"] 捜索範囲
<span id='line37' class='line'>  37</span>  * <span class="doctag">@return</span> {ElementArray}
<span id='line38' class='line'>  38</span>  */</span><span class="WHIT">
<span id='line39' class='line'>  39</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">$X</span><span class="PUNC">(</span><span class="NAME">aExpression</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aParent</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line40' class='line'>  40</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line41' class='line'>  41</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.evaluate</span><span class="PUNC">(</span><span class="NAME">aExpression</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aParent</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">document</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">XPathResult.ORDERED_NODE_SNAPSHOT_TYPE</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line42' class='line'>  42</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">x.snapshotLength</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line43' class='line'>  43</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="NAME">x.snapshotItem</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line44' class='line'>  44</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line45' class='line'>  45</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">;</span><span class="WHIT">
<span id='line46' class='line'>  46</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line47' class='line'>  47</span> 
<span id='line48' class='line'>  48</span> 
<span id='line49' class='line'>  49</span> </span><span class="doccmt">/** <span class="doctag">@ignore</span> */</span><span class="WHIT">
<span id='line50' class='line'>  50</span> </span><span class="NAME">window.xconfig</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">storage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">1000</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">1000</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">// 1MB</span><span class="WHIT">
<span id='line51' class='line'>  51</span> 
<span id='line52' class='line'>  52</span> </span><span class="doccmt">/** <span class="doctag">@ignore</span> */</span><span class="WHIT">
<span id='line53' class='line'>  53</span> </span><span class="NAME">window.xstorage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">uu</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">storage</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line54' class='line'>  54</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line55' class='line'>  55</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line56' class='line'>  56</span> 
<span id='line57' class='line'>  57</span> </span><span class="doccmt">/** <span class="doctag">@ignore</span> */</span><span class="WHIT">
<span id='line58' class='line'>  58</span> </span><span class="NAME">window.onbeforeunload</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line59' class='line'>  59</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">alert</span><span class="PUNC">(</span><span class="STRN">'本当にDinosを終了しますか？\n'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> 
<span id='line60' class='line'>  60</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   </span><span class="STRN">'PCの状態を保存しないまま終了した場合、すべての変更が失われます。\n'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> 
<span id='line61' class='line'>  61</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   </span><span class="STRN">'Dinosの終了をキャンセルする場合は次に表示されるダイアログでキャンセルしてください。\n'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> 
<span id='line62' class='line'>  62</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   </span><span class="STRN">'（保存するには、メニューバーより「Save Computer...」を選択してください。）'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line63' class='line'>  63</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span id='line64' class='line'>  64</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line65' class='line'>  65</span> 
<span id='line66' class='line'>  66</span> </span><span class="doccmt">/**
<span id='line67' class='line'>  67</span>  * 基本的な機能を提供する &lt;br>
<span id='line68' class='line'>  68</span>  * 直下には起動/終了関連の関数がある
<span id='line69' class='line'>  69</span>  * <span class="doctag">@class</span>
<span id='line70' class='line'>  70</span>  */</span><span class="WHIT">
<span id='line71' class='line'>  71</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">joCore</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line72' class='line'>  72</span> 
<span id='line73' class='line'>  73</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line74' class='line'>  74</span> &nbsp;&nbsp;&nbsp;&nbsp; * 起動時に表示するウィンドウ
<span id='line75' class='line'>  75</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> joWindow
<span id='line76' class='line'>  76</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line77' class='line'>  77</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_bootingWindow</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span id='line78' class='line'>  78</span> 
<span id='line79' class='line'>  79</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line80' class='line'>  80</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line81' class='line'>  81</span> &nbsp;&nbsp;&nbsp;&nbsp; * Dinos booting settings
<span id='line82' class='line'>  82</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> Object
<span id='line83' class='line'>  83</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line84' class='line'>  84</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">settings</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line85' class='line'>  85</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">NO_WAIT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="COMM">// 起動時のウェイトを入れるかどうか true: いれない [false]: いれる</span><span class="WHIT">
<span id='line86' class='line'>  86</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">BOOT_MODE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'FullScreen'</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="COMM">// 起動モード [FullScreen]: フルスクリーン（#displayな要素が固定幅でない場合） Window: ウィンドウ（#displayな要素が固定幅の場合）</span><span class="WHIT">
<span id='line87' class='line'>  87</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line88' class='line'>  88</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line89' class='line'>  89</span> &nbsp;&nbsp;&nbsp;&nbsp;
<span id='line90' class='line'>  90</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line91' class='line'>  91</span> &nbsp;&nbsp;&nbsp;&nbsp; * 起動時に実行され, 各オブジェクトの初期化を行う
<span id='line92' class='line'>  92</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@private</span>
<span id='line93' class='line'>  93</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line94' class='line'>  94</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line95' class='line'>  95</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//基本構造の構築</span><span class="WHIT">
<span id='line96' class='line'>  96</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'div'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'menubar'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'display'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line97' class='line'>  97</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'div'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'windows'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'display'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line98' class='line'>  98</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line99' class='line'>  99</span> &nbsp;&nbsp;&nbsp;&nbsp;
<span id='line100' class='line'> 100</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//起動画面の構築</span><span class="WHIT">
<span id='line101' class='line'> 101</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">bootingBG</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'img'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'id'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'dinos-booting-background'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'src'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'imgs/bg.gif'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'display'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line102' class='line'> 102</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._bootingWin</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'div'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'id'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'dinos-booting-window'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'display'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line103' class='line'> 103</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addStyle</span><span class="PUNC">(</span><span class="NAME">this._bootingWin</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line104' class='line'> 104</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'top'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'100px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line105' class='line'> 105</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'left'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">joDisplay.displayWidth</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">200</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line106' class='line'> 106</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'max-height'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">joDisplay.displayHeight</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">0.9</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line107' class='line'> 107</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'max-width'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">joDisplay.displayWidth</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">0.9</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line108' class='line'> 108</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line109' class='line'> 109</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._bootingWin.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT">
<span id='line110' class='line'> 110</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;h2>Dinos is now booting...&lt;/h2>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line111' class='line'> 111</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'Status: &lt;div id="dinos-booting-message">&lt;/div>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line112' class='line'> 112</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line113' class='line'> 113</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._bootingMes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'dinos-booting-message'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line114' class='line'> 114</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line115' class='line'> 115</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//起動処理ここから</span><span class="WHIT">
<span id='line116' class='line'> 116</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">Deferred.next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line117' class='line'> 117</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore._bootingMes.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'Loading OS...'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line118' class='line'> 118</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joCore._load</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">wait</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line119' class='line'> 119</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line120' class='line'> 120</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line121' class='line'> 121</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore._bootingMes.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'Loading Disk...'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line122' class='line'> 122</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joFileManager.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">wait</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line123' class='line'> 123</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line124' class='line'> 124</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line125' class='line'> 125</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore._bootingMes.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'Loading Personal Preferences...'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line126' class='line'> 126</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joPrefManager.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line127' class='line'> 127</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line128' class='line'> 128</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line129' class='line'> 129</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joEvent.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line130' class='line'> 130</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line131' class='line'> 131</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line132' class='line'> 132</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore._bootingMes.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'Loading Applications...'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line133' class='line'> 133</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joAppManager.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line134' class='line'> 134</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line135' class='line'> 135</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line136' class='line'> 136</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore._bootingMes.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'Applying System Skin...'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line137' class='line'> 137</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joCore.IO.Network.load</span><span class="PUNC">(</span><span class="STRN">'js'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'Libraries/xcss.js'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line138' class='line'> 138</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line139' class='line'> 139</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line140' class='line'> 140</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">/* 起動時にすることをここに書く */</span><span class="WHIT">
<span id='line141' class='line'> 141</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line142' class='line'> 142</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//起動画面を非表示にする</span><span class="WHIT">
<span id='line143' class='line'> 143</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.remove</span><span class="PUNC">(</span><span class="NAME">joCore._bootingWin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line144' class='line'> 144</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.remove</span><span class="PUNC">(</span><span class="NAME">bootingBG</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line145' class='line'> 145</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line146' class='line'> 146</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//welcomeを表示する</span><span class="WHIT">
<span id='line147' class='line'> 147</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.welcome</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line148' class='line'> 148</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line149' class='line'> 149</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//起動を通知</span><span class="WHIT">
<span id='line150' class='line'> 150</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.fireEvent</span><span class="PUNC">(</span><span class="STRN">'joBooted'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">window.document</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line151' class='line'> 151</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="WHIT">
<span id='line152' class='line'> 152</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">error</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line153' class='line'> 153</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.error</span><span class="PUNC">(</span><span class="STRN">'Booting Error!'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line154' class='line'> 154</span> 
<span id='line155' class='line'> 155</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'&lt;h1>A Booting Error has occurred.&lt;/h1>&lt;p>起動中に深刻なエラーが発生したため、起動できませんでした。&lt;/p> '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> 
<span id='line156' class='line'> 156</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span><span class="STRN">'&lt;h2>詳細情報&lt;/h2>&lt;div style="text-align:left;margin: 0 1em;">'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line157' class='line'> 157</span> 
<span id='line158' class='line'> 158</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">erObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.logger._errorToObject</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//error object</span><span class="WHIT">
<span id='line159' class='line'> 159</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">erObj</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line160' class='line'> 160</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">mes</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'&lt;b>'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'&lt;/b> : '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">joCore.utils.sanitizeHTML</span><span class="PUNC">(</span><span class="NAME">erObj</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'&lt;br />'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line161' class='line'> 161</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line162' class='line'> 162</span> 
<span id='line163' class='line'> 163</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">mes</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'&lt;/div>'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line164' class='line'> 164</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line165' class='line'> 165</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore._bootingWin.innerHTML</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mes</span><span class="PUNC">;</span><span class="WHIT">
<span id='line166' class='line'> 166</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore._bootingWin.style.left</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span id='line167' class='line'> 167</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore._bootingWin.style.top</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'10px'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line168' class='line'> 168</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line169' class='line'> 169</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line170' class='line'> 170</span> 
<span id='line171' class='line'> 171</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line172' class='line'> 172</span> &nbsp;&nbsp;&nbsp;&nbsp; * 終了時に実行され, 各オブジェクトの終了処理を行う
<span id='line173' class='line'> 173</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@private</span>
<span id='line174' class='line'> 174</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line175' class='line'> 175</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">uninit</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line176' class='line'> 176</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joAppManager.uninit</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line177' class='line'> 177</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joPrefManager.uninit</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line178' class='line'> 178</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line179' class='line'> 179</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line180' class='line'> 180</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line181' class='line'> 181</span> &nbsp;&nbsp;&nbsp;&nbsp; * OSを構成するファイルを読み込む&lt;br>
<span id='line182' class='line'> 182</span> &nbsp;&nbsp;&nbsp;&nbsp; * 起動時に一度だけ実行される
<span id='line183' class='line'> 183</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line184' class='line'> 184</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_load</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line185' class='line'> 185</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line186' class='line'> 186</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//Libraries</span><span class="WHIT">
<span id='line187' class='line'> 187</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Deferred.parallel</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="WHIT">
<span id='line188' class='line'> 188</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.IO.Network.load</span><span class="PUNC">(</span><span class="STRN">'js'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'Libraries/json2.js'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line189' class='line'> 189</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;joCore.IO.Network.load('js', 'Libraries/uki.js'),</span><span class="WHIT">
<span id='line190' class='line'> 190</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;joCore.IO.Network.load('js', 'Libraries/uki-more.js'),</span><span class="WHIT">
<span id='line191' class='line'> 191</span> 
<span id='line192' class='line'> 192</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line193' class='line'> 193</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//part of core.js</span><span class="WHIT">
<span id='line194' class='line'> 194</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Deferred.parallel</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="WHIT">
<span id='line195' class='line'> 195</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;joCore.IO.Network.load('js', 'node.js'),</span><span class="WHIT">
<span id='line196' class='line'> 196</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;joCore.IO.Network.load('js', 'display.js'),</span><span class="WHIT">
<span id='line197' class='line'> 197</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line198' class='line'> 198</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line199' class='line'> 199</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//Other files</span><span class="WHIT">
<span id='line200' class='line'> 200</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Deferred.parallel</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="WHIT">
<span id='line201' class='line'> 201</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.IO.Network.load</span><span class="PUNC">(</span><span class="STRN">'js'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'filesystem.js'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line202' class='line'> 202</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.IO.Network.load</span><span class="PUNC">(</span><span class="STRN">'js'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'contextmenu.js'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line203' class='line'> 203</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.IO.Network.load</span><span class="PUNC">(</span><span class="STRN">'js'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'ui.js'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line204' class='line'> 204</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.IO.Network.load</span><span class="PUNC">(</span><span class="STRN">'js'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'window.js'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line205' class='line'> 205</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.IO.Network.load</span><span class="PUNC">(</span><span class="STRN">'js'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'event.js'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line206' class='line'> 206</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.IO.Network.load</span><span class="PUNC">(</span><span class="STRN">'js'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'application.js'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line207' class='line'> 207</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.IO.Network.load</span><span class="PUNC">(</span><span class="STRN">'js'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'prefs.js'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line208' class='line'> 208</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line209' class='line'> 209</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line210' class='line'> 210</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line211' class='line'> 211</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line212' class='line'> 212</span> 
<span id='line213' class='line'> 213</span> 
<span id='line214' class='line'> 214</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line215' class='line'> 215</span> &nbsp;&nbsp;&nbsp;&nbsp; * 起動時に表示するダイアログ
<span id='line216' class='line'> 216</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line217' class='line'> 217</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">welcome</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line218' class='line'> 218</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joUI.dialog</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line219' class='line'> 219</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">application</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'dinos.finder'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line220' class='line'> 220</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Welcome to Dinos'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line221' class='line'> 221</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT">
<span id='line222' class='line'> 222</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;h2 class="headline-with-underline">Welcome to Dinos!&lt;/h2>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line223' class='line'> 223</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;p>Dinos is pure JavaScript OS.&lt;br />You can anything at anywhere only if you have a browser.&lt;/p>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line224' class='line'> 224</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;h2 class="headline-with-underline">What do you do next?&lt;/h2>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line225' class='line'> 225</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;ul class="hasmarker">'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line226' class='line'> 226</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;li>&lt;a href="javascript:joCore.showChangeLog();">See "Change Log"&lt;/a>&lt;/li>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line227' class='line'> 227</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;li>&lt;a href="javascript:joCore.showThanks();">See "Thanks"&lt;/a>&lt;/li>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line228' class='line'> 228</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;/ul>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line229' class='line'> 229</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line230' class='line'> 230</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line231' class='line'> 231</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line232' class='line'> 232</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp; 
<span id='line233' class='line'> 233</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line234' class='line'> 234</span> &nbsp;&nbsp;&nbsp;&nbsp; * OSについての情報を表示する
<span id='line235' class='line'> 235</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line236' class='line'> 236</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aboutOS</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line237' class='line'> 237</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">message</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT">
<span id='line238' class='line'> 238</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'Dinos ver 0.0.1'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line239' class='line'> 239</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'Created by nodaguti'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line240' class='line'> 240</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span id='line241' class='line'> 241</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'Dinos stands for "Dinos Is Not OS."'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line242' class='line'> 242</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'It\'s written in JavaScript.'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line243' class='line'> 243</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span id='line244' class='line'> 244</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;a href="javascript:joCore.showChangeLog();">Change Log&lt;/a>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line245' class='line'> 245</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'&lt;a href="javascript:joCore.showThanks();">Thanks&lt;/a>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line246' class='line'> 246</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">'&lt;br />'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line247' class='line'> 247</span> 
<span id='line248' class='line'> 248</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joUI.dialog</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line249' class='line'> 249</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">message</span><span class="PUNC">,</span><span class="WHIT">
<span id='line250' class='line'> 250</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">application</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'dinos.finder'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line251' class='line'> 251</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'About This OS'</span><span class="WHIT">
<span id='line252' class='line'> 252</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line253' class='line'> 253</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line254' class='line'> 254</span> 
<span id='line255' class='line'> 255</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line256' class='line'> 256</span> &nbsp;&nbsp;&nbsp;&nbsp; * ChangeLog.txt を表示する
<span id='line257' class='line'> 257</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line258' class='line'> 258</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">showChangeLog</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line259' class='line'> 259</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.IO.Network.read</span><span class="PUNC">(</span><span class="STRN">'ChangeLog.txt'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'text/plain'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">req</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line260' class='line'> 260</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joUI.dialog</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line261' class='line'> 261</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">500</span><span class="PUNC">,</span><span class="WHIT">
<span id='line262' class='line'> 262</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">300</span><span class="PUNC">,</span><span class="WHIT">
<span id='line263' class='line'> 263</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">joCore.utils.sanitizeHTML</span><span class="PUNC">(</span><span class="NAME">req.responseText</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line264' class='line'> 264</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">application</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'dinos.finder'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line265' class='line'> 265</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Change Log'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line266' class='line'> 266</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">resizable</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT">
<span id='line267' class='line'> 267</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line268' class='line'> 268</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line269' class='line'> 269</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line270' class='line'> 270</span> 
<span id='line271' class='line'> 271</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line272' class='line'> 272</span> &nbsp;&nbsp;&nbsp;&nbsp; * Thanks.txt を表示する
<span id='line273' class='line'> 273</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line274' class='line'> 274</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">showThanks</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line275' class='line'> 275</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.IO.Network.read</span><span class="PUNC">(</span><span class="STRN">'Thanks.txt'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'text/plain'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">req</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line276' class='line'> 276</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joUI.dialog</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line277' class='line'> 277</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">500</span><span class="PUNC">,</span><span class="WHIT">
<span id='line278' class='line'> 278</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">300</span><span class="PUNC">,</span><span class="WHIT">
<span id='line279' class='line'> 279</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">joCore.utils.sanitizeHTML</span><span class="PUNC">(</span><span class="NAME">req.responseText</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line280' class='line'> 280</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">application</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'dinos.finder'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line281' class='line'> 281</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Thanks'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line282' class='line'> 282</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">resizable</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT">
<span id='line283' class='line'> 283</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line284' class='line'> 284</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line285' class='line'> 285</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line286' class='line'> 286</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line287' class='line'> 287</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line288' class='line'> 288</span> &nbsp;&nbsp;&nbsp;&nbsp; * コンピューターを保存する
<span id='line289' class='line'> 289</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line290' class='line'> 290</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">savePC</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line291' class='line'> 291</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joPrefManager.uninit</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line292' class='line'> 292</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joFileManager.uninit</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line293' class='line'> 293</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line294' class='line'> 294</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line295' class='line'> 295</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line296' class='line'> 296</span> 
<span id='line297' class='line'> 297</span> 
<span id='line298' class='line'> 298</span> 
<span id='line299' class='line'> 299</span> </span><span class="doccmt">/**
<span id='line300' class='line'> 300</span>  * Useful methods for Build-in Objects
<span id='line301' class='line'> 301</span>  * <span class="doctag">@class</span>
<span id='line302' class='line'> 302</span>  */</span><span class="WHIT">
<span id='line303' class='line'> 303</span> </span><span class="NAME">joCore.utils</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line304' class='line'> 304</span> 
<span id='line305' class='line'> 305</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line306' class='line'> 306</span> &nbsp;&nbsp;&nbsp;&nbsp; * sanitize HTML tags and escape some special characters &lt;br>
<span id='line307' class='line'> 307</span> &nbsp;&nbsp;&nbsp;&nbsp; * innerHTMLでテキストをそのまま流し込むときにどうぞ
<span id='line308' class='line'> 308</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} text
<span id='line309' class='line'> 309</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Boolean} [strict=false] 厳格モードにするかどうか &lt;br>trueにするとタグを無効化(実体参照変換)する
<span id='line310' class='line'> 310</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Number} [tablen=3] タブ幅
<span id='line311' class='line'> 311</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {String}
<span id='line312' class='line'> 312</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line313' class='line'> 313</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">sanitizeHTML</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">strict</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tablen</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line314' class='line'> 314</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">text.replace</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span id='line315' class='line'> 315</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line316' class='line'> 316</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tab</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tablen</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tablen</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">tablen</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">;</span><span class="WHIT">
<span id='line317' class='line'> 317</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">tablen</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">tab</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'&nbsp;'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line318' class='line'> 318</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line319' class='line'> 319</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">text.replace</span><span class="PUNC">(</span><span class="REGX">/&/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'&amp;'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line320' class='line'> 320</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/ /g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'&nbsp;'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line321' class='line'> 321</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\t/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tab</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line322' class='line'> 322</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   
<span id='line323' class='line'> 323</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">strict</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line324' class='line'> 324</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">text.replace</span><span class="PUNC">(</span><span class="REGX">/&lt;/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'&lt;'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line325' class='line'> 325</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;           </span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/>/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'&gt;'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line326' class='line'> 326</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line327' class='line'> 327</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line328' class='line'> 328</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">text</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">text.replace</span><span class="PUNC">(</span><span class="REGX">/\n/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'&lt;br />'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line329' class='line'> 329</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line330' class='line'> 330</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">text</span><span class="PUNC">;</span><span class="WHIT">
<span id='line331' class='line'> 331</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line332' class='line'> 332</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line333' class='line'> 333</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line334' class='line'> 334</span> &nbsp;&nbsp;&nbsp;&nbsp; * convert Array-like Object into Array
<span id='line335' class='line'> 335</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} fake
<span id='line336' class='line'> 336</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Array}
<span id='line337' class='line'> 337</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line338' class='line'> 338</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">toArray</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">fake</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line339' class='line'> 339</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line340' class='line'> 340</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line341' class='line'> 341</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line342' class='line'> 342</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rv</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ri</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">iz</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fake.length</span><span class="PUNC">;</span><span class="WHIT">
<span id='line343' class='line'> 343</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">iz</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">++</span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line344' class='line'> 344</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">rv</span><span class="PUNC">[</span><span class="PUNC">++</span><span class="NAME">ri</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fake</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line345' class='line'> 345</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line346' class='line'> 346</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">rv</span><span class="PUNC">;</span><span class="WHIT">
<span id='line347' class='line'> 347</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line348' class='line'> 348</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line349' class='line'> 349</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line350' class='line'> 350</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line351' class='line'> 351</span> &nbsp;&nbsp;&nbsp;&nbsp; * generate UUID(version 4)
<span id='line352' class='line'> 352</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {String}
<span id='line353' class='line'> 353</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line354' class='line'> 354</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getUniqueID</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line355' class='line'> 355</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">UUID.genV4</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line356' class='line'> 356</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line357' class='line'> 357</span> 
<span id='line358' class='line'> 358</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line359' class='line'> 359</span> &nbsp;&nbsp;&nbsp;&nbsp; * byteで表された大きさを解析する
<span id='line360' class='line'> 360</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Number} byte
<span id='line361' class='line'> 361</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line362' class='line'> 362</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">analyzeByteSize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">byte</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line363' class='line'> 363</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT">  </span><span class="COMM">//余り</span><span class="WHIT">
<span id='line364' class='line'> 364</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">level</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span id='line365' class='line'> 365</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">prefix</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">'b'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'kb'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'mb'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'gb'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'tb'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'pb'</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span id='line366' class='line'> 366</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_byte</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">byte</span><span class="PUNC">;</span><span class="WHIT">
<span id='line367' class='line'> 367</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line368' class='line'> 368</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">do</span><span class="PUNC">{</span><span class="WHIT">
<span id='line369' class='line'> 369</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">byte</span><span class="WHIT"> </span><span class="PUNC">%</span><span class="WHIT"> </span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">1024</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">level</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line370' class='line'> 370</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">level</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span id='line371' class='line'> 371</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">byte</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line372' class='line'> 372</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line373' class='line'> 373</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line374' class='line'> 374</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">level</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">>=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line375' class='line'> 375</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">byte</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">1024</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line376' class='line'> 376</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">result</span><span class="PUNC">[</span><span class="NAME">prefix</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">;</span><span class="WHIT">
<span id='line377' class='line'> 377</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">byte</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">1024</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line378' class='line'> 378</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line379' class='line'> 379</span> 
<span id='line380' class='line'> 380</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//summary</span><span class="WHIT">
<span id='line381' class='line'> 381</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sizeStr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span id='line382' class='line'> 382</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">unit</span><span class="PUNC">,</span><span class="WHIT">
<span id='line383' class='line'> 383</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">counter</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span id='line384' class='line'> 384</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line385' class='line'> 385</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line386' class='line'> 386</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">counter</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">sizeStr</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">unit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">i.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line387' class='line'> 387</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">counter</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">sizeStr</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'.'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">result</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">1024</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line388' class='line'> 388</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">counter</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span id='line389' class='line'> 389</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line390' class='line'> 390</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">result.summary</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sizeStr</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">unit</span><span class="PUNC">;</span><span class="WHIT">
<span id='line391' class='line'> 391</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line392' class='line'> 392</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//元の大きさ</span><span class="WHIT">
<span id='line393' class='line'> 393</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">result.byte</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">_byte</span><span class="PUNC">;</span><span class="WHIT">
<span id='line394' class='line'> 394</span> 
<span id='line395' class='line'> 395</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span id='line396' class='line'> 396</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line397' class='line'> 397</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line398' class='line'> 398</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line399' class='line'> 399</span> &nbsp;&nbsp;&nbsp;&nbsp; * 0を補完して桁を揃える
<span id='line400' class='line'> 400</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Number} num
<span id='line401' class='line'> 401</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Number} length 桁数
<span id='line402' class='line'> 402</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line403' class='line'> 403</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">fixDegit</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">num</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line404' class='line'> 404</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">naturalLength</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">num</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">;</span><span class="WHIT">
<span id='line405' class='line'> 405</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line406' class='line'> 406</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">naturalLength</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line407' class='line'> 407</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">num</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'0'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">num</span><span class="PUNC">;</span><span class="WHIT">
<span id='line408' class='line'> 408</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line409' class='line'> 409</span> 
<span id='line410' class='line'> 410</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">num</span><span class="PUNC">;</span><span class="WHIT">
<span id='line411' class='line'> 411</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line412' class='line'> 412</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line413' class='line'> 413</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line414' class='line'> 414</span> &nbsp;&nbsp;&nbsp;&nbsp; * オブジェクトの継承をする
<span id='line415' class='line'> 415</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} child 子オブジェクト
<span id='line416' class='line'> 416</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} super_ 親オブジェクト
<span id='line417' class='line'> 417</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line418' class='line'> 418</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">inherit</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">child</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">super_</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line419' class='line'> 419</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Object.getPrototypeOf)</span><span class="WHIT">
<span id='line420' class='line'> 420</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Object.getPrototypeOf(child) = super_;</span><span class="WHIT">
<span id='line421' class='line'> 421</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span><span class="WHIT">
<span id='line422' class='line'> 422</span> 
<span id='line423' class='line'> 423</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(child.prototype.__proto__)</span><span class="WHIT">
<span id='line424' class='line'> 424</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;child.prototype.__proto__ = super_.prototype;</span><span class="WHIT">
<span id='line425' class='line'> 425</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else</span><span class="WHIT">
<span id='line426' class='line'> 426</span> </span><span class="COMM">/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var i in super_.prototype){
<span id='line427' class='line'> 427</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!child.prototype[i])
<span id='line428' class='line'> 428</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(typeof super_.prototype[i] === 'object')
<span id='line429' class='line'> 429</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;child.prototype[i] = Object.create(super_.prototype[i]);
<span id='line430' class='line'> 430</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else if(typeof super_.prototype[i] === 'function')
<span id='line431' class='line'> 431</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval('var dammy = ' + super_.prototype[i].toString());
<span id='line432' class='line'> 432</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;child.prototype[i] = dammy;
<span id='line433' class='line'> 433</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else
<span id='line434' class='line'> 434</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;child.prototype[i] = super_.prototype[i];
<span id='line435' class='line'> 435</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}*/</span><span class="WHIT">
<span id='line436' class='line'> 436</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dummy</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line437' class='line'> 437</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">dummy.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">super_.prototype</span><span class="PUNC">;</span><span class="WHIT">
<span id='line438' class='line'> 438</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dummyIns</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">dummy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line439' class='line'> 439</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line440' class='line'> 440</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">dummyIns</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line441' class='line'> 441</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">child.prototype</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT">
<span id='line442' class='line'> 442</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">child.prototype</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dummyIns</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line443' class='line'> 443</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line444' class='line'> 444</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line445' class='line'> 445</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line446' class='line'> 446</span> &nbsp;&nbsp;&nbsp;&nbsp;
<span id='line447' class='line'> 447</span> 
<span id='line448' class='line'> 448</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line449' class='line'> 449</span> 
<span id='line450' class='line'> 450</span> 
<span id='line451' class='line'> 451</span> 
<span id='line452' class='line'> 452</span> </span><span class="doccmt">/**
<span id='line453' class='line'> 453</span>  * Useful methods for Element
<span id='line454' class='line'> 454</span>  * <span class="doctag">@class</span>
<span id='line455' class='line'> 455</span>  */</span><span class="WHIT">
<span id='line456' class='line'> 456</span> </span><span class="NAME">joCore.Node</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line457' class='line'> 457</span> 
<span id='line458' class='line'> 458</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line459' class='line'> 459</span> &nbsp;&nbsp;&nbsp;&nbsp; * 要素を作成する
<span id='line460' class='line'> 460</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line461' class='line'> 461</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aTagName 作成する要素の名前
<span id='line462' class='line'> 462</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} [attributes] 要素に追加する属性 &lt;br>{ attributeName: attributeValue, ... }
<span id='line463' class='line'> 463</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} [aOwner] 要素の親
<span id='line464' class='line'> 464</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} [aNameSpace] 要素の名前空間 &lt;br>省略時は document.craeteElement と等価
<span id='line465' class='line'> 465</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line466' class='line'> 466</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">createNode</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aTagName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aOwner</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aNameSpace</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line467' class='line'> 467</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">aNameSpace</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="NAME">aTagName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT">
<span id='line468' class='line'> 468</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                       </span><span class="NAME">document.createElementNS</span><span class="PUNC">(</span><span class="NAME">aNameSpace</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aTagName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line469' class='line'> 469</span> 
<span id='line470' class='line'> 470</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">attributes</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.setAttributes</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line471' class='line'> 471</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">aOwner</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">aOwner.appendChild</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line472' class='line'> 472</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line473' class='line'> 473</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.getUniqueID</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line474' class='line'> 474</span> 
<span id='line475' class='line'> 475</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">;</span><span class="WHIT">
<span id='line476' class='line'> 476</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line477' class='line'> 477</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line478' class='line'> 478</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line479' class='line'> 479</span> &nbsp;&nbsp;&nbsp;&nbsp; * 各要素に固有のID(UUID)を返す
<span id='line480' class='line'> 480</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement
<span id='line481' class='line'> 481</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {String} id
<span id='line482' class='line'> 482</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line483' class='line'> 483</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getUniqueID</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line484' class='line'> 484</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">aElement.hasAttribute</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'undefined'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span id='line485' class='line'> 485</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">aElement.hasAttribute</span><span class="PUNC">(</span><span class="STRN">'uid'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line486' class='line'> 486</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">aElement.getAttribute</span><span class="PUNC">(</span><span class="STRN">'uid'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line487' class='line'> 487</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line488' class='line'> 488</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">id</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.utils.getUniqueID</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line489' class='line'> 489</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.setAttribute</span><span class="PUNC">(</span><span class="STRN">'uid'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line490' class='line'> 490</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">id</span><span class="PUNC">;</span><span class="WHIT">
<span id='line491' class='line'> 491</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line492' class='line'> 492</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line493' class='line'> 493</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line494' class='line'> 494</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line495' class='line'> 495</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定した座標にあるノードをすべて取得する
<span id='line496' class='line'> 496</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line497' class='line'> 497</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Number} x x座標
<span id='line498' class='line'> 498</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Number} y y座標
<span id='line499' class='line'> 499</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {ElementArray} 一番上 -> 一番下の順でソート済み
<span id='line500' class='line'> 500</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line501' class='line'> 501</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getNodesByPosition</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line502' class='line'> 502</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">result</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//該当する要素の配列</span><span class="WHIT">
<span id='line503' class='line'> 503</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">element</span><span class="PUNC">;</span><span class="WHIT">
<span id='line504' class='line'> 504</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line505' class='line'> 505</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">do</span><span class="PUNC">{</span><span class="WHIT">
<span id='line506' class='line'> 506</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">element</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.elementFromPoint</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line507' class='line'> 507</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">result.push</span><span class="PUNC">(</span><span class="NAME">element</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line508' class='line'> 508</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addStyle</span><span class="PUNC">(</span><span class="NAME">element</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">display</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'none'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line509' class='line'> 509</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">element.tagName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="STRN">'html'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line510' class='line'> 510</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line511' class='line'> 511</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">result.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">el</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">joCore.Node.removeStyle</span><span class="PUNC">(</span><span class="NAME">el</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'display'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'none'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line512' class='line'> 512</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line513' class='line'> 513</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">result</span><span class="PUNC">;</span><span class="WHIT">
<span id='line514' class='line'> 514</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line515' class='line'> 515</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line516' class='line'> 516</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line517' class='line'> 517</span> &nbsp;&nbsp;&nbsp;&nbsp; * 要素を移動する
<span id='line518' class='line'> 518</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line519' class='line'> 519</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line520' class='line'> 520</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} moveTo 移動先の親要素
<span id='line521' class='line'> 521</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line522' class='line'> 522</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">moveNode</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">moveTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line523' class='line'> 523</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line524' class='line'> 524</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">moveTo.appendChild</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line525' class='line'> 525</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line526' class='line'> 526</span> 
<span id='line527' class='line'> 527</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line528' class='line'> 528</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定した要素を削除する
<span id='line529' class='line'> 529</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line530' class='line'> 530</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node}
<span id='line531' class='line'> 531</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line532' class='line'> 532</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">remove</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line533' class='line'> 533</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line534' class='line'> 534</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line535' class='line'> 535</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line536' class='line'> 536</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line537' class='line'> 537</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定したCSS Selectorに合致する要素を削除する
<span id='line538' class='line'> 538</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line539' class='line'> 539</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aSelector CSS Selector
<span id='line540' class='line'> 540</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line541' class='line'> 541</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deleteNodes</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aSelector</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line542' class='line'> 542</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">elements</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uuQuery</span><span class="PUNC">(</span><span class="NAME">aSelector</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line543' class='line'> 543</span> 
<span id='line544' class='line'> 544</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">elements.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line545' class='line'> 545</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">elements</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">elements</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line546' class='line'> 546</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line547' class='line'> 547</span> 
<span id='line548' class='line'> 548</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">elements</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span id='line549' class='line'> 549</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line550' class='line'> 550</span> 
<span id='line551' class='line'> 551</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line552' class='line'> 552</span> &nbsp;&nbsp;&nbsp;&nbsp; * 要素に属性を追加する
<span id='line553' class='line'> 553</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line554' class='line'> 554</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line555' class='line'> 555</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} attributes 追加する属性 &lt;br>{ attributeName: attributeValue, ... } &lt;br>
<span id='line556' class='line'> 556</span> &nbsp;&nbsp;&nbsp;&nbsp; *                            属性名を :context にすると、要素にテキストノードを追加する
<span id='line557' class='line'> 557</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line558' class='line'> 558</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">setAttributes</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line559' class='line'> 559</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line560' class='line'> 560</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">':context'</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line561' class='line'> 561</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//テキストノードの場合</span><span class="WHIT">
<span id='line562' class='line'> 562</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.appendChild</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">document.createTextNode</span><span class="PUNC">(</span><span class="NAME">attributes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line563' class='line'> 563</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line564' class='line'> 564</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">':child'</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line565' class='line'> 565</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//innerHTML</span><span class="WHIT">
<span id='line566' class='line'> 566</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.textToDOM</span><span class="PUNC">(</span><span class="NAME">attributes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'text/html'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line567' class='line'> 567</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">dom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">aElement.appendChild</span><span class="PUNC">(</span><span class="NAME">dom</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line568' class='line'> 568</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">aElement.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line569' class='line'> 569</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line570' class='line'> 570</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line571' class='line'> 571</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.setAttribute</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attributes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line572' class='line'> 572</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line573' class='line'> 573</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line574' class='line'> 574</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line575' class='line'> 575</span> 
<span id='line576' class='line'> 576</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line577' class='line'> 577</span> &nbsp;&nbsp;&nbsp;&nbsp; * 要素にスタイルを追加する&lt;br>
<span id='line578' class='line'> 578</span> &nbsp;&nbsp;&nbsp;&nbsp; * style属性に追加されるので優先順位に注意すること
<span id='line579' class='line'> 579</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line580' class='line'> 580</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line581' class='line'> 581</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} aSelectors 追加するスタイル &lt;br>{ Property: Value, ... }
<span id='line582' class='line'> 582</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line583' class='line'> 583</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">addStyle</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aSelectors</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line584' class='line'> 584</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">selectorStr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">,</span><span class="WHIT">
<span id='line585' class='line'> 585</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;    </span><span class="NAME">properties</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line586' class='line'> 586</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line587' class='line'> 587</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//CSS文字列を作成</span><span class="WHIT">
<span id='line588' class='line'> 588</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">aSelectors</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line589' class='line'> 589</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">selectorStr</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">':'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">aSelectors</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">';'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line590' class='line'> 590</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">properties.push</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line591' class='line'> 591</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line592' class='line'> 592</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line593' class='line'> 593</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//掃除</span><span class="WHIT">
<span id='line594' class='line'> 594</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.removeStyle</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">properties</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line595' class='line'> 595</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line596' class='line'> 596</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aElement.getAttribute</span><span class="PUNC">(</span><span class="STRN">'style'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line597' class='line'> 597</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line598' class='line'> 598</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//行末にセミコロンがない場合は補う</span><span class="WHIT">
<span id='line599' class='line'> 599</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="REGX">/;\s*$/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">';'</span><span class="PUNC">;</span><span class="WHIT">
<span id='line600' class='line'> 600</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line601' class='line'> 601</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//スタイルを追加して、適用する</span><span class="WHIT">
<span id='line602' class='line'> 602</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">selectorStr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">selectorStr</span><span class="PUNC">;</span><span class="WHIT">
<span id='line603' class='line'> 603</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.setAttribute</span><span class="PUNC">(</span><span class="STRN">'style'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">selectorStr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line604' class='line'> 604</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line605' class='line'> 605</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line606' class='line'> 606</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line607' class='line'> 607</span> &nbsp;&nbsp;&nbsp;&nbsp; * 要素のスタイルを削除する
<span id='line608' class='line'> 608</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line609' class='line'> 609</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object|Array} aSelectors 削除するスタイル
<span id='line610' class='line'> 610</span> &nbsp;&nbsp;&nbsp;&nbsp; *                        Object { Property: Value, ...} の場合： 指定された値を持つプロパティを削除
<span id='line611' class='line'> 611</span> &nbsp;&nbsp;&nbsp;&nbsp; *                        Array の場合： 指定されたプロパティをすべて削除
<span id='line612' class='line'> 612</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line613' class='line'> 613</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">removeStyle</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aSelectors</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line614' class='line'> 614</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aElement.getAttribute</span><span class="PUNC">(</span><span class="STRN">'style'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line615' class='line'> 615</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">style</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span id='line616' class='line'> 616</span> 
<span id='line617' class='line'> 617</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">aSelectors.concat</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">  </span><span class="COMM">//Array</span><span class="WHIT">
<span id='line618' class='line'> 618</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">aSelectors.length</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line619' class='line'> 619</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="NAME">aSelectors</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'[^;]*?;\\s*'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'g'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line620' class='line'> 620</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">style.replace</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line621' class='line'> 621</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line622' class='line'> 622</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line623' class='line'> 623</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">aSelectors</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line624' class='line'> 624</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\\s*:\\s*'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">aSelectors</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\\s*;\\s*'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'g'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line625' class='line'> 625</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">style.replace</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line626' class='line'> 626</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line627' class='line'> 627</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line628' class='line'> 628</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line629' class='line'> 629</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.setAttribute</span><span class="PUNC">(</span><span class="STRN">'style'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line630' class='line'> 630</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line631' class='line'> 631</span> 
<span id='line632' class='line'> 632</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line633' class='line'> 633</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定したクラス名を追加する
<span id='line634' class='line'> 634</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line635' class='line'> 635</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line636' class='line'> 636</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String|Array} aClassNames 追加するクラス名&lt;br>
<span id='line637' class='line'> 637</span> &nbsp;&nbsp;&nbsp;&nbsp; *                                   複数一括追加をする場合は配列か半角スペース区切りの文字列を渡す&lt;br>
<span id='line638' class='line'> 638</span> &nbsp;&nbsp;&nbsp;&nbsp; *                                   すでにクラス名が存在していた場合は何も行わない
<span id='line639' class='line'> 639</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line640' class='line'> 640</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">addClass</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aClassNames</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line641' class='line'> 641</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">classes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">aClassNames</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">aClassNames</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aClassNames.split</span><span class="PUNC">(</span><span class="STRN">' '</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line642' class='line'> 642</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line643' class='line'> 643</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">classes.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line644' class='line'> 644</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.hasClass</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">classes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span id='line645' class='line'> 645</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line646' class='line'> 646</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.className</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">' '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">classes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line647' class='line'> 647</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line648' class='line'> 648</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line649' class='line'> 649</span> 
<span id='line650' class='line'> 650</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line651' class='line'> 651</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定したクラス名を削除する
<span id='line652' class='line'> 652</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line653' class='line'> 653</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line654' class='line'> 654</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String|Array} aClassNames 削除するクラス名&lt;br>
<span id='line655' class='line'> 655</span> &nbsp;&nbsp;&nbsp;&nbsp; *                                   複数一括削除をする場合は配列か半角スペース区切りの文字列を渡す
<span id='line656' class='line'> 656</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line657' class='line'> 657</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">removeClass</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aClassNames</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line658' class='line'> 658</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">classes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">aClassNames</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">aClassNames</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aClassNames.split</span><span class="PUNC">(</span><span class="STRN">' '</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line659' class='line'> 659</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line660' class='line'> 660</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">classes.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line661' class='line'> 661</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.hasClass</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">classes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span id='line662' class='line'> 662</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line663' class='line'> 663</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.className</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aElement.className.replace</span><span class="PUNC">(</span><span class="NAME">classes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line664' class='line'> 664</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line665' class='line'> 665</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line666' class='line'> 666</span> 
<span id='line667' class='line'> 667</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line668' class='line'> 668</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定したクラス名を持っているかどうか調べる
<span id='line669' class='line'> 669</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line670' class='line'> 670</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 対象の要素
<span id='line671' class='line'> 671</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aClassName クラス名
<span id='line672' class='line'> 672</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Boolean}
<span id='line673' class='line'> 673</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line674' class='line'> 674</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">hasClass</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aClassName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line675' class='line'> 675</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aElement.getAttribute</span><span class="PUNC">(</span><span class="STRN">'class'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line676' class='line'> 676</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">c.indexOf</span><span class="PUNC">(</span><span class="NAME">aClassName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span id='line677' class='line'> 677</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line678' class='line'> 678</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line679' class='line'> 679</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line680' class='line'> 680</span> &nbsp;&nbsp;&nbsp;&nbsp; * Toggle Class
<span id='line681' class='line'> 681</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement
<span id='line682' class='line'> 682</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {aClassName} aClassName
<span id='line683' class='line'> 683</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line684' class='line'> 684</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">toggleClass</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aClassName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line685' class='line'> 685</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.hasClass</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aClassName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span id='line686' class='line'> 686</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.removeClass</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aClassName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line687' class='line'> 687</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">else</span><span class="WHIT">
<span id='line688' class='line'> 688</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.addClass</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aClassName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line689' class='line'> 689</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line690' class='line'> 690</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line691' class='line'> 691</span> 
<span id='line692' class='line'> 692</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line693' class='line'> 693</span> &nbsp;&nbsp;&nbsp;&nbsp; * String -> DOM
<span id='line694' class='line'> 694</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line695' class='line'> 695</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aString DOMへ変換する文字列
<span id='line696' class='line'> 696</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} [aMimeType="text/xml"] MimeType
<span id='line697' class='line'> 697</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Node}
<span id='line698' class='line'> 698</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line699' class='line'> 699</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">textToDOM</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aMimeType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line700' class='line'> 700</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">aMimeType</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">joCore.logger.warning</span><span class="PUNC">(</span><span class="STRN">'[textToDOM] aMimeType is not set. "text/xml" is used instead.'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line701' class='line'> 701</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line702' class='line'> 702</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line703' class='line'> 703</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parser</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">DOMParser</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line704' class='line'> 704</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">parser.parseFromString</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aMimeType</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">'text/xml'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line705' class='line'> 705</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line706' class='line'> 706</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//エラー処理</span><span class="WHIT">
<span id='line707' class='line'> 707</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">dom</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'Cannot convert by DOM Parser'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line708' class='line'> 708</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">dom.documentDocument.tagName</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'parseError'</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">
<span id='line709' class='line'> 709</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   </span><span class="NAME">dom.documentDocument.namespaceURI</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'http://www.mozilla.org/newlayout/xml/parsererror.xml'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line710' class='line'> 710</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'DOM Parser: parse error'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line711' class='line'> 711</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line712' class='line'> 712</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">dom</span><span class="PUNC">;</span><span class="WHIT">
<span id='line713' class='line'> 713</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line714' class='line'> 714</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line715' class='line'> 715</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">range</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createRange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line716' class='line'> 716</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">range.selectNodeContents</span><span class="PUNC">(</span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//Hack for Safari, Opera</span><span class="WHIT">
<span id='line717' class='line'> 717</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">range.createContextualFragment</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line718' class='line'> 718</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line719' class='line'> 719</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//IE?</span><span class="WHIT">
<span id='line720' class='line'> 720</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line721' class='line'> 721</span> </span><span class="COMM">/*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(aMimeType === 'text/html'){
<span id='line722' class='line'> 722</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var div = document.createElement('div');
<span id='line723' class='line'> 723</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var fragment = document.createDocumentFragment();
<span id='line724' class='line'> 724</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div.innerHTML = aString;
<span id='line725' class='line'> 725</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line726' class='line'> 726</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(var i=0, l=div.childNodes; i&lt;l; i++){
<span id='line727' class='line'> 727</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fragment.appendChild(div.childNodes[i]);
<span id='line728' class='line'> 728</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
<span id='line729' class='line'> 729</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line730' class='line'> 730</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return fragment;
<span id='line731' class='line'> 731</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line732' class='line'> 732</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{
<span id='line733' class='line'> 733</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var xmlDOM = new ActiveXObject('Microsoft.XMLDOM');
<span id='line734' class='line'> 734</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlDOM.async = 'false';
<span id='line735' class='line'> 735</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xmlDOM.loadXML(aString);
<span id='line736' class='line'> 736</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return xmlDOM;
<span id='line737' class='line'> 737</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}*/</span><span class="WHIT">
<span id='line738' class='line'> 738</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line739' class='line'> 739</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var req = new xmlHttpRequest();</span><span class="WHIT">
<span id='line740' class='line'> 740</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;req.</span><span class="WHIT">
<span id='line741' class='line'> 741</span> 
<span id='line742' class='line'> 742</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'IE has no way to convert text to HTML :('</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line743' class='line'> 743</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line744' class='line'> 744</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">exx</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line745' class='line'> 745</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.error</span><span class="PUNC">(</span><span class="STRN">'[textToDOM]'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line746' class='line'> 746</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.error</span><span class="PUNC">(</span><span class="STRN">'[textToDOM]'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ex</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line747' class='line'> 747</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.error</span><span class="PUNC">(</span><span class="STRN">'[textToDOM]'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">exx</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line748' class='line'> 748</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line749' class='line'> 749</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span id='line750' class='line'> 750</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line751' class='line'> 751</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line752' class='line'> 752</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line753' class='line'> 753</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line754' class='line'> 754</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span id='line755' class='line'> 755</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line756' class='line'> 756</span> 
<span id='line757' class='line'> 757</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line758' class='line'> 758</span> &nbsp;&nbsp;&nbsp;&nbsp; * DOM -> String
<span id='line759' class='line'> 759</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line760' class='line'> 760</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aDOM
<span id='line761' class='line'> 761</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {String}
<span id='line762' class='line'> 762</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line763' class='line'> 763</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">DOMToText</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aDOM</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line764' class='line'> 764</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line765' class='line'> 765</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">serializer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLSerializer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line766' class='line'> 766</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">serializer.serializeToString</span><span class="PUNC">(</span><span class="NAME">aDOM</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//Firefox, Safari, Opera, Chrome, IE9</span><span class="WHIT">
<span id='line767' class='line'> 767</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line768' class='line'> 768</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//IE?</span><span class="WHIT">
<span id='line769' class='line'> 769</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">aDOM.outerHTML</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">aDOM.outerHTML</span><span class="PUNC">;</span><span class="WHIT">
<span id='line770' class='line'> 770</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">aDOM.xml</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">aDOM.xml</span><span class="PUNC">;</span><span class="WHIT">
<span id='line771' class='line'> 771</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line772' class='line'> 772</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//Error</span><span class="WHIT">
<span id='line773' class='line'> 773</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.error</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'Cannot convert DOM into Text'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line774' class='line'> 774</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span id='line775' class='line'> 775</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line776' class='line'> 776</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line777' class='line'> 777</span> 
<span id='line778' class='line'> 778</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line779' class='line'> 779</span> &nbsp;&nbsp;&nbsp;&nbsp; * ノードの位置情報を得る
<span id='line780' class='line'> 780</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line781' class='line'> 781</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement 情報を取得する要素
<span id='line782' class='line'> 782</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} [aParent] 位置の基準となる要素&lt;br>
<span id='line783' class='line'> 783</span>      *                         省略時は Element.getBoundingClientRect() と同義になる
<span id='line784' class='line'> 784</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Object} ノードの位置情報を持つオブジェクト
<span id='line785' class='line'> 785</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} .left 左端からの距離 [px]
<span id='line786' class='line'> 786</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} .right 右端からの距離 [px]
<span id='line787' class='line'> 787</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} .top 上端からの距離 [px]
<span id='line788' class='line'> 788</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} .bottom 下端からの距離 [px]
<span id='line789' class='line'> 789</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} .width 横幅 [px]
<span id='line790' class='line'> 790</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} .height 高さ [px]
<span id='line791' class='line'> 791</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line792' class='line'> 792</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getNodeRect</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aParent</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line793' class='line'> 793</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">elementRect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aElement.getBoundingClientRect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line794' class='line'> 794</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line795' class='line'> 795</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">aParent</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line796' class='line'> 796</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parentRect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">aParent.getBoundingClientRect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line797' class='line'> 797</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line798' class='line'> 798</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line799' class='line'> 799</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">left</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.left</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">parentRect.left</span><span class="PUNC">,</span><span class="WHIT">
<span id='line800' class='line'> 800</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">right</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.right</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">parentRect.right</span><span class="PUNC">,</span><span class="WHIT">
<span id='line801' class='line'> 801</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">top</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.top</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">parentRect.top</span><span class="PUNC">,</span><span class="WHIT">
<span id='line802' class='line'> 802</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">bottom</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.bottom</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">parentRect.bottom</span><span class="PUNC">,</span><span class="WHIT">
<span id='line803' class='line'> 803</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.right</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">elementRect.left</span><span class="PUNC">,</span><span class="WHIT">
<span id='line804' class='line'> 804</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.bottom</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">elementRect.top</span><span class="WHIT">
<span id='line805' class='line'> 805</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line806' class='line'> 806</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line807' class='line'> 807</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line808' class='line'> 808</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">left</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.left</span><span class="PUNC">,</span><span class="WHIT">
<span id='line809' class='line'> 809</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">right</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.right</span><span class="PUNC">,</span><span class="WHIT">
<span id='line810' class='line'> 810</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">top</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.top</span><span class="PUNC">,</span><span class="WHIT">
<span id='line811' class='line'> 811</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">bottom</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.bottom</span><span class="PUNC">,</span><span class="WHIT">
<span id='line812' class='line'> 812</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.right</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">elementRect.left</span><span class="PUNC">,</span><span class="WHIT">
<span id='line813' class='line'> 813</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">elementRect.bottom</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">elementRect.top</span><span class="WHIT">
<span id='line814' class='line'> 814</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line815' class='line'> 815</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line816' class='line'> 816</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line817' class='line'> 817</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line818' class='line'> 818</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line819' class='line'> 819</span> &nbsp;&nbsp;&nbsp;&nbsp; * フォーム関連要素の値を得る
<span id='line820' class='line'> 820</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement input, textarea, select, or radiogroup(element[class=radiogroup] which has a group of input[type=radio])
<span id='line821' class='line'> 821</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Boolean} [getValue=false] whether returns aElement.value or not(returns aElement.checked(radio) or aElement.firstChild(select))
<span id='line822' class='line'> 822</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {String|Array} select[multiple=true] might return Array.
<span id='line823' class='line'> 823</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line824' class='line'> 824</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getFormValue</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">getValue</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line825' class='line'> 825</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">aElement.tagName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line826' class='line'> 826</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'input'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line827' class='line'> 827</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">aElement.type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line828' class='line'> 828</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'checkbox'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line829' class='line'> 829</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'radio'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line830' class='line'> 830</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">getValue</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">aElement.checked</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">aElement.value</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aElement.checked</span><span class="PUNC">;</span><span class="WHIT">
<span id='line831' class='line'> 831</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line832' class='line'> 832</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span id='line833' class='line'> 833</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">aElement.value</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line834' class='line'> 834</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line835' class='line'> 835</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line836' class='line'> 836</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'textarea'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line837' class='line'> 837</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">aElement.value</span><span class="PUNC">;</span><span class="WHIT">
<span id='line838' class='line'> 838</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line839' class='line'> 839</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'select'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line840' class='line'> 840</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">options</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.utils.toArray</span><span class="PUNC">(</span><span class="NAME">aElement.options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line841' class='line'> 841</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">values</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line842' class='line'> 842</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">options.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">option</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line843' class='line'> 843</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">option.selected</span><span class="PUNC">)</span><span class="WHIT">
<span id='line844' class='line'> 844</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">getValue</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.push</span><span class="PUNC">(</span><span class="NAME">option.value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.push</span><span class="PUNC">(</span><span class="NAME">option.firstChild</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line845' class='line'> 845</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">values</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line846' class='line'> 846</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line847' class='line'> 847</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">values.length</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">values</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span id='line848' class='line'> 848</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line849' class='line'> 849</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">  </span><span class="COMM">//may be radiogroup</span><span class="WHIT">
<span id='line850' class='line'> 850</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">radios</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uuQuery</span><span class="PUNC">(</span><span class="STRN">'input[type=radio]'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aElement</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line851' class='line'> 851</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">values</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line852' class='line'> 852</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">radios.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">radio</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line853' class='line'> 853</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.getFormValue</span><span class="PUNC">(</span><span class="NAME">radio</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line854' class='line'> 854</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">this.push</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line855' class='line'> 855</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">values</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line856' class='line'> 856</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line857' class='line'> 857</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">values.length</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">values</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span id='line858' class='line'> 858</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line859' class='line'> 859</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line860' class='line'> 860</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line861' class='line'> 861</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line862' class='line'> 862</span> &nbsp;&nbsp;&nbsp;&nbsp; * フォーム関連要素の値をセットする
<span id='line863' class='line'> 863</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement input, textarea, select, or radiogroup(element[class=radiogroup] which has a group of input[type=radio])
<span id='line864' class='line'> 864</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String|Array} value the value(s) to set
<span id='line865' class='line'> 865</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line866' class='line'> 866</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">setFormValue</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line867' class='line'> 867</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">aElement.tagName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line868' class='line'> 868</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'input'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line869' class='line'> 869</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">aElement.type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line870' class='line'> 870</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'checkbox'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line871' class='line'> 871</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'radio'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line872' class='line'> 872</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.checked</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span id='line873' class='line'> 873</span> 
<span id='line874' class='line'> 874</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span id='line875' class='line'> 875</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line876' class='line'> 876</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line877' class='line'> 877</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line878' class='line'> 878</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'textarea'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line879' class='line'> 879</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">aElement.value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span id='line880' class='line'> 880</span> </span><span class="COMM">/*
<span id='line881' class='line'> 881</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//not implemented yet
<span id='line882' class='line'> 882</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line883' class='line'> 883</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case 'select':
<span id='line884' class='line'> 884</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var options = joCore.utils.toArray(aElement.options);
<span id='line885' class='line'> 885</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var values = [];
<span id='line886' class='line'> 886</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;options.forEach(function(option){
<span id='line887' class='line'> 887</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(option.selected)
<span id='line888' class='line'> 888</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.push(option.value);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line889' class='line'> 889</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, values);
<span id='line890' class='line'> 890</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line891' class='line'> 891</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return values.length ? values : null;
<span id='line892' class='line'> 892</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line893' class='line'> 893</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:  //may be radiogroup
<span id='line894' class='line'> 894</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var radios = uuQuery('input[type=radio]', aElement);
<span id='line895' class='line'> 895</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var values = [];
<span id='line896' class='line'> 896</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;radios.forEach(function(radio){
<span id='line897' class='line'> 897</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var v = joCore.getFormValue(radio);
<span id='line898' class='line'> 898</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(v !== null) this.push(v);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line899' class='line'> 899</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, values);
<span id='line900' class='line'> 900</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line901' class='line'> 901</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return values.length ? values : null;*/</span><span class="WHIT">
<span id='line902' class='line'> 902</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line903' class='line'> 903</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line904' class='line'> 904</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line905' class='line'> 905</span> 
<span id='line906' class='line'> 906</span> 
<span id='line907' class='line'> 907</span> </span><span class="WHIT"> 
<span id='line908' class='line'> 908</span> </span><span class="doccmt">/**
<span id='line909' class='line'> 909</span>  * IO service of Dinos File System and Local Files
<span id='line910' class='line'> 910</span>  * <span class="doctag">@class</span>
<span id='line911' class='line'> 911</span>  */</span><span class="WHIT">
<span id='line912' class='line'> 912</span> </span><span class="NAME">joCore.IO</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line913' class='line'> 913</span> 
<span id='line914' class='line'> 914</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line915' class='line'> 915</span> &nbsp;&nbsp;&nbsp;&nbsp; * ネットワーク上にあるファイルを扱うクラス
<span id='line916' class='line'> 916</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@class</span>
<span id='line917' class='line'> 917</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line918' class='line'> 918</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">Network</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line919' class='line'> 919</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line920' class='line'> 920</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line921' class='line'> 921</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * ファイルを読み込む（DOM0）
<span id='line922' class='line'> 922</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line923' class='line'> 923</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aFileType js,css,無指定 のどれか
<span id='line924' class='line'> 924</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aFilePath core.js からみた相対パス or 絶対パス
<span id='line925' class='line'> 925</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Deferred|Node} js: script要素 &lt;br>
<span id='line926' class='line'> 926</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *                         css: link要素 &lt;br>
<span id='line927' class='line'> 927</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *                         その他: iframe要素
<span id='line928' class='line'> 928</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line929' class='line'> 929</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">load</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aFileType</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line930' class='line'> 930</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Deferred</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line931' class='line'> 931</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tag</span><span class="PUNC">;</span><span class="WHIT">
<span id='line932' class='line'> 932</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line933' class='line'> 933</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">aFileType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line934' class='line'> 934</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line935' class='line'> 935</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'js'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line936' class='line'> 936</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> 
<span id='line937' class='line'> 937</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'script'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line938' class='line'> 938</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'text/javascript'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line939' class='line'> 939</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">src</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="WHIT">
<span id='line940' class='line'> 940</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line941' class='line'> 941</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line942' class='line'> 942</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line943' class='line'> 943</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line944' class='line'> 944</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'css'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line945' class='line'> 945</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span id='line946' class='line'> 946</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'link'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line947' class='line'> 947</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">type</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'text/css'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line948' class='line'> 948</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">rel</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'stylesheet'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line949' class='line'> 949</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">href</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="WHIT">
<span id='line950' class='line'> 950</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line951' class='line'> 951</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line952' class='line'> 952</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line953' class='line'> 953</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line954' class='line'> 954</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span id='line955' class='line'> 955</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">tag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span id='line956' class='line'> 956</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'iframe'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line957' class='line'> 957</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">src</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">,</span><span class="WHIT">
<span id='line958' class='line'> 958</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">document.body</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line959' class='line'> 959</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line960' class='line'> 960</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addStyle</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line961' class='line'> 961</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span id='line962' class='line'> 962</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span id='line963' class='line'> 963</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">visibility</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'hidden'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line964' class='line'> 964</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">position</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'absolute'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line965' class='line'> 965</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">top</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'10000px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line966' class='line'> 966</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">left</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'10000px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line967' class='line'> 967</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line968' class='line'> 968</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line969' class='line'> 969</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line970' class='line'> 970</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line971' class='line'> 971</span> 
<span id='line972' class='line'> 972</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">tag.addEventListener</span><span class="PUNC">(</span><span class="STRN">'load'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">deferred.call</span><span class="PUNC">(</span><span class="NAME">tag</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line973' class='line'> 973</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">;</span><span class="WHIT">
<span id='line974' class='line'> 974</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line975' class='line'> 975</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line976' class='line'> 976</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line977' class='line'> 977</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * ファイルを読み込む（Ajax）
<span id='line978' class='line'> 978</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * 
<span id='line979' class='line'> 979</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aFilePath 読み込むファイル
<span id='line980' class='line'> 980</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} [aMimeType="text/xml"] ファイルのMimeType
<span id='line981' class='line'> 981</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Deferred|XMLHttpRequest}
<span id='line982' class='line'> 982</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line983' class='line'> 983</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">read</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aFilePath</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aMimeType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line984' class='line'> 984</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line985' class='line'> 985</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Deferred</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line986' class='line'> 986</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line987' class='line'> 987</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">req</span><span class="PUNC">;</span><span class="WHIT">
<span id='line988' class='line'> 988</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line989' class='line'> 989</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">req</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line990' class='line'> 990</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line991' class='line'> 991</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">req</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ActiveXObject</span><span class="PUNC">(</span><span class="STRN">'Microsoft.XMLHTTP'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line992' class='line'> 992</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line993' class='line'> 993</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line994' class='line'> 994</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">req.onerror</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">deferred.fail</span><span class="PUNC">(</span><span class="NAME">req</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line995' class='line'> 995</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">req.onreadystatechange</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line996' class='line'> 996</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">req.readyState</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line997' class='line'> 997</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">req.status</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">req.status</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">200</span><span class="PUNC">)</span><span class="WHIT">
<span id='line998' class='line'> 998</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deferred.call</span><span class="PUNC">(</span><span class="NAME">req</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line999' class='line'> 999</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">else</span><span class="WHIT">
<span id='line1000' class='line'>1000</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deferred.fail</span><span class="PUNC">(</span><span class="NAME">req</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1001' class='line'>1001</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1002' class='line'>1002</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1003' class='line'>1003</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1004' class='line'>1004</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">req.open</span><span class="PUNC">(</span><span class="STRN">'GET'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1005' class='line'>1005</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1006' class='line'>1006</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">req.overrideMimeType</span><span class="PUNC">)</span><span class="WHIT">
<span id='line1007' class='line'>1007</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">req.overrideMimeType</span><span class="PUNC">(</span><span class="NAME">aMimeType</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">'text/xml'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1008' class='line'>1008</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1009' class='line'>1009</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">req.send</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1010' class='line'>1010</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1011' class='line'>1011</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1012' class='line'>1012</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.error</span><span class="PUNC">(</span><span class="STRN">'[joCore.IO.Network.read]'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1013' class='line'>1013</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">deferred.fail</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1014' class='line'>1014</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1015' class='line'>1015</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1016' class='line'>1016</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1017' class='line'>1017</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1018' class='line'>1018</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1019' class='line'>1019</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1020' class='line'>1020</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1021' class='line'>1021</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * クロスドメインで通信をする（postMessageを使用）
<span id='line1022' class='line'>1022</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} url
<span id='line1023' class='line'>1023</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Window} targetWindow
<span id='line1024' class='line'>1024</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Deferred|Any} messageイベントのevent.dataプロパティが返る
<span id='line1025' class='line'>1025</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@note</span> ターゲットウィンドウ側でmessageイベントを実装している必要あり
<span id='line1026' class='line'>1026</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1027' class='line'>1027</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">readCrossDomain</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">targetWindow</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1028' class='line'>1028</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1029' class='line'>1029</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Deferred</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1030' class='line'>1030</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1031' class='line'>1031</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">window.addEventListener</span><span class="PUNC">(</span><span class="STRN">'message'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1032' class='line'>1032</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1033' class='line'>1033</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//Unlisten the message event</span><span class="WHIT">
<span id='line1034' class='line'>1034</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">window.removeEventListener</span><span class="PUNC">(</span><span class="STRN">'message'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments.callee</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1035' class='line'>1035</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1036' class='line'>1036</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deferred.call</span><span class="PUNC">(</span><span class="NAME">event.data</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1037' class='line'>1037</span> 
<span id='line1038' class='line'>1038</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1039' class='line'>1039</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1040' class='line'>1040</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1041' class='line'>1041</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">targetWindow.postMessage</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'*'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1042' class='line'>1042</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1043' class='line'>1043</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1044' class='line'>1044</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1045' class='line'>1045</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1046' class='line'>1046</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1047' class='line'>1047</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1048' class='line'>1048</span> &nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1049' class='line'>1049</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1050' class='line'>1050</span> &nbsp;&nbsp;&nbsp;&nbsp; * Dinosディスク内のファイルを扱うクラス
<span id='line1051' class='line'>1051</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@class</span>
<span id='line1052' class='line'>1052</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1053' class='line'>1053</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">Dinos</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line1054' class='line'>1054</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1055' class='line'>1055</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * ファイルに書き込む &lt;br>
<span id='line1056' class='line'>1056</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * もし当該ファイルが存在していなかった場合には自動で作成する
<span id='line1057' class='line'>1057</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line1058' class='line'>1058</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aString 書き込むデータ
<span id='line1059' class='line'>1059</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} aFilePath 書き込み先のファイル
<span id='line1060' class='line'>1060</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Boolean} [notCheckDuplicate=false] 重複を警告するかどうか
<span id='line1061' class='line'>1061</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Node} 書き込み先のファイルのノード
<span id='line1062' class='line'>1062</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1063' class='line'>1063</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">write</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">notCheckDuplicate</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1064' class='line'>1064</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fileName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joFileManager.getFileNameFromPath</span><span class="PUNC">(</span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1065' class='line'>1065</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">folderPath</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joFileManager.getParentFolderFromPath</span><span class="PUNC">(</span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1066' class='line'>1066</span> 
<span id='line1067' class='line'>1067</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.log</span><span class="PUNC">(</span><span class="STRN">'write a file:'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">file</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">fileName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">folder</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">folderPath</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1068' class='line'>1068</span> 
<span id='line1069' class='line'>1069</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">joFileManager.exist</span><span class="PUNC">(</span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1070' class='line'>1070</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">notCheckDuplicate</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1071' class='line'>1071</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joUI.confirm</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1072' class='line'>1072</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">fileName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'という名前のファイルがすでにこの場所に存在しています。上書きしますか？'</span><span class="WHIT">
<span id='line1073' class='line'>1073</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">overwriteFlag</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1074' class='line'>1074</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">overwriteFlag</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">joFileManager.write</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1075' class='line'>1075</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1076' class='line'>1076</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1077' class='line'>1077</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joFileManager.write</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1078' class='line'>1078</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1079' class='line'>1079</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1080' class='line'>1080</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joFileManager.createFile</span><span class="PUNC">(</span><span class="NAME">fileName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">folderPath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1081' class='line'>1081</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joFileManager.write</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aFilePath</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1082' class='line'>1082</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1083' class='line'>1083</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1084' class='line'>1084</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1085' class='line'>1085</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1086' class='line'>1086</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * ファイルを読み込む &lt;br>
<span id='line1087' class='line'>1087</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * data属性にデータが入っているファイルと、CDATAセクションなどで格納されているファイル共に読み込めるので
<span id='line1088' class='line'>1088</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * ファイルの内容読み込みにはjoFileManager.getFileではなくこちらを推奨
<span id='line1089' class='line'>1089</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line1090' class='line'>1090</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String/DinosPath} path 読み込むファイルのパス
<span id='line1091' class='line'>1091</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {String} ファイルのデータ
<span id='line1092' class='line'>1092</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1093' class='line'>1093</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">read</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1094' class='line'>1094</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">file</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joFileManager.getFile</span><span class="PUNC">(</span><span class="NAME">path</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1095' class='line'>1095</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1096' class='line'>1096</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">file</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1097' class='line'>1097</span> 
<span id='line1098' class='line'>1098</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(file.hasAttribute('data')){</span><span class="WHIT">
<span id='line1099' class='line'>1099</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return file.getAttribute('data');</span><span class="WHIT">
<span id='line1100' class='line'>1100</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{</span><span class="WHIT">
<span id='line1101' class='line'>1101</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//innerText: Firefox, IE以外</span><span class="WHIT">
<span id='line1102' class='line'>1102</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//textContent: Firefox</span><span class="WHIT">
<span id='line1103' class='line'>1103</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//正規表現: IE</span><span class="WHIT">
<span id='line1104' class='line'>1104</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1105' class='line'>1105</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;joCore.logger.log(file.innerHTML);</span><span class="WHIT">
<span id='line1106' class='line'>1106</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1107' class='line'>1107</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">file.innerText</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">file.textContent</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">file.text</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//Other || Firefox || IE</span><span class="WHIT">
<span id='line1108' class='line'>1108</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span><span class="WHIT">
<span id='line1109' class='line'>1109</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1110' class='line'>1110</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1111' class='line'>1111</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1112' class='line'>1112</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1113' class='line'>1113</span> &nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1114' class='line'>1114</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1115' class='line'>1115</span> &nbsp;&nbsp;&nbsp;&nbsp; * ローカルファイルを扱うクラス
<span id='line1116' class='line'>1116</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@class</span>
<span id='line1117' class='line'>1117</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1118' class='line'>1118</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">Local</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line1119' class='line'>1119</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1120' class='line'>1120</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1121' class='line'>1121</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * ファイルを書き出す
<span id='line1122' class='line'>1122</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aString 書き出す文字列
<span id='line1123' class='line'>1123</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aFileName ファイルネーム
<span id='line1124' class='line'>1124</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1125' class='line'>1125</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">write</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">aFileName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1126' class='line'>1126</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">Deferred.next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1127' class='line'>1127</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joUI.prompt</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1128' class='line'>1128</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">300</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1129' class='line'>1129</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1130' class='line'>1130</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Save as...'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1131' class='line'>1131</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Enter the file name.'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1132' class='line'>1132</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">defaultStr</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">aFileName</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1133' class='line'>1133</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1134' class='line'>1134</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1135' class='line'>1135</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joUI.dialog</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1136' class='line'>1136</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">300</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1137' class='line'>1137</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1138' class='line'>1138</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'&lt;p>Click the below link &lt;b>with alt-key&lt;/b> to save file.&lt;/p>'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> 
<span id='line1139' class='line'>1139</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="STRN">'&lt;a class="local-write-link" href="data:application/octet-stream,'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> 
<span id='line1140' class='line'>1140</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="NAME">encodeURIComponent</span><span class="PUNC">(</span><span class="NAME">aString</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'">'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'&lt;/a>'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1141' class='line'>1141</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Save as...'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1142' class='line'>1142</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1143' class='line'>1143</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">error</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">joCore.logger.error</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1144' class='line'>1144</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1145' class='line'>1145</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1146' class='line'>1146</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1147' class='line'>1147</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * ファイルを読み込む
<span id='line1148' class='line'>1148</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} aFileName 読み込むファイル名
<span id='line1149' class='line'>1149</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Deferred|String}
<span id='line1150' class='line'>1150</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1151' class='line'>1151</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">read</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aFileName</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">notCheckFileName</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1152' class='line'>1152</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Deferred.next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">   </span><span class="COMM">//ダイアログを表示して、ユーザーがファイルを指定するのを待機する</span><span class="WHIT">
<span id='line1153' class='line'>1153</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Deferred</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1154' class='line'>1154</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">that</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1155' class='line'>1155</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1156' class='line'>1156</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//ダイアログ表示</span><span class="WHIT">
<span id='line1157' class='line'>1157</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joUI.dialog</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1158' class='line'>1158</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">300</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1159' class='line'>1159</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">140</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1160' class='line'>1160</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'&lt;p>Dinos want to access a local file. &lt;br /> \
<span id='line1161' class='line'>1161</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  Please select or drop "&lt;b>'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">aFileName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'&lt;/b>".&lt;/p>&lt;br /> \
<span id='line1162' class='line'>1162</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  &lt;input type="file" class="local-read-input" />&lt;br />&lt;br /> \
<span id='line1163' class='line'>1163</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  * If you cannot select or drop a file, &lt;a class="local-read-prompt-link">click here&lt;/a>.'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1164' class='line'>1164</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Open as...'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1165' class='line'>1165</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1166' class='line'>1166</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1167' class='line'>1167</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'local-read-prompt-link'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dialog.display.content</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">loadWithPrompt</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1168' class='line'>1168</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1169' class='line'>1169</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//dropbox化</span><span class="WHIT">
<span id='line1170' class='line'>1170</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joUI.dropbox</span><span class="PUNC">(</span><span class="NAME">dialog.display.content</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line1171' class='line'>1171</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">that</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1172' class='line'>1172</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">input</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'local-read-input'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dialog.display.content</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1173' class='line'>1173</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">dataArray</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">files</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1174' class='line'>1174</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">dataArray.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1175' class='line'>1175</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">dataArray</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1176' class='line'>1176</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1177' class='line'>1177</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">notCheckFileName</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">checkValidFile</span><span class="PUNC">(</span><span class="NAME">files</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1178' class='line'>1178</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">dialog.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1179' class='line'>1179</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deferred.call</span><span class="PUNC">(</span><span class="NAME">dataArray</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1180' class='line'>1180</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1181' class='line'>1181</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1182' class='line'>1182</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1183' class='line'>1183</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">onerror</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">loadWithPrompt</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1184' class='line'>1184</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1185' class='line'>1185</span> 
<span id='line1186' class='line'>1186</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1187' class='line'>1187</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//要求されたファイルが指定されたのかどうかを調べる</span><span class="WHIT">
<span id='line1188' class='line'>1188</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">checkValidFile</span><span class="PUNC">(</span><span class="NAME">file</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1189' class='line'>1189</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">file.name</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">file.fileName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1190' class='line'>1190</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">file.name</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">file.name.indexOf</span><span class="PUNC">(</span><span class="NAME">aFileName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">file.fileName</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">file.fileName.indexOf</span><span class="PUNC">(</span><span class="NAME">aFileName</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1191' class='line'>1191</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1192' class='line'>1192</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1193' class='line'>1193</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//Drag and Drop APIに失敗した場合</span><span class="WHIT">
<span id='line1194' class='line'>1194</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">loadWithPrompt</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1195' class='line'>1195</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joUI.prompt</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1196' class='line'>1196</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">500</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1197' class='line'>1197</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">500</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1198' class='line'>1198</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Your browser does not support Drag and Drop API. Please copy and paste the content of "&lt;b>'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">aFileName</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'&lt;/b>".'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1199' class='line'>1199</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Open as...'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1200' class='line'>1200</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">multiline</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1201' class='line'>1201</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1202' class='line'>1202</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">dialog.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1203' class='line'>1203</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deferred.call</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1204' class='line'>1204</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1205' class='line'>1205</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1206' class='line'>1206</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1207' class='line'>1207</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1208' class='line'>1208</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1209' class='line'>1209</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1210' class='line'>1210</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1211' class='line'>1211</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1212' class='line'>1212</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1213' class='line'>1213</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1214' class='line'>1214</span> 
<span id='line1215' class='line'>1215</span> 
<span id='line1216' class='line'>1216</span> </span><span class="doccmt">/**
<span id='line1217' class='line'>1217</span>  * Logger
<span id='line1218' class='line'>1218</span>  * <span class="doctag">@class</span>
<span id='line1219' class='line'>1219</span>  */</span><span class="WHIT">
<span id='line1220' class='line'>1220</span> </span><span class="NAME">joCore.logger</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line1221' class='line'>1221</span> 
<span id='line1222' class='line'>1222</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1223' class='line'>1223</span> &nbsp;&nbsp;&nbsp;&nbsp; * 出力レベル：デバッグ
<span id='line1224' class='line'>1224</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> Number
<span id='line1225' class='line'>1225</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1226' class='line'>1226</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">DEBUG</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1227' class='line'>1227</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1228' class='line'>1228</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1229' class='line'>1229</span> &nbsp;&nbsp;&nbsp;&nbsp; * 出力レベル：ログ
<span id='line1230' class='line'>1230</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> Number
<span id='line1231' class='line'>1231</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1232' class='line'>1232</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">LOG</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1233' class='line'>1233</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1234' class='line'>1234</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1235' class='line'>1235</span> &nbsp;&nbsp;&nbsp;&nbsp; * 出力レベル：情報
<span id='line1236' class='line'>1236</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> Number
<span id='line1237' class='line'>1237</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1238' class='line'>1238</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">INFO</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1239' class='line'>1239</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1240' class='line'>1240</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1241' class='line'>1241</span> &nbsp;&nbsp;&nbsp;&nbsp; * 出力レベル：警告
<span id='line1242' class='line'>1242</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> Number
<span id='line1243' class='line'>1243</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1244' class='line'>1244</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">WARNING</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1245' class='line'>1245</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1246' class='line'>1246</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1247' class='line'>1247</span> &nbsp;&nbsp;&nbsp;&nbsp; * 出力レベル：エラー
<span id='line1248' class='line'>1248</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> Number
<span id='line1249' class='line'>1249</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1250' class='line'>1250</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">ERROR</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1251' class='line'>1251</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1252' class='line'>1252</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1253' class='line'>1253</span> &nbsp;&nbsp;&nbsp;&nbsp; * コンソールにメッセージを出力
<span id='line1254' class='line'>1254</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Number} [lebel=LOG] 出力レベル
<span id='line1255' class='line'>1255</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1256' class='line'>1256</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">level</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1257' class='line'>1257</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1258' class='line'>1258</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1259' class='line'>1259</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">level</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1260' class='line'>1260</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">this.DEBUG</span><span class="PUNC">:</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">level</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'[DEBUG]'</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'debug'</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1261' class='line'>1261</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">this.LOG</span><span class="PUNC">:</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">level</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'log'</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1262' class='line'>1262</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">this.INFO</span><span class="PUNC">:</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">level</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'[INFO]'</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'info'</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1263' class='line'>1263</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">this.WARNING</span><span class="PUNC">:</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">level</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'[WARNING]'</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'warn'</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1264' class='line'>1264</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">this.ERROR</span><span class="PUNC">:</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">level</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'[ERROR]'</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'error'</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1265' class='line'>1265</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">level</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">method</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'log'</span><span class="PUNC">;</span><span class="WHIT">   </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1266' class='line'>1266</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1267' class='line'>1267</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1268' class='line'>1268</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">window.console</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1269' class='line'>1269</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1270' class='line'>1270</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">console</span><span class="PUNC">[</span><span class="NAME">method</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line1271' class='line'>1271</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">console</span><span class="PUNC">[</span><span class="NAME">method</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="NAME">console</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1272' class='line'>1272</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">else</span><span class="WHIT">
<span id='line1273' class='line'>1273</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">console.log.apply</span><span class="PUNC">(</span><span class="NAME">console</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1274' class='line'>1274</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1275' class='line'>1275</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//maybe IE</span><span class="WHIT">
<span id='line1276' class='line'>1276</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1277' class='line'>1277</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">argStr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.utils.toArray</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">'\n'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1278' class='line'>1278</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1279' class='line'>1279</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">console</span><span class="PUNC">[</span><span class="NAME">method</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line1280' class='line'>1280</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">console</span><span class="PUNC">[</span><span class="NAME">method</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="NAME">argStr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1281' class='line'>1281</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">else</span><span class="WHIT">
<span id='line1282' class='line'>1282</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="NAME">argStr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1283' class='line'>1283</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1284' class='line'>1284</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">window.dump</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1285' class='line'>1285</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">window.dump</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">joCore.utils.toArray</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">' '</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'\n'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1286' class='line'>1286</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1287' class='line'>1287</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1288' class='line'>1288</span> </span><span class="COMM">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alert((joCore.utils.toArray(arguments)).join('\n'));</span><span class="WHIT">
<span id='line1289' class='line'>1289</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1290' class='line'>1290</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1291' class='line'>1291</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1292' class='line'>1292</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1293' class='line'>1293</span> &nbsp;&nbsp;&nbsp;&nbsp; * ログメッセージ
<span id='line1294' class='line'>1294</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line1295' class='line'>1295</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@notes</span> 複数の引数を指定した場合は半角スペースで区切って出力する。ほかのメソッドも同様。
<span id='line1296' class='line'>1296</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@example</span>
<span id='line1297' class='line'>1297</span> &nbsp;&nbsp;&nbsp;&nbsp; *    joCore.logger.log('hoge');  //hoge
<span id='line1298' class='line'>1298</span> &nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;  joCore.logger.log('hoge', 'fuga', 'foo', 'bar'); //hoge fuga foo bar
<span id='line1299' class='line'>1299</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1300' class='line'>1300</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">log</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1301' class='line'>1301</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.utils.toArray</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1302' class='line'>1302</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.message.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">this.LOG</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1303' class='line'>1303</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1304' class='line'>1304</span> 
<span id='line1305' class='line'>1305</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1306' class='line'>1306</span> &nbsp;&nbsp;&nbsp;&nbsp; * デバッグメッセージ
<span id='line1307' class='line'>1307</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1308' class='line'>1308</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">debug</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1309' class='line'>1309</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.utils.toArray</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1310' class='line'>1310</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.message.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">this.DEBUG</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1311' class='line'>1311</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1312' class='line'>1312</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1313' class='line'>1313</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1314' class='line'>1314</span> &nbsp;&nbsp;&nbsp;&nbsp; * 情報メッセージ
<span id='line1315' class='line'>1315</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1316' class='line'>1316</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">info</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1317' class='line'>1317</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.utils.toArray</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1318' class='line'>1318</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.message.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">this.INFO</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1319' class='line'>1319</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1320' class='line'>1320</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1321' class='line'>1321</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1322' class='line'>1322</span> &nbsp;&nbsp;&nbsp;&nbsp; * 警告メッセージ
<span id='line1323' class='line'>1323</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1324' class='line'>1324</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">warning</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1325' class='line'>1325</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.utils.toArray</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1326' class='line'>1326</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.message.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">this.WARNING</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1327' class='line'>1327</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1328' class='line'>1328</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1329' class='line'>1329</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1330' class='line'>1330</span> &nbsp;&nbsp;&nbsp;&nbsp; * エラーメッセージ&lt;br>
<span id='line1331' class='line'>1331</span> &nbsp;&nbsp;&nbsp;&nbsp; * Errorオブジェクトを渡した場合は, Errorオブジェクトが持つ全てのプロパティを出力する
<span id='line1332' class='line'>1332</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1333' class='line'>1333</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">error</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1334' class='line'>1334</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.utils.toArray</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1335' class='line'>1335</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args_</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">args.concat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1336' class='line'>1336</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1337' class='line'>1337</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//エラーオブジェクトを展開する</span><span class="WHIT">
<span id='line1338' class='line'>1338</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">args.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1339' class='line'>1339</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1340' class='line'>1340</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1341' class='line'>1341</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">args_.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1342' class='line'>1342</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1343' class='line'>1343</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._errorToObject</span><span class="PUNC">(</span><span class="NAME">args</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1344' class='line'>1344</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">args_.push</span><span class="PUNC">(</span><span class="STRN">'\n[ERROR] '</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">e.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1345' class='line'>1345</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">args_.push</span><span class="PUNC">(</span><span class="STRN">'\n'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' : '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1346' class='line'>1346</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1347' class='line'>1347</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1348' class='line'>1348</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.message.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">this.ERROR</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">args_</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1349' class='line'>1349</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1350' class='line'>1350</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1351' class='line'>1351</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1352' class='line'>1352</span> &nbsp;&nbsp;&nbsp;&nbsp; * エラーオブジェクトを普通のオブジェクトに変換して各プロパティを列挙可能にする
<span id='line1353' class='line'>1353</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Error} er エラーオブジェクト
<span id='line1354' class='line'>1354</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Object} Errorオブジェクトの各プロパティ
<span id='line1355' class='line'>1355</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1356' class='line'>1356</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_errorToObject</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">er</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1357' class='line'>1357</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//stackの解析を試みる</span><span class="WHIT">
<span id='line1358' class='line'>1358</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">stack</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">stacktrace</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1359' class='line'>1359</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1360' class='line'>1360</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">er.stack</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1361' class='line'>1361</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">stack</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">er.stack.replace</span><span class="PUNC">(</span><span class="REGX">/(\(.*?\)[^\(]+)/ig</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'$1\n'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\n\n/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'\n'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1362' class='line'>1362</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1363' class='line'>1363</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">er.stacktrace</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1364' class='line'>1364</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">stacktrace</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">er.stacktrace.replace</span><span class="PUNC">(</span><span class="REGX">/:\s/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">':\n'</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\n\n/g</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'\n'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1365' class='line'>1365</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1366' class='line'>1366</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1367' class='line'>1367</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line1368' class='line'>1368</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'name'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">er.name</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1369' class='line'>1369</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'description'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">er.description</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1370' class='line'>1370</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'message'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">er.message</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1371' class='line'>1371</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'constructor'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">er.constructor</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1372' class='line'>1372</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'fileName'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">er.fileName</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1373' class='line'>1373</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'number'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">er.number</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1374' class='line'>1374</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'lineNumber'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">er.lineNumber</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1375' class='line'>1375</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'stack'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">stack</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">er.stack</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1376' class='line'>1376</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'stacktrace'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">stacktrace</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">er.stacktrace</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1377' class='line'>1377</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1378' class='line'>1378</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1379' class='line'>1379</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1380' class='line'>1380</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1381' class='line'>1381</span> &nbsp;&nbsp;&nbsp;&nbsp; * タイマーオブジェクト
<span id='line1382' class='line'>1382</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@class</span>
<span id='line1383' class='line'>1383</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1384' class='line'>1384</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">timer</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line1385' class='line'>1385</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1386' class='line'>1386</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1387' class='line'>1387</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * タイマーをスタートさせる
<span id='line1388' class='line'>1388</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Number} タイマーID
<span id='line1389' class='line'>1389</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1390' class='line'>1390</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">start</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1391' class='line'>1391</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1392' class='line'>1392</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1393' class='line'>1393</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1394' class='line'>1394</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1395' class='line'>1395</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * タイマーを終了させる &lt;br> 結果はjoCore.logger.logで出力される
<span id='line1396' class='line'>1396</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Number} aID タイマーID
<span id='line1397' class='line'>1397</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1398' class='line'>1398</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">end</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aID</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1399' class='line'>1399</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">end</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1400' class='line'>1400</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.log</span><span class="PUNC">(</span><span class="STRN">'[joCore timer]'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">end</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">aID</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'ms'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1401' class='line'>1401</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1402' class='line'>1402</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span id='line1403' class='line'>1403</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1404' class='line'>1404</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1405' class='line'>1405</span> 
<span id='line1406' class='line'>1406</span> 
<span id='line1407' class='line'>1407</span> 
<span id='line1408' class='line'>1408</span> </span><span class="doccmt">/**
<span id='line1409' class='line'>1409</span>  * joDisplay
<span id='line1410' class='line'>1410</span>  * <span class="doctag">@class</span>
<span id='line1411' class='line'>1411</span>  */</span><span class="WHIT">
<span id='line1412' class='line'>1412</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">joDisplay</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line1413' class='line'>1413</span> 
<span id='line1414' class='line'>1414</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_offsetX</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1415' class='line'>1415</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_offsetY</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1416' class='line'>1416</span> 
<span id='line1417' class='line'>1417</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1418' class='line'>1418</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.setOffset</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="COMM">/*joCore.Node.getNodeRect($C('menupopup', $('menubar'))).height*/</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1419' class='line'>1419</span> 
<span id='line1420' class='line'>1420</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'resize'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.onResize</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1421' class='line'>1421</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.onResize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1422' class='line'>1422</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1423' class='line'>1423</span> 
<span id='line1424' class='line'>1424</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/** <span class="doctag">@function</span> */</span><span class="WHIT">
<span id='line1425' class='line'>1425</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">displayWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1426' class='line'>1426</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">joCore.settings.BOOT_MODE</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'FullScreen'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line1427' class='line'>1427</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.documentElement.clientWidth</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this._offsetX</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1428' class='line'>1428</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">else</span><span class="WHIT">
<span id='line1429' class='line'>1429</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joCore.Node.getNodeRect</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'display'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">width</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this._offsetX</span><span class="PUNC">;</span><span class="WHIT">       
<span id='line1430' class='line'>1430</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1431' class='line'>1431</span> 
<span id='line1432' class='line'>1432</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/** <span class="doctag">@function</span> */</span><span class="WHIT">
<span id='line1433' class='line'>1433</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">displayHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1434' class='line'>1434</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">joCore.settings.BOOT_MODE</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'FullScreen'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line1435' class='line'>1435</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.documentElement.clientHeight</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this._offsetY</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1436' class='line'>1436</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">else</span><span class="WHIT">
<span id='line1437' class='line'>1437</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joCore.Node.getNodeRect</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'display'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">height</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this._offsetY</span><span class="PUNC">;</span><span class="WHIT">  
<span id='line1438' class='line'>1438</span> &nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1439' class='line'>1439</span> 
<span id='line1440' class='line'>1440</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1441' class='line'>1441</span> &nbsp;&nbsp;&nbsp;&nbsp; * ディスプレイのオフセットを設定する
<span id='line1442' class='line'>1442</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Number} x 上端
<span id='line1443' class='line'>1443</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Number} y 左端
<span id='line1444' class='line'>1444</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1445' class='line'>1445</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">setOffset</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1446' class='line'>1446</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._offsetX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1447' class='line'>1447</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._offsetY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1448' class='line'>1448</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1449' class='line'>1449</span> 
<span id='line1450' class='line'>1450</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line1451' class='line'>1451</span> &nbsp;&nbsp;&nbsp;&nbsp; * ウィンドウがリサイズされたときに呼び出される 
<span id='line1452' class='line'>1452</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line1453' class='line'>1453</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">onResize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line1454' class='line'>1454</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addStyle</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'windows'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line1455' class='line'>1455</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">top</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this._offsetY</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1456' class='line'>1456</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">left</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this._offsetX</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1457' class='line'>1457</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.displayWidth</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line1458' class='line'>1458</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.displayHeight</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="WHIT">
<span id='line1459' class='line'>1459</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1460' class='line'>1460</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line1461' class='line'>1461</span> 
<span id='line1462' class='line'>1462</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line1463' class='line'>1463</span> </span></pre><div class='spacer'><span class='line'>&nbsp;&nbsp;&nbsp;&nbsp;</span></div></body></html>