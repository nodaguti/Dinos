<html><head><meta http-equiv='content-type' content='text/html; charset=utf-8'>
	<script type='text/javascript' >
	window.onload=function(){
	    var num = document.getElementById(location.hash.replace(/^#/,''));
	    if (num) {
	        num.style.color = 'RGB(255,255,50)';
	        num.style.backgroundColor = 'RGB(255,140,0)';
	    }
	}
	</script>
	<style>
	body, pre {font-family: 'MS Gothic',monospace; font-size: 12px; color:RGB(48,48,48); line-height: 14px; margin: 0px;}
	.KEYW {color: RGB(0,160,255); font-weight:bold;}
	.COMM {color: RGB(120,192,0)}
	.NUMB {color: RGB(128,99,0)}
	.STRN {color: RGB(220,160,60)}
	.REGX {color: RGB(230,0,0)}
	.line {border-right: 1px dotted RGB(140,140,140); color: RGB(140,140,140); background-color: RGB(240,240,240); padding: 1px 1px 1px 3px;}
	.doccmt {color: RGB(150,150,255)}
	.doctag {color: RGB(90,90,255)}
	.spacer {height:6px;overflow:hidden;}
	</style></head>
	<body lang='ja'><div class='spacer'><span class='line'>&nbsp;&nbsp;&nbsp;&nbsp;</span></div><pre><span id='line1' class='line'>   1</span> <span class="doccmt">/**
<span id='line2' class='line'>   2</span>  * UI
<span id='line3' class='line'>   3</span>  * <span class="doctag">@class</span> 
<span id='line4' class='line'>   4</span>  */</span><span class="WHIT">
<span id='line5' class='line'>   5</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">joUI</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line6' class='line'>   6</span> 
<span id='line7' class='line'>   7</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line8' class='line'>   8</span> &nbsp;&nbsp;&nbsp;&nbsp; * syntax sugar of joWindow
<span id='line9' class='line'>   9</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} param joWindowを参照
<span id='line10' class='line'>  10</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {joWindow}
<span id='line11' class='line'>  11</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@see</span> joWindow
<span id='line12' class='line'>  12</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line13' class='line'>  13</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">window</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line14' class='line'>  14</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joWindow</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line15' class='line'>  15</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line16' class='line'>  16</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line17' class='line'>  17</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line18' class='line'>  18</span> &nbsp;&nbsp;&nbsp;&nbsp; * syntax sugar of joDialog
<span id='line19' class='line'>  19</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} param joDialogを参照
<span id='line20' class='line'>  20</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {joDialog}
<span id='line21' class='line'>  21</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@see</span> joDialog
<span id='line22' class='line'>  22</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line23' class='line'>  23</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">dialog</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line24' class='line'>  24</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joDialog</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line25' class='line'>  25</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line26' class='line'>  26</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line27' class='line'>  27</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line28' class='line'>  28</span> &nbsp;&nbsp;&nbsp;&nbsp; * alert
<span id='line29' class='line'>  29</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} param joDialogを参照
<span id='line30' class='line'>  30</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Deferred|Boolean} OKボタンがクリックされたときにtrueが渡される
<span id='line31' class='line'>  31</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@see</span> joDialog
<span id='line32' class='line'>  32</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line33' class='line'>  33</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">alert</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line34' class='line'>  34</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Deferred</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line35' class='line'>  35</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line36' class='line'>  36</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joDialog</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line37' class='line'>  37</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'button-ok'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dialog.display.statusbar</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">deferred.call</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line38' class='line'>  38</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line39' class='line'>  39</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">;</span><span class="WHIT">
<span id='line40' class='line'>  40</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line41' class='line'>  41</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line42' class='line'>  42</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line43' class='line'>  43</span> &nbsp;&nbsp;&nbsp;&nbsp; * yes or no dialog
<span id='line44' class='line'>  44</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} param joDialogを参照
<span id='line45' class='line'>  45</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Deferred|Boolean}
<span id='line46' class='line'>  46</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@see</span> joDialog
<span id='line47' class='line'>  47</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line48' class='line'>  48</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">confirm</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line49' class='line'>  49</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Deferred</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line50' class='line'>  50</span> 
<span id='line51' class='line'>  51</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joDialog</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line52' class='line'>  52</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">dialog.addStatusbar</span><span class="PUNC">(</span><span class="STRN">'&lt;button class="button-cancel">Cancel&lt;/button>'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line53' class='line'>  53</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'button-cancel'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dialog.display.statusbar</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line54' class='line'>  54</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deferred.call</span><span class="PUNC">(</span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line55' class='line'>  55</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line56' class='line'>  56</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dialog</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line57' class='line'>  57</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'button-ok'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dialog.display.statusbar</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">deferred.call</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line58' class='line'>  58</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line59' class='line'>  59</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">;</span><span class="WHIT">
<span id='line60' class='line'>  60</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line61' class='line'>  61</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line62' class='line'>  62</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line63' class='line'>  63</span> &nbsp;&nbsp;&nbsp;&nbsp; * dialog with input box
<span id='line64' class='line'>  64</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} param joDialogを参照
<span id='line65' class='line'>  65</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {String} [param.defaultStr=''] デフォルトの文字列
<span id='line66' class='line'>  66</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Boolean} [param.multiline=false] 複数行入力可能にするかどうか
<span id='line67' class='line'>  67</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Deferred|String}
<span id='line68' class='line'>  68</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@see</span> joDialog
<span id='line69' class='line'>  69</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line70' class='line'>  70</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">prompt</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line71' class='line'>  71</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Deferred</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line72' class='line'>  72</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line73' class='line'>  73</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joDialog</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line74' class='line'>  74</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">param.multiline</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line75' class='line'>  75</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">dialog.addContent</span><span class="PUNC">(</span><span class="STRN">'&lt;textarea class="input-prompt">&lt;/textarea>'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line76' class='line'>  76</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">textarea</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'input-prompt'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dialog.display.content</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line77' class='line'>  77</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">textarea.value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">param.defaultStr</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span id='line78' class='line'>  78</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addStyle</span><span class="PUNC">(</span><span class="NAME">textarea</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line79' class='line'>  79</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">param.width</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">0.8</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line80' class='line'>  80</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">param.height</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">0.8</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line81' class='line'>  81</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line82' class='line'>  82</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line83' class='line'>  83</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">dialog.addContent</span><span class="PUNC">(</span><span class="STRN">'&lt;input type="text" class="input-prompt" value="'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">param.defaultStr</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'" />'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line84' class='line'>  84</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line85' class='line'>  85</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'button-ok'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dialog.display.statusbar</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'mousedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line86' class='line'>  86</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">inputStr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'input-prompt'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.content</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span id='line87' class='line'>  87</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deferred.call</span><span class="PUNC">(</span><span class="NAME">inputStr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line88' class='line'>  88</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line89' class='line'>  89</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dialog</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line90' class='line'>  90</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line91' class='line'>  91</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">;</span><span class="WHIT">
<span id='line92' class='line'>  92</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line93' class='line'>  93</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line94' class='line'>  94</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line95' class='line'>  95</span> &nbsp;&nbsp;&nbsp;&nbsp; * dialog with select box
<span id='line96' class='line'>  96</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} param joDialogを参照
<span id='line97' class='line'>  97</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Array} [param.selects] 選択肢
<span id='line98' class='line'>  98</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Array} [param.selectValues] 選択肢のvalue
<span id='line99' class='line'>  99</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Deferred|String}
<span id='line100' class='line'> 100</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@see</span> joDialog
<span id='line101' class='line'> 101</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line102' class='line'> 102</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">select</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line103' class='line'> 103</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Deferred</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line104' class='line'> 104</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line105' class='line'> 105</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dialog</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joDialog</span><span class="PUNC">(</span><span class="NAME">param</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line106' class='line'> 106</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line107' class='line'> 107</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">param.selectValues</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">param.selectValues</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">param.selects</span><span class="PUNC">;</span><span class="WHIT">
<span id='line108' class='line'> 108</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line109' class='line'> 109</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//オプションを作成</span><span class="WHIT">
<span id='line110' class='line'> 110</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">option</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'select'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'input-prompt'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dialog.display.content</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line111' class='line'> 111</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">param.selects.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">select</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line112' class='line'> 112</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'option'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">':child'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">select</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'value'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">param.selectValues</span><span class="PUNC">[</span><span class="NAME">index</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">option</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line113' class='line'> 113</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line114' class='line'> 114</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line115' class='line'> 115</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'button-ok'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dialog.display.statusbar</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'mousedown'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line116' class='line'> 116</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">inputStr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.getFormValue</span><span class="PUNC">(</span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'input-prompt'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.display.content</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">param.selectValues</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span id='line117' class='line'> 117</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">deferred.call</span><span class="PUNC">(</span><span class="NAME">inputStr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line118' class='line'> 118</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line119' class='line'> 119</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dialog</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line120' class='line'> 120</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line121' class='line'> 121</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">;</span><span class="WHIT">
<span id='line122' class='line'> 122</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line123' class='line'> 123</span> 
<span id='line124' class='line'> 124</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line125' class='line'> 125</span> &nbsp;&nbsp;&nbsp;&nbsp; * syntax sugar of joTab
<span id='line126' class='line'> 126</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {HTMLULElement} ul
<span id='line127' class='line'> 127</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {joTab}
<span id='line128' class='line'> 128</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@see</span> joTab
<span id='line129' class='line'> 129</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line130' class='line'> 130</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">tab</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ul</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line131' class='line'> 131</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joTab</span><span class="PUNC">(</span><span class="NAME">ul</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line132' class='line'> 132</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line133' class='line'> 133</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line134' class='line'> 134</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line135' class='line'> 135</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line136' class='line'> 136</span> &nbsp;&nbsp;&nbsp;&nbsp; * menupopup
<span id='line137' class='line'> 137</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} menuObj { menuitem_name: menuitem_oncommand, ... } &lt;br>
<span id='line138' class='line'> 138</span> &nbsp;&nbsp;&nbsp;&nbsp; *            {String} menuitem_name メニュー項目名 &lt;br>
<span id='line139' class='line'> 139</span> &nbsp;&nbsp;&nbsp;&nbsp; *            {String|Function} menuitem_oncommand メニュー項目が実行したときに呼ばれる関数 
<span id='line140' class='line'> 140</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} [thisObj=window] oncommandの中のthisが指すオブジェクト
<span id='line141' class='line'> 141</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {Node}
<span id='line142' class='line'> 142</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@example</span>
<span id='line143' class='line'> 143</span> &nbsp;&nbsp;&nbsp;&nbsp; *   joUI.menupopup({
<span id='line144' class='line'> 144</span> &nbsp;&nbsp;&nbsp;&nbsp; *      'Menu1': 'alert("Select the menu1");',
<span id='line145' class='line'> 145</span> &nbsp;&nbsp;&nbsp;&nbsp; *      'Menu2': function(){
<span id='line146' class='line'> 146</span> &nbsp;&nbsp;&nbsp;&nbsp; *          alert('Select the menu2');
<span id='line147' class='line'> 147</span> &nbsp;&nbsp;&nbsp;&nbsp; *       },
<span id='line148' class='line'> 148</span> &nbsp;&nbsp;&nbsp;&nbsp; *   }, this);
<span id='line149' class='line'> 149</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line150' class='line'> 150</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">menupopup</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">menuObj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">thisObj</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line151' class='line'> 151</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">thisObj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">thisObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window</span><span class="PUNC">;</span><span class="WHIT">
<span id='line152' class='line'> 152</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createDocumentFragment</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line153' class='line'> 153</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line154' class='line'> 154</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">menuname</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">menuObj</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line155' class='line'> 155</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">menuObj</span><span class="PUNC">[</span><span class="NAME">menuname</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line156' class='line'> 156</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//submenuがある場合: menupopupを作成</span><span class="WHIT">
<span id='line157' class='line'> 157</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line158' class='line'> 158</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//submenuの親</span><span class="WHIT">
<span id='line159' class='line'> 159</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">li</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'li'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line160' class='line'> 160</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'a'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">':context'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">menuname</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'hasChild'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">li</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line161' class='line'> 161</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line162' class='line'> 162</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//submenu本体</span><span class="WHIT">
<span id='line163' class='line'> 163</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ul</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'ul'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">li</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line164' class='line'> 164</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">ul.appendChild</span><span class="PUNC">(</span><span class="NAME">arguments.callee.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">menuObj</span><span class="PUNC">[</span><span class="NAME">menuname</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line165' class='line'> 165</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line166' class='line'> 166</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">li</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'mouseover'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">onOpenSubmenu</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ul</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line167' class='line'> 167</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line168' class='line'> 168</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//menuitemを作成</span><span class="WHIT">
<span id='line169' class='line'> 169</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">li</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'li'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line170' class='line'> 170</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">menuObj</span><span class="PUNC">[</span><span class="NAME">menuname</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line171' class='line'> 171</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">menuitem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'a'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">':context'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">menuname</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">li</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line172' class='line'> 172</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line173' class='line'> 173</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">menuObj</span><span class="PUNC">[</span><span class="NAME">menuname</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line174' class='line'> 174</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'function'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line175' class='line'> 175</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">menuitem</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'lclick'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">menuObj</span><span class="PUNC">[</span><span class="NAME">menuname</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">thisObj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line176' class='line'> 176</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line177' class='line'> 177</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line178' class='line'> 178</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'string'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line179' class='line'> 179</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">menuitem.setAttribute</span><span class="PUNC">(</span><span class="STRN">'onclick'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">menuObj</span><span class="PUNC">[</span><span class="NAME">menuname</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line180' class='line'> 180</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line181' class='line'> 181</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line182' class='line'> 182</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line183' class='line'> 183</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'a'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">':context'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">menuname</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">li</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line184' class='line'> 184</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line185' class='line'> 185</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line186' class='line'> 186</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line187' class='line'> 187</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line188' class='line'> 188</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line189' class='line'> 189</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">onOpenSubmenu</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">submenu</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line190' class='line'> 190</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//contextmenu が隠れないように補正する</span><span class="WHIT">
<span id='line191' class='line'> 191</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">crect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.getNodeRect</span><span class="PUNC">(</span><span class="NAME">submenu</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//submenu rect</span><span class="WHIT">
<span id='line192' class='line'> 192</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">drect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.getNodeRect</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">(</span><span class="STRN">'display'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="COMM">//display rect</span><span class="WHIT">
<span id='line193' class='line'> 193</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line194' class='line'> 194</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//right</span><span class="WHIT">
<span id='line195' class='line'> 195</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">crect.right</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">drect.right</span><span class="PUNC">)</span><span class="WHIT">
<span id='line196' class='line'> 196</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addStyle</span><span class="PUNC">(</span><span class="NAME">ul</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line197' class='line'> 197</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">left</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'-98%'</span><span class="WHIT">
<span id='line198' class='line'> 198</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line199' class='line'> 199</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line200' class='line'> 200</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//bottom</span><span class="WHIT">
<span id='line201' class='line'> 201</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">crect.bottom</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">drect.bottom</span><span class="PUNC">)</span><span class="WHIT">
<span id='line202' class='line'> 202</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addStyle</span><span class="PUNC">(</span><span class="NAME">ul</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line203' class='line'> 203</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">top</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'auto'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line204' class='line'> 204</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">bottom</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'0px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line205' class='line'> 205</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line206' class='line'> 206</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line207' class='line'> 207</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line208' class='line'> 208</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line209' class='line'> 209</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="PUNC">;</span><span class="WHIT">
<span id='line210' class='line'> 210</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line211' class='line'> 211</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line212' class='line'> 212</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line213' class='line'> 213</span> &nbsp;&nbsp;&nbsp;&nbsp; * Drag and Drop API によってドロップ可能な領域を作成する
<span id='line214' class='line'> 214</span> &nbsp;&nbsp;&nbsp;&nbsp; *
<span id='line215' class='line'> 215</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} aElement ドロップを受け付けるノード
<span id='line216' class='line'> 216</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} option オプションパラメータ
<span id='line217' class='line'> 217</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Function} .callback 読み込み終わった時に呼び出される関数。以下の引数が渡される。&lt;br />
<span id='line218' class='line'> 218</span> &nbsp;&nbsp;&nbsp;&nbsp; *                            第1引数： {DataArray} データの配列 &lt;br />
<span id='line219' class='line'> 219</span> &nbsp;&nbsp;&nbsp;&nbsp; *                            第2引数： {FileList}
<span id='line220' class='line'> 220</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Object} [.self] callback, dragenter, dragover, dragleave, drop内でthisが指すべきもの
<span id='line221' class='line'> 221</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Function} [.dragenter] デフォルトのdragenter処理に代わって呼び出される関数
<span id='line222' class='line'> 222</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Function} [.dragover] デフォルトのdragover処理に代わって呼び出される関数
<span id='line223' class='line'> 223</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Function} [.dragleave] デフォルトのdragleave処理に代わって呼び出される関数
<span id='line224' class='line'> 224</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Function} [.drop] デフォルトのdrop処理に代わって呼び出される関数
<span id='line225' class='line'> 225</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} [.input] input[type=file] でもファイルを受け取りたいとき、input要素を指定する
<span id='line226' class='line'> 226</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Function} [.change] option.inputが指定されているとき、デフォルトのchange処理に代わって呼び出される関数
<span id='line227' class='line'> 227</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line228' class='line'> 228</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">dropbox</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">option</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line229' class='line'> 229</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//クラス設定</span><span class="WHIT">
<span id='line230' class='line'> 230</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addClass</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'dropbox'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line231' class='line'> 231</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line232' class='line'> 232</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//イベント設定&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line233' class='line'> 233</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'dragenter'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">option.dragenter</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line234' class='line'> 234</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addClass</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'dropbox-dragover'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line235' class='line'> 235</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">e.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line236' class='line'> 236</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">option.self</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line237' class='line'> 237</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line238' class='line'> 238</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'dragover'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">option.dragover</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line239' class='line'> 239</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">e.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line240' class='line'> 240</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">option.self</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line241' class='line'> 241</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line242' class='line'> 242</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'dragend dragleave'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">option.dragleave</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line243' class='line'> 243</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.removeClass</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'dropbox-dragover'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line244' class='line'> 244</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">option.self</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line245' class='line'> 245</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line246' class='line'> 246</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">option.input</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line247' class='line'> 247</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">option.input</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'change'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">option.change</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line248' class='line'> 248</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.removeClass</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'dropbox-dragover'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line249' class='line'> 249</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line250' class='line'> 250</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_loadfile</span><span class="PUNC">(</span><span class="NAME">this.files</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line251' class='line'> 251</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line252' class='line'> 252</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line253' class='line'> 253</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line254' class='line'> 254</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'drop'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">option.drop</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line255' class='line'> 255</span> 
<span id='line256' class='line'> 256</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">e.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line257' class='line'> 257</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.removeClass</span><span class="PUNC">(</span><span class="NAME">aElement</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'dropbox-dragover'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line258' class='line'> 258</span> 
<span id='line259' class='line'> 259</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_loadfile</span><span class="PUNC">(</span><span class="NAME">e.dataTransfer.files</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line260' class='line'> 260</span> 
<span id='line261' class='line'> 261</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">option.self</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line262' class='line'> 262</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line263' class='line'> 263</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line264' class='line'> 264</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//ファイルを読み込む関数</span><span class="WHIT">
<span id='line265' class='line'> 265</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">_loadfile</span><span class="PUNC">(</span><span class="NAME">files</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line266' class='line'> 266</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dataArray</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">  </span><span class="COMM">//読み込んだデータを格納しておく配列</span><span class="WHIT">
<span id='line267' class='line'> 267</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line268' class='line'> 268</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.log</span><span class="PUNC">(</span><span class="STRN">'Load File:'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">files</span><span class="PUNC">)</span><span class="WHIT">
<span id='line269' class='line'> 269</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line270' class='line'> 270</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">Deferred.loop</span><span class="PUNC">(</span><span class="NAME">files.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line271' class='line'> 271</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">reader</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">FileReader</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line272' class='line'> 272</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line273' class='line'> 273</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">joUI.select</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="WHIT">
<span id='line274' class='line'> 274</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">message</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'Choose the type of loading file.'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line275' class='line'> 275</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">selects</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT"> </span><span class="STRN">'Text'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'Binary'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'DataURL'</span><span class="WHIT"> </span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span id='line276' class='line'> 276</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">200</span><span class="PUNC">,</span><span class="WHIT">
<span id='line277' class='line'> 277</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">,</span><span class="WHIT">
<span id='line278' class='line'> 278</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'File Importer'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line279' class='line'> 279</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">application</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'dinos.finder'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line280' class='line'> 280</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line281' class='line'> 281</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line282' class='line'> 282</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Deferred</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line283' class='line'> 283</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line284' class='line'> 284</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">reader.onload</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">def</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">def.call</span><span class="PUNC">(</span><span class="NAME">ev.target.result</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">deferred</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line285' class='line'> 285</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line286' class='line'> 286</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">reader.onerror</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">def</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ev</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line287' class='line'> 287</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">option.onerror</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line288' class='line'> 288</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">option.onerror.call</span><span class="PUNC">(</span><span class="NAME">option.self</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ev.target.error</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line289' class='line'> 289</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line290' class='line'> 290</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.error</span><span class="PUNC">(</span><span class="NAME">ev.target.error</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">def.fail</span><span class="PUNC">(</span><span class="STRN">''</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line291' class='line'> 291</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">deferred</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line292' class='line'> 292</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line293' class='line'> 293</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//読み込み</span><span class="WHIT">
<span id='line294' class='line'> 294</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line295' class='line'> 295</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'Text'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line296' class='line'> 296</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">reader.readAsText</span><span class="PUNC">(</span><span class="NAME">files</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'utf-8'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line297' class='line'> 297</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line298' class='line'> 298</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line299' class='line'> 299</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'Binary'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line300' class='line'> 300</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">reader.readAsBinaryString</span><span class="PUNC">(</span><span class="NAME">files</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line301' class='line'> 301</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line302' class='line'> 302</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line303' class='line'> 303</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">'DataURL'</span><span class="PUNC">:</span><span class="WHIT">
<span id='line304' class='line'> 304</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">reader.readAsDataURL</span><span class="PUNC">(</span><span class="NAME">files</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line305' class='line'> 305</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line306' class='line'> 306</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line307' class='line'> 307</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="WHIT">
<span id='line308' class='line'> 308</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">'Invalid type of loading file.'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line309' class='line'> 309</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line310' class='line'> 310</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line311' class='line'> 311</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">deferred</span><span class="PUNC">;</span><span class="WHIT">
<span id='line312' class='line'> 312</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line313' class='line'> 313</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line314' class='line'> 314</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line315' class='line'> 315</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">dataArray</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">data</span><span class="PUNC">;</span><span class="WHIT">
<span id='line316' class='line'> 316</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line317' class='line'> 317</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">error</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">joCore.logger.error</span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line318' class='line'> 318</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line319' class='line'> 319</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">next</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line320' class='line'> 320</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line321' class='line'> 321</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">option.callback.call</span><span class="PUNC">(</span><span class="NAME">option.self</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">dataArray</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">files</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line322' class='line'> 322</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line323' class='line'> 323</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">error</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line324' class='line'> 324</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.error</span><span class="PUNC">(</span><span class="NAME">ex</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line325' class='line'> 325</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">option.onerror</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">option.onerror.call</span><span class="PUNC">(</span><span class="NAME">option.self</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">ex</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line326' class='line'> 326</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line327' class='line'> 327</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line328' class='line'> 328</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line329' class='line'> 329</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line330' class='line'> 330</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line331' class='line'> 331</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line332' class='line'> 332</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line333' class='line'> 333</span> &nbsp;&nbsp;&nbsp;&nbsp; * Progress Bar
<span id='line334' class='line'> 334</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {joProgress}
<span id='line335' class='line'> 335</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@see</span> joProgress
<span id='line336' class='line'> 336</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line337' class='line'> 337</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">progress</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">width</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line338' class='line'> 338</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joProgress</span><span class="PUNC">(</span><span class="NAME">width</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line339' class='line'> 339</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line340' class='line'> 340</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line341' class='line'> 341</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line342' class='line'> 342</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line343' class='line'> 343</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {joListTree}
<span id='line344' class='line'> 344</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@see</span> joListTree
<span id='line345' class='line'> 345</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line346' class='line'> 346</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">listTree</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tree</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attachTo</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">multiple</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line347' class='line'> 347</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joListTree</span><span class="PUNC">(</span><span class="NAME">tree</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attachTo</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">multiple</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line348' class='line'> 348</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line349' class='line'> 349</span> 
<span id='line350' class='line'> 350</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line351' class='line'> 351</span> 
<span id='line352' class='line'> 352</span> 
<span id='line353' class='line'> 353</span> </span><span class="doccmt">/**
<span id='line354' class='line'> 354</span>  * タブ
<span id='line355' class='line'> 355</span>  * <span class="doctag">@constructor</span>
<span id='line356' class='line'> 356</span>  * <span class="doctag">@param</span> {HTMLULElement} ul タブ化するUL要素の参照 &lt;br>
<span id='line357' class='line'> 357</span>  *                           所定の構造をしている必要がある &lt;br>
<span id='line358' class='line'> 358</span>  *                           詳細はサンプルを参照
<span id='line359' class='line'> 359</span>  *
<span id='line360' class='line'> 360</span>  * <span class="doctag">@example</span>
<span id='line361' class='line'> 361</span>  *   &lt;ul id="tab-example">                 
<span id='line362' class='line'> 362</span>  *     &lt;li>&lt;a class="tab-name">Tab1&lt;/a>   &lt;!-- tab-name というクラスのノードがタブになる -->
<span id='line363' class='line'> 363</span>  *        &lt;div class="tab-contents">&lt;/div>  &lt;!-- tab-contents というクラスのノードがタブの中身になる -->
<span id='line364' class='line'> 364</span>  *     &lt;/li>                               
<span id='line365' class='line'> 365</span>  *                                         
<span id='line366' class='line'> 366</span>  *     &lt;li>&lt;a class="tab-name">Tab2&lt;/a>    
<span id='line367' class='line'> 367</span>  *        &lt;div class="tab-contents">&lt;/div> 
<span id='line368' class='line'> 368</span>  *     &lt;/li>
<span id='line369' class='line'> 369</span>  *   &lt;/ul>
<span id='line370' class='line'> 370</span>  *                                         
<span id='line371' class='line'> 371</span>  *   new joTab($('tab-example'));          
<span id='line372' class='line'> 372</span>  */</span><span class="WHIT">
<span id='line373' class='line'> 373</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">joTab</span><span class="PUNC">(</span><span class="NAME">ul</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line374' class='line'> 374</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="NAME">ul</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line375' class='line'> 375</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line376' class='line'> 376</span> </span><span class="NAME">joTab.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line377' class='line'> 377</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line378' class='line'> 378</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line379' class='line'> 379</span> &nbsp;&nbsp;&nbsp;&nbsp; * 初期化処理
<span id='line380' class='line'> 380</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {HTMLULElement} ul
<span id='line381' class='line'> 381</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@private</span>
<span id='line382' class='line'> 382</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line383' class='line'> 383</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">ul</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line384' class='line'> 384</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addClass</span><span class="PUNC">(</span><span class="NAME">ul</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'tabs'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line385' class='line'> 385</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.tabs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ul</span><span class="PUNC">;</span><span class="WHIT">
<span id='line386' class='line'> 386</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.tablist</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.utils.toArray</span><span class="PUNC">(</span><span class="NAME">ul.childNodes</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">filter</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">node</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">node.tagName</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">node.tagName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'li'</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line387' class='line'> 387</span> 
<span id='line388' class='line'> 388</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//クリックした時にタブを切り替えるためのイベントを設定</span><span class="WHIT">
<span id='line389' class='line'> 389</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.tablist.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tab</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line390' class='line'> 390</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tabname</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.utils.toArray</span><span class="PUNC">(</span><span class="NAME">tab.childNodes</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">filter</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">node</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">node.tagName</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">joCore.Node.hasClass</span><span class="PUNC">(</span><span class="NAME">node</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'tab-name'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line391' class='line'> 391</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">tabname</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'lclick'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._onClickTab</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line392' class='line'> 392</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line393' class='line'> 393</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line394' class='line'> 394</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//最初のタブを選択する</span><span class="WHIT">
<span id='line395' class='line'> 395</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.select</span><span class="PUNC">(</span><span class="NAME">this.tablist</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line396' class='line'> 396</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line397' class='line'> 397</span> 
<span id='line398' class='line'> 398</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line399' class='line'> 399</span> &nbsp;&nbsp;&nbsp;&nbsp; * タブをクリックしたときに呼び出される
<span id='line400' class='line'> 400</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Event} event
<span id='line401' class='line'> 401</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line402' class='line'> 402</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_onClickTab</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line403' class='line'> 403</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tab</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.target.tagName</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'li'</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">event.target</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">event.target.parentNode</span><span class="PUNC">;</span><span class="WHIT">
<span id='line404' class='line'> 404</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line405' class='line'> 405</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.select</span><span class="PUNC">(</span><span class="NAME">tab</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line406' class='line'> 406</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line407' class='line'> 407</span> 
<span id='line408' class='line'> 408</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line409' class='line'> 409</span> &nbsp;&nbsp;&nbsp;&nbsp; * タブを変更する
<span id='line410' class='line'> 410</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Tab} tab
<span id='line411' class='line'> 411</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line412' class='line'> 412</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">select</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tab</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line413' class='line'> 413</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.tablist.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">tab</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line414' class='line'> 414</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tab.hasAttribute</span><span class="PUNC">(</span><span class="STRN">'selected'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span id='line415' class='line'> 415</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">tab.removeAttribute</span><span class="PUNC">(</span><span class="STRN">'selected'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line416' class='line'> 416</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line417' class='line'> 417</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line418' class='line'> 418</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">tab.setAttribute</span><span class="PUNC">(</span><span class="STRN">'selected'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'true'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line419' class='line'> 419</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line420' class='line'> 420</span> 
<span id='line421' class='line'> 421</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line422' class='line'> 422</span> 
<span id='line423' class='line'> 423</span> 
<span id='line424' class='line'> 424</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">joProgress</span><span class="PUNC">(</span><span class="NAME">width</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line425' class='line'> 425</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">;</span><span class="WHIT">
<span id='line426' class='line'> 426</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line427' class='line'> 427</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line428' class='line'> 428</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line429' class='line'> 429</span> 
<span id='line430' class='line'> 430</span> </span><span class="NAME">joProgress.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line431' class='line'> 431</span> 
<span id='line432' class='line'> 432</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">percentage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span id='line433' class='line'> 433</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line434' class='line'> 434</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line435' class='line'> 435</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line436' class='line'> 436</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line437' class='line'> 437</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line438' class='line'> 438</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">setPercentage</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">percentage</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line439' class='line'> 439</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line440' class='line'> 440</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line441' class='line'> 441</span> 
<span id='line442' class='line'> 442</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line443' class='line'> 443</span> 
<span id='line444' class='line'> 444</span> 
<span id='line445' class='line'> 445</span> 
<span id='line446' class='line'> 446</span> </span><span class="doccmt">/**
<span id='line447' class='line'> 447</span>  * リストツリー
<span id='line448' class='line'> 448</span>  * <span class="doctag">@constructor</span>
<span id='line449' class='line'> 449</span>  * <span class="doctag">@param</span> {Array} tree ツリーのデータ 各要素は以下のようなオブジェクトからなっている必要がある
<span id='line450' class='line'> 450</span>  *                   {   &lt;br>
<span id='line451' class='line'> 451</span>  *&nbsp;&nbsp;&nbsp;&nbsp;                     {String} data 表示名   &lt;br>
<span id='line452' class='line'> 452</span>  *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                 {String} [value] 項目の値（表示名と実際の値が異なる場合に用いる）   &lt;br>
<span id='line453' class='line'> 453</span>  *                       {Array} [children] 子データがある場合、ここに子データのツリーオブジェクトが入る &lt;br>
<span id='line454' class='line'> 454</span>  * &nbsp;&nbsp;&nbsp;&nbsp;　               　}
<span id='line455' class='line'> 455</span>  * <span class="doctag">@param</span> {Node} attachTo 追加先
<span id='line456' class='line'> 456</span>  * <span class="doctag">@param</span> {Boolean} [multiple] 複数選択できるようにするかどうか
<span id='line457' class='line'> 457</span>  */</span><span class="WHIT">
<span id='line458' class='line'> 458</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">joListTree</span><span class="PUNC">(</span><span class="NAME">tree</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attachTo</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">multiple</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line459' class='line'> 459</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.treeObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tree</span><span class="PUNC">;</span><span class="WHIT">
<span id='line460' class='line'> 460</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.attachTo</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attachTo</span><span class="PUNC">;</span><span class="WHIT">
<span id='line461' class='line'> 461</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.multiple</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">multiple</span><span class="PUNC">;</span><span class="WHIT">
<span id='line462' class='line'> 462</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line463' class='line'> 463</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line464' class='line'> 464</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line465' class='line'> 465</span> </span><span class="NAME">joListTree.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line466' class='line'> 466</span> 
<span id='line467' class='line'> 467</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line468' class='line'> 468</span> &nbsp;&nbsp;&nbsp;&nbsp; * ツリーオブジェクト
<span id='line469' class='line'> 469</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> Arraｙ
<span id='line470' class='line'> 470</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line471' class='line'> 471</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">treeObj</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span id='line472' class='line'> 472</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line473' class='line'> 473</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line474' class='line'> 474</span> &nbsp;&nbsp;&nbsp;&nbsp; * 追加先（ツリーの親要素）
<span id='line475' class='line'> 475</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> Node
<span id='line476' class='line'> 476</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line477' class='line'> 477</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">attachTo</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span id='line478' class='line'> 478</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line479' class='line'> 479</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line480' class='line'> 480</span> &nbsp;&nbsp;&nbsp;&nbsp; * 複数選択できるかどうか
<span id='line481' class='line'> 481</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> {Boolean}
<span id='line482' class='line'> 482</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line483' class='line'> 483</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">multiple</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT">
<span id='line484' class='line'> 484</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="WHIT">
<span id='line485' class='line'> 485</span> 
<span id='line486' class='line'> 486</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line487' class='line'> 487</span> &nbsp;&nbsp;&nbsp;&nbsp; * 選択されている項目の値の配列
<span id='line488' class='line'> 488</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@type</span> {Array}
<span id='line489' class='line'> 489</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line490' class='line'> 490</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">selected</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line491' class='line'> 491</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">uuQuery.className</span><span class="PUNC">(</span><span class="STRN">'selected'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">map</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">item.getAttribute</span><span class="PUNC">(</span><span class="STRN">'value'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line492' class='line'> 492</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line493' class='line'> 493</span> 
<span id='line494' class='line'> 494</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line495' class='line'> 495</span> &nbsp;&nbsp;&nbsp;&nbsp; * 初期化処理
<span id='line496' class='line'> 496</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@private</span>
<span id='line497' class='line'> 497</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line498' class='line'> 498</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line499' class='line'> 499</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">parent</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'ul'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'listtree'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line500' class='line'> 500</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">parent.appendChild</span><span class="PUNC">(</span><span class="NAME">this._createTree</span><span class="PUNC">(</span><span class="NAME">this.treeObj</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line501' class='line'> 501</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line502' class='line'> 502</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">this.attachTo</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.clearSelection</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line503' class='line'> 503</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line504' class='line'> 504</span> 
<span id='line505' class='line'> 505</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line506' class='line'> 506</span> &nbsp;&nbsp;&nbsp;&nbsp; * 実際にノードを作成する
<span id='line507' class='line'> 507</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Array} treeObj
<span id='line508' class='line'> 508</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@return</span> {DocumentFragment}
<span id='line509' class='line'> 509</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line510' class='line'> 510</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_createTree</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">treeObj</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line511' class='line'> 511</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createDocumentFragment</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line512' class='line'> 512</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line513' class='line'> 513</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">treeObj.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line514' class='line'> 514</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line515' class='line'> 515</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">treeObj</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">children</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line516' class='line'> 516</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//childrenがある場合</span><span class="WHIT">
<span id='line517' class='line'> 517</span> 
<span id='line518' class='line'> 518</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//childrenの親を作成</span><span class="WHIT">
<span id='line519' class='line'> 519</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">li</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'li'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'hasChild'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">treeObj</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line520' class='line'> 520</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'a'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">':context'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">treeObj</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">data</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">treeObj</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">data</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">li</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line521' class='line'> 521</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line522' class='line'> 522</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//開閉処理と選択処理の登録</span><span class="WHIT">
<span id='line523' class='line'> 523</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.toggleOpen</span><span class="PUNC">(</span><span class="NAME">e.target.parentNode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line524' class='line'> 524</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._onSelect</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line525' class='line'> 525</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line526' class='line'> 526</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//children本体を再帰で作成して追加する</span><span class="WHIT">
<span id='line527' class='line'> 527</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ul</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'ul'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">li</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line528' class='line'> 528</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">ul.appendChild</span><span class="PUNC">(</span><span class="NAME">arguments.callee.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">treeObj</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">children</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line529' class='line'> 529</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line530' class='line'> 530</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line531' class='line'> 531</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line532' class='line'> 532</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//listitemを作成</span><span class="WHIT">
<span id='line533' class='line'> 533</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">li</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'li'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">treeObj</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line534' class='line'> 534</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'a'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">':context'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">treeObj</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">data</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">title</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">treeObj</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">data</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">li</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line535' class='line'> 535</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line536' class='line'> 536</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//選択処理の登録</span><span class="WHIT">
<span id='line537' class='line'> 537</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._onSelect</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line538' class='line'> 538</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line539' class='line'> 539</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line540' class='line'> 540</span> 
<span id='line541' class='line'> 541</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="PUNC">;</span><span class="WHIT">
<span id='line542' class='line'> 542</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line543' class='line'> 543</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line544' class='line'> 544</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line545' class='line'> 545</span> &nbsp;&nbsp;&nbsp;&nbsp; * 項目の開閉
<span id='line546' class='line'> 546</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} item
<span id='line547' class='line'> 547</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line548' class='line'> 548</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">toggleOpen</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line549' class='line'> 549</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.toggleClass</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'opened'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line550' class='line'> 550</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line551' class='line'> 551</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line552' class='line'> 552</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line553' class='line'> 553</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line554' class='line'> 554</span> &nbsp;&nbsp;&nbsp;&nbsp; * 項目がクリックされた時に呼び出される
<span id='line555' class='line'> 555</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Event} event
<span id='line556' class='line'> 556</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line557' class='line'> 557</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_onSelect</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line558' class='line'> 558</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">itemNode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.target.parentNode</span><span class="PUNC">;</span><span class="WHIT">
<span id='line559' class='line'> 559</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line560' class='line'> 560</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//複数選択が有効でないときには選択を全解除</span><span class="WHIT">
<span id='line561' class='line'> 561</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this.multiple</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">event.ctrlKey</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT">
<span id='line562' class='line'> 562</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.clearSelection</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line563' class='line'> 563</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line564' class='line'> 564</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.selectItem</span><span class="PUNC">(</span><span class="NAME">itemNode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line565' class='line'> 565</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line566' class='line'> 566</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line567' class='line'> 567</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line568' class='line'> 568</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line569' class='line'> 569</span> &nbsp;&nbsp;&nbsp;&nbsp; * 指定した項目を選択する
<span id='line570' class='line'> 570</span> &nbsp;&nbsp;&nbsp;&nbsp; * <span class="doctag">@param</span> {Node} item
<span id='line571' class='line'> 571</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line572' class='line'> 572</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">selectItem</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line573' class='line'> 573</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line574' class='line'> 574</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.multiple</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line575' class='line'> 575</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">uuQuery.className</span><span class="PUNC">(</span><span class="STRN">'selected'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">node</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line576' class='line'> 576</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.removeClass</span><span class="PUNC">(</span><span class="NAME">node</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'selected'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line577' class='line'> 577</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line578' class='line'> 578</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line579' class='line'> 579</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line580' class='line'> 580</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addClass</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'selected'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line581' class='line'> 581</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line582' class='line'> 582</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line583' class='line'> 583</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="doccmt">/**
<span id='line584' class='line'> 584</span> &nbsp;&nbsp;&nbsp;&nbsp; * すべての選択を解除する
<span id='line585' class='line'> 585</span> &nbsp;&nbsp;&nbsp;&nbsp; */</span><span class="WHIT">
<span id='line586' class='line'> 586</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">clearSelection</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line587' class='line'> 587</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">uuQuery.className</span><span class="PUNC">(</span><span class="STRN">'selected'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">node</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line588' class='line'> 588</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.removeClass</span><span class="PUNC">(</span><span class="NAME">node</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'selected'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line589' class='line'> 589</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line590' class='line'> 590</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line591' class='line'> 591</span> 
<span id='line592' class='line'> 592</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line593' class='line'> 593</span> 
<span id='line594' class='line'> 594</span> 
<span id='line595' class='line'> 595</span> 
<span id='line596' class='line'> 596</span> </span><span class="COMM">/*
<span id='line597' class='line'> 597</span> 
<span id='line598' class='line'> 598</span> [
<span id='line599' class='line'> 599</span> &nbsp;&nbsp;&nbsp;&nbsp;[ 'A', 'B', 'C' ],
<span id='line600' class='line'> 600</span> &nbsp;&nbsp;&nbsp;&nbsp;[ 'data a-1', 'data b-1', 'data c-1' ],
<span id='line601' class='line'> 601</span> &nbsp;&nbsp;&nbsp;&nbsp;[ { noneditable: true, value: 'Test' }, 12, 25 ],
<span id='line602' class='line'> 602</span> ]
<span id='line603' class='line'> 603</span> 
<span id='line604' class='line'> 604</span> */</span><span class="WHIT">
<span id='line605' class='line'> 605</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">joTableTree</span><span class="PUNC">(</span><span class="NAME">tree</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">attachTo</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">option</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line606' class='line'> 606</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">tree</span><span class="PUNC">;</span><span class="WHIT">
<span id='line607' class='line'> 607</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.attachTo</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">attachTo</span><span class="PUNC">;</span><span class="WHIT">
<span id='line608' class='line'> 608</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.option</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">option</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span id='line609' class='line'> 609</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line610' class='line'> 610</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this.init</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line611' class='line'> 611</span> </span><span class="PUNC">}</span><span class="WHIT">
<span id='line612' class='line'> 612</span> 
<span id='line613' class='line'> 613</span> </span><span class="NAME">joTableTree.prototype</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line614' class='line'> 614</span> 
<span id='line615' class='line'> 615</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">init</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line616' class='line'> 616</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._table</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'table'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tableTree'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line617' class='line'> 617</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._table.appendChild</span><span class="PUNC">(</span><span class="NAME">this._createTree</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line618' class='line'> 618</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line619' class='line'> 619</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line620' class='line'> 620</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">build</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line621' class='line'> 621</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._data</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">data</span><span class="PUNC">;</span><span class="WHIT">
<span id='line622' class='line'> 622</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line623' class='line'> 623</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">range</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createRange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line624' class='line'> 624</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">range.selectNodeContents</span><span class="PUNC">(</span><span class="NAME">this._table</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line625' class='line'> 625</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">range.deleteContents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line626' class='line'> 626</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line627' class='line'> 627</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._table.appendChild</span><span class="PUNC">(</span><span class="NAME">this._createTree</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line628' class='line'> 628</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line629' class='line'> 629</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line630' class='line'> 630</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line631' class='line'> 631</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_createTree</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line632' class='line'> 632</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line633' class='line'> 633</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createDocumentFragment</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line634' class='line'> 634</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span id='line635' class='line'> 635</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line636' class='line'> 636</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._data.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">row</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">rowIndex</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line637' class='line'> 637</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line638' class='line'> 638</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//0番目の要素：ヘッダー</span><span class="WHIT">
<span id='line639' class='line'> 639</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">rowIndex</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line640' class='line'> 640</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'tr'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tableTree-header unselectable'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line641' class='line'> 641</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line642' class='line'> 642</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">row.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">cel</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">colIndex</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line643' class='line'> 643</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">td</span><span class="PUNC">;</span><span class="WHIT">
<span id='line644' class='line'> 644</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line645' class='line'> 645</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">cel</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line646' class='line'> 646</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">td</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'td'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">':context'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">cel.value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span id='line647' class='line'> 647</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tableTree-header-col-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">colIndex</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="WHIT">
<span id='line648' class='line'> 648</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="PUNC">(</span><span class="NAME">cel.noneditable</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'non-editable'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT">
<span id='line649' class='line'> 649</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line650' class='line'> 650</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">else</span><span class="WHIT">
<span id='line651' class='line'> 651</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">td</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'td'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">':context'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">cel</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tableTree-header-col-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">colIndex</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line652' class='line'> 652</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line653' class='line'> 653</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">td</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.sort</span><span class="PUNC">(</span><span class="NAME">colIndex</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line654' class='line'> 654</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line655' class='line'> 655</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">context</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">joContextMenu</span><span class="PUNC">(</span><span class="NAME">self</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line656' class='line'> 656</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">context.set</span><span class="PUNC">(</span><span class="NAME">td</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'列の自動サイズ調整'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.adjustSize</span><span class="PUNC">(</span><span class="NAME">colIndex</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line657' class='line'> 657</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line658' class='line'> 658</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line659' class='line'> 659</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line660' class='line'> 660</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'tr'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tableTree-row-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">rowIndex</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line661' class='line'> 661</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line662' class='line'> 662</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">row.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">cel</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">colIndex</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line663' class='line'> 663</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">td</span><span class="PUNC">;</span><span class="WHIT">
<span id='line664' class='line'> 664</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line665' class='line'> 665</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">cel</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'object'</span><span class="PUNC">)</span><span class="WHIT">
<span id='line666' class='line'> 666</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">td</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'td'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">':context'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">cel.value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="WHIT">
<span id='line667' class='line'> 667</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tableTree-cel-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">rowIndex</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">colIndex</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' '</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="WHIT">
<span id='line668' class='line'> 668</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="PUNC">(</span><span class="NAME">cel.noneditable</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">'non-editable'</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">)</span><span class="WHIT">
<span id='line669' class='line'> 669</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;  </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line670' class='line'> 670</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">else</span><span class="WHIT">
<span id='line671' class='line'> 671</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">td</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'td'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">':context'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">cel</span><span class="PUNC">,</span><span class="WHIT">
<span id='line672' class='line'> 672</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tableTree-cel-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">rowIndex</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">colIndex</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">tr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line673' class='line'> 673</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line674' class='line'> 674</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">tr</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'click'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.select</span><span class="PUNC">(</span><span class="NAME">rowIndex</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line675' class='line'> 675</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">td</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'dblclick'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.edit</span><span class="PUNC">(</span><span class="NAME">rowIndex</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">colIndex</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line676' class='line'> 676</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line677' class='line'> 677</span> 
<span id='line678' class='line'> 678</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line679' class='line'> 679</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line680' class='line'> 680</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line681' class='line'> 681</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">fragment</span><span class="PUNC">;</span><span class="WHIT">
<span id='line682' class='line'> 682</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line683' class='line'> 683</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line684' class='line'> 684</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">edit</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">row</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">col</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line685' class='line'> 685</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cel</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'tableTree-cel-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">row</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">col</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line686' class='line'> 686</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">header</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'tableTree-header-col-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">col</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line687' class='line'> 687</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">celValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cel.innerHTML</span><span class="PUNC">;</span><span class="WHIT">
<span id='line688' class='line'> 688</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.getNodeRect</span><span class="PUNC">(</span><span class="NAME">cel</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line689' class='line'> 689</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line690' class='line'> 690</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//non-editableのときは終了</span><span class="WHIT">
<span id='line691' class='line'> 691</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.logger.log</span><span class="PUNC">(</span><span class="NAME">cel</span><span class="PUNC">,</span><span class="NAME">header</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line692' class='line'> 692</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">joCore.Node.hasClass</span><span class="PUNC">(</span><span class="NAME">cel</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'non-editable'</span><span class="PUNC">)</span><span class="WHIT">  </span><span class="PUNC">||</span><span class="WHIT">
<span id='line693' class='line'> 693</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   </span><span class="NAME">joCore.Node.hasClass</span><span class="PUNC">(</span><span class="NAME">header</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'non-editable'</span><span class="PUNC">)</span><span class="WHIT">  </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span id='line694' class='line'> 694</span> 
<span id='line695' class='line'> 695</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">input</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">joCore.Node.createNode</span><span class="PUNC">(</span><span class="STRN">'input'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="STRN">'class'</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">'tableTree-edit-input'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">celValue</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line696' class='line'> 696</span> 
<span id='line697' class='line'> 697</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addStyle</span><span class="PUNC">(</span><span class="NAME">input</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span id='line698' class='line'> 698</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rect.width</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line699' class='line'> 699</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">height</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rect.height</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line700' class='line'> 700</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">top</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rect.top</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line701' class='line'> 701</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">left</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">rect.left</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="PUNC">,</span><span class="WHIT">
<span id='line702' class='line'> 702</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line703' class='line'> 703</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line704' class='line'> 704</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joEvent.addEvent</span><span class="PUNC">(</span><span class="NAME">input</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'keydown blur'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line705' class='line'> 705</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//Enterじゃなければ終了</span><span class="WHIT">
<span id='line706' class='line'> 706</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">event.type</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">'keydown'</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">event.keyCode</span><span class="WHIT"> </span><span class="PUNC">!==</span><span class="WHIT"> </span><span class="NUMB">13</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span id='line707' class='line'> 707</span> 
<span id='line708' class='line'> 708</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//表示に反映</span><span class="WHIT">
<span id='line709' class='line'> 709</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">cel.innerHTML</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">input.value</span><span class="PUNC">;</span><span class="WHIT">
<span id='line710' class='line'> 710</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line711' class='line'> 711</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//データにも反映</span><span class="WHIT">
<span id='line712' class='line'> 712</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._data</span><span class="PUNC">[</span><span class="NAME">row</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">col</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">input.value</span><span class="PUNC">;</span><span class="WHIT">
<span id='line713' class='line'> 713</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line714' class='line'> 714</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//inputを削除</span><span class="WHIT">
<span id='line715' class='line'> 715</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.remove</span><span class="PUNC">(</span><span class="NAME">input</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line716' class='line'> 716</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line717' class='line'> 717</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line718' class='line'> 718</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line719' class='line'> 719</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">select</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">row</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line720' class='line'> 720</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.option.nonSelectable</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span id='line721' class='line'> 721</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line722' class='line'> 722</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">row</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'tableTree-row-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">row</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line723' class='line'> 723</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">selectedItems</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'selected'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line724' class='line'> 724</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line725' class='line'> 725</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">selectedItems.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">joCore.Node.removeClass</span><span class="PUNC">(</span><span class="NAME">item</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'selected'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line726' class='line'> 726</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addClass</span><span class="PUNC">(</span><span class="NAME">row</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'selected'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line727' class='line'> 727</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line728' class='line'> 728</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line729' class='line'> 729</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">sort</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">col</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line730' class='line'> 730</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cels</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uuQuery</span><span class="PUNC">(</span><span class="STRN">'[class^="tableTree-cel-"][class$="-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">col</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"]'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line731' class='line'> 731</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">colHeader</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'tableTree-header-col-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">col</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line732' class='line'> 732</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line733' class='line'> 733</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//初期化</span><span class="WHIT">
<span id='line734' class='line'> 734</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">colHeader.className.indexOf</span><span class="PUNC">(</span><span class="STRN">'-sorted'</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line735' class='line'> 735</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//すでにソート済みでない列の場合は、他の列もすべて初期化する</span><span class="WHIT">
<span id='line736' class='line'> 736</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">uuQuery</span><span class="PUNC">(</span><span class="STRN">'[class^="tableTree-header-col-"]'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">header</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line737' class='line'> 737</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.removeClass</span><span class="PUNC">(</span><span class="NAME">header</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'tableTree-up-sorted tableTree-down-sorted'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line738' class='line'> 738</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line739' class='line'> 739</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line740' class='line'> 740</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//STATEの初期化</span><span class="WHIT">
<span id='line741' class='line'> 741</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._SORT_STATE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.STATE_NON_SORT</span><span class="PUNC">;</span><span class="WHIT">
<span id='line742' class='line'> 742</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line743' class='line'> 743</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span id='line744' class='line'> 744</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.removeClass</span><span class="PUNC">(</span><span class="NAME">colHeader</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'tableTree-up-sorted tableTree-down-sorted'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line745' class='line'> 745</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line746' class='line'> 746</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line747' class='line'> 747</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//ソートする</span><span class="WHIT">
<span id='line748' class='line'> 748</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">this._SORT_STATE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line749' class='line'> 749</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">this.STATE_NON_SORT</span><span class="PUNC">:</span><span class="WHIT">  </span><span class="COMM">//なし -> 昇順にする</span><span class="WHIT">
<span id='line750' class='line'> 750</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">cels.sort</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.innerHTML</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">b.innerHTML</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line751' class='line'> 751</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line752' class='line'> 752</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addClass</span><span class="PUNC">(</span><span class="NAME">colHeader</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'tableTree-up-sorted'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line753' class='line'> 753</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._SORT_STATE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.STATE_SORT_UP</span><span class="PUNC">;</span><span class="WHIT">
<span id='line754' class='line'> 754</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line755' class='line'> 755</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line756' class='line'> 756</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">this.STATE_SORT_UP</span><span class="PUNC">:</span><span class="WHIT">  </span><span class="COMM">//昇順 -> 降順にする</span><span class="WHIT">
<span id='line757' class='line'> 757</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">cels.sort</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.innerHTML</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">b.innerHTML</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line758' class='line'> 758</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line759' class='line'> 759</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addClass</span><span class="PUNC">(</span><span class="NAME">colHeader</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="STRN">'tableTree-down-sorted'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line760' class='line'> 760</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._SORT_STATE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.STATE_SORT_DOWN</span><span class="PUNC">;</span><span class="WHIT">
<span id='line761' class='line'> 761</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span id='line762' class='line'> 762</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line763' class='line'> 763</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">this.STATE_SORT_DOWN</span><span class="PUNC">:</span><span class="WHIT">
<span id='line764' class='line'> 764</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">cels.sort</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.className.match</span><span class="PUNC">(</span><span class="REGX">/tableTree-cel-(\d+)/</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">b.className.match</span><span class="PUNC">(</span><span class="REGX">/tableTree-cel-(\d+)/</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line765' class='line'> 765</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">this._SORT_STATE</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.STATE_NON_SORT</span><span class="PUNC">;</span><span class="WHIT">
<span id='line766' class='line'> 766</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line767' class='line'> 767</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line768' class='line'> 768</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line769' class='line'> 769</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//ソート済みのインデックス番号</span><span class="WHIT">
<span id='line770' class='line'> 770</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sortedIndexs</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cels.concat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">map</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">cel</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">cel.className.match</span><span class="PUNC">(</span><span class="REGX">/tableTree-cel-(\d+)/</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line771' class='line'> 771</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line772' class='line'> 772</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span id='line773' class='line'> 773</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">sortedIndexs.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">index</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line774' class='line'> 774</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">row</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'tableTree-row-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">index</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">self.attachTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line775' class='line'> 775</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">self._table.appendChild</span><span class="PUNC">(</span><span class="NAME">row</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line776' class='line'> 776</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line777' class='line'> 777</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line778' class='line'> 778</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line779' class='line'> 779</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line780' class='line'> 780</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">_SORT_STATE</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span id='line781' class='line'> 781</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">STATE_NON_SORT</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span id='line782' class='line'> 782</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">STATE_SORT_UP</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span id='line783' class='line'> 783</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">STATE_SORT_DOWN</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT">
<span id='line784' class='line'> 784</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line785' class='line'> 785</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">adjustSize</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">col</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line786' class='line'> 786</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line787' class='line'> 787</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//ほかの列をすべて初期化</span><span class="WHIT">
<span id='line788' class='line'> 788</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">uuQuery</span><span class="PUNC">(</span><span class="STRN">'[class^="tableTree-header-col-"]'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">header</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line789' class='line'> 789</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.removeStyle</span><span class="PUNC">(</span><span class="NAME">header</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="WHIT"> </span><span class="STRN">'width'</span><span class="WHIT"> </span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line790' class='line'> 790</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line791' class='line'> 791</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line792' class='line'> 792</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="COMM">//指定された列中で最大の幅</span><span class="WHIT">
<span id='line793' class='line'> 793</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">maxWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">self</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line794' class='line'> 794</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">max</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span id='line795' class='line'> 795</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">cels</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uuQuery</span><span class="PUNC">(</span><span class="STRN">'[class^="tableTree-cel-"][class$="-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">col</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"]'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">self.attachTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line796' class='line'> 796</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line797' class='line'> 797</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">cels.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span id='line798' class='line'> 798</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line799' class='line'> 799</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">uuStyle.toPixel</span><span class="PUNC">(</span><span class="NAME">cels</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">innerHTML.length</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'em'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">cels</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line800' class='line'> 800</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">max</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="NAME">max</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">;</span><span class="WHIT">
<span id='line801' class='line'> 801</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="WHIT">
<span id='line802' class='line'> 802</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line803' class='line'> 803</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">max</span><span class="PUNC">;</span><span class="WHIT">
<span id='line804' class='line'> 804</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line805' class='line'> 805</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line806' class='line'> 806</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">colHeader</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">$C</span><span class="PUNC">(</span><span class="STRN">'tableTree-header-col-'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">col</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.attachTo</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line807' class='line'> 807</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="WHIT">
<span id='line808' class='line'> 808</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="NAME">joCore.Node.addStyle</span><span class="PUNC">(</span><span class="NAME">colHeader</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">maxWidth</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'px'</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span id='line809' class='line'> 809</span> </span><span class="WHIT">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span id='line810' class='line'> 810</span> 
<span id='line811' class='line'> 811</span> 
<span id='line812' class='line'> 812</span> 
<span id='line813' class='line'> 813</span> </span><span class="PUNC">}</span><span class="PUNC">;</span></pre><div class='spacer'><span class='line'>&nbsp;&nbsp;&nbsp;&nbsp;</span></div></body></html>